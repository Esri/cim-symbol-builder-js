"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[2905],{32730:(e,t,n)=>{n.d(t,{BI:()=>y,D3:()=>m,XJ:()=>g,lc:()=>f,mX:()=>w,rU:()=>h,tH:()=>F});var r=n(799);const i="__begin__",s="__end__",o=new RegExp(i,"ig"),a=new RegExp(s,"ig"),l=new RegExp("^"+i,"i"),u=new RegExp(s+"$","i"),c='"',d=c+" + ",p=" + "+c;function f(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function m(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function g(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=f(e.labelExpression),t.type="conventional"),t}function y(e){const t=g(e);switch(t.type){case"conventional":return w(t.expression);case"arcade":return t.expression}return null}function h(e){const t=g(e);switch(t.type){case"conventional":return function(e){const t=e?.match(b);return t?.[1].trim()||null}(t.expression);case"arcade":return F(t.expression)}return null}function w(e){let t;return e?(t=(0,r.HC)(e,(e=>i+'$feature["'+e+'"]'+s)),t=l.test(t)?t.replace(l,""):c+t,t=u.test(t)?t.replace(u,""):t+c,t=t.replaceAll(o,d).replaceAll(a,p)):t='""',t}const b=/^\s*\{([^}]+)\}\s*$/i,T=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,x=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,A=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function F(e){if(!e)return null;let t=T.exec(e)||x.exec(e);return t?t[1]||t[3]:(t=A.exec(e),t?t[2]:null)}},39516:(e,t,n)=>{let r;async function i(){return null==r&&(r=n.e(4123).then(n.bind(n,44123)).then((e=>new e.WhereClauseCache(500,500)))),r}async function s(e,t){const n=await i(),r=n.get(e,t);if(null==r)throw n.getError(e,t);return r}function o(e,t){return e||=null,t||=null,"1=1"===e?t??e:"1=1"===t?e??t:e&&t?`(${e}) AND (${t})`:e??t}function a(e,t){return e||=null,t||=null,"1=1"===e||"1=1"===t||e===t?"1=1"===e?e:t:e&&t?`(${e}) OR (${t})`:e??t}n.d(t,{GP:()=>s,IW:()=>a,mA:()=>o})},41560:(e,t,n)=>{n.d(t,{Ch:()=>o,mW:()=>s});var r=n(34727),i=n(39516);function s(e,t){return{...t,filterMode:e.mode}}function o(e,t,n){const s=function(e){if("manual"===u(e))return null;const t=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:n,maxScale:r}of e.filters)t[0]=Math.max(t[0],c(n)),t[1]=Math.min(t[1],d(r));return t}(e);if(s&&((0,r.gg)(t,s[0])||(0,r.ZH)(n,s[1])))return"";const o=Array.from(a(e,t,n)),l=function(e,t,n){if(0===e.length)return!0;const i=c(e.at(0)?.minScale),s=d(e.at(-1)?.maxScale);if((0,r.ZH)(i,t)||(0,r.gg)(s,n))return!0;for(let t=0;t<e.length-1;t++){const n=e[t],i=e[t+1];if((0,r.ZH)(c(i.minScale),d(n.maxScale)))return!0}return!1}(o,t,n)?"1=1":o.map((e=>e.where||"1=1")).reduce(((e,t)=>(0,i.IW)(e,t)),"");return l&&"1=1"!==l?l:""}function*a(e,t,n){if("manual"===u(e)){const t=e.filters.find((t=>t.id===e.activeFilterId));t&&(yield t)}else{"object"==typeof t&&(t=t.scale);for(const r of e.filters)l(r.minScale,r.maxScale,t,n)&&(yield r)}}function l(e,t,n,i){return e=c(e),n=c(n),t=d(t),!(!(0,r.Sp)(n,e)&&(i??n)>e||(0,r.Hx)(t,n)||void 0!==i&&(0,r.Sp)(i,e))}function u(e){return"mode"in e?e.mode:e.filterMode}function c(e){return e||Number.POSITIVE_INFINITY}function d(e){return e||0}},46140:(e,t,n)=>{n.d(t,{R:()=>i});var r=n(49186);let i=class e{constructor(e,t,n=""){this.major=e,this.minor=t,this._context=n}lessThan(e,t){return this.major<e||e===this.major&&this.minor<t}greaterEqual(e,t){return!this.lessThan(e,t)}validate(e){if(this.major!==e.major){const t=this._context&&this._context+":",n=this._context&&this._context+" ";throw new r.A(t+"unsupported-version",`Required major ${n}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new e(this.major,this.minor,this._context)}static parse(t,n=""){const[i,s]=t.split("."),o=/^\s*\d+\s*$/;if(!i?.match||!o.test(i))throw new r.A((n&&n+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:t});if(!s?.match||!o.test(s))throw new r.A((n&&n+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:t});const a=parseInt(i,10),l=parseInt(s,10);return new e(a,l,n)}}},55674:(e,t,n)=>{n.d(t,{Ad:()=>f,Gj:()=>y,QY:()=>p,lL:()=>h,xR:()=>m});var r=n(66131),i=n(49186),s=(n(44208),n(44729)),o=n(15032),a=n(65864),l=n(95466),u=n(43668),c=n(98623);const d=["geometry","scale","timeProperties"];function p(e,t){if(null!=t)for(const n of d)t.hasArcadeDependency(n)&&e.add(n);return e}function f(e,t){return g.create(e,t,null,["$feature","$view"])}function m(e,t,n){return g.create(e,t,n,["$feature","$view","$config"])}class g{static async create(e,t,n,r){const{arcade:s,Dictionary:o}=await(0,u.l)();let a;try{a=s.parseScript(e)}catch(t){throw new i.A("arcade-bad-expression","Failed to parse arcade script",{script:e,error:t})}const l=s.scriptUsesGeometryEngine(a);l&&await s.enableGeometrySupport(),await s.loadDependentModules(new Set,a,null,!1,l);const c={vars:r.reduce(((e,t)=>({...e,[t]:null})),{}),spatialReference:t,useAsync:!1},d=s.compileScript(a,c);let p=null;null!=n&&(p=new o(n),p.immutable=!0);const f=new o;return f.immutable=!1,f.setField("scale",0),new g(e,s,a,d,t,f,p,o)}constructor(e,t,n,r,i,s,o,a){this.script=e,this._arcade=t,this._syntaxTree=n,this._compiled=r,this._spatialReference=i,this._viewDict=s,this._configDict=o,this._dictionaryCtor=a,this._dependencies=new Map,this._featureReader=new y,this._dependencies.set("geometry",t.scriptTouchesGeometry(this._syntaxTree)),this._dependencies.set("scale",this._arcade.referencesMember(this._syntaxTree,"scale")),this._dependencies.set("timeProperties",this._arcade.scriptUsesViewProperties(this._syntaxTree,["timeProperties"]))}evaluate(e,t){const n=t.$view?.timeZone;if(t.$view){let e;if(this._viewDict.setField("scale",t.$view.scale),null!=t.$view.timeProperties){const{currentStart:i,currentEnd:s}=t.$view.timeProperties;e=new this._dictionaryCtor({currentStart:null!=i?null!=n?r.lY.epochToArcadeDate(i,n):r.lY.unknownEpochToArcadeDate(i):void 0,currentEnd:null!=s?null!=n?r.lY.epochToArcadeDate(s,n):r.lY.unknownEpochToArcadeDate(s):void 0,startIncluded:!0,endIncluded:!0})}this._viewDict.setField("timeProperties",e)}return this._compiled({vars:{$view:this._viewDict,$config:this._configDict,$feature:e},spatialReference:this._spatialReference,timeZone:n})}repurposeFeature(e,t){return this._featureReader.bind(e,t,this._spatialReference),this._featureReader}references(e){return this._dependencies.get(e)??!1}}class y{constructor(){this._boundTarget=null,this._boundSchema={fields:null,fieldsIndex:null,spatialReference:null,get geometryType(){return null},get objectIdField(){return null}},this.arcadeDeclaredClass="esri.arcade.Feature",this._contextTimeZone=null}bind(e,t,n){const r=t??new l.A(h(e.attributes));this._boundTarget=e,this._boundSchema.fields=r.fields,this._boundSchema.fieldsIndex=r,this._boundSchema.spatialReference=n}_getField(e){return this._boundSchema.fieldsIndex.get(e)}get contextTimeZone(){return this._contextTimeZone}set contextTimeZone(e){this._contextTimeZone=e}readArcadeFeature(){return this}hasField(e){return this._boundSchema.fieldsIndex.has(e)}geometry(){if("fromJSON"in this._boundTarget)return this._boundTarget.geometry;const e=(0,a.rS)(this._boundTarget.geometry);if(e){if(!this._boundSchema.spatialReference)throw new Error("InternalError: Expected spatial reference to be defined");e.spatialReference=this._boundSchema.spatialReference}return e}isUnknownDateTimeField(e){return this._boundSchema.fieldsIndex.getTimeZone(e)===c.L5}field(e,t=!0){const n=this._getField(e);if(n)switch(n.type){case"date-only":case"esriFieldTypeDateOnly":return s.n.fromReader(this._boundTarget.attributes[n.name]);case"time-only":case"esriFieldTypeTimeOnly":return o.k.fromReader(this._boundTarget.attributes[n.name]);case"esriFieldTypeTimestampOffset":case"timestamp-offset":return r.lY.fromReaderAsTimeStampOffset(this._boundTarget.attributes[n.name]);case"date":case"esriFieldTypeDate":{const t=this._boundTarget.attributes[n.name];return this.isUnknownDateTimeField(e)?r.lY.unknownEpochToArcadeDate(t):r.lY.epochToArcadeDate(t,this.contextTimeZone??c.qU)}default:return this._boundTarget.attributes[n.name]}if(t)throw new Error(`Field ${e} does not exist`);return null}setField(e,t){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this._boundSchema.fieldsIndex.fields.map((e=>e.name))}castToText(e=!1){return JSON.stringify(this._boundTarget)}gdbVersion(){return null}fullSchema(){return this._boundSchema}castAsJson(e=null){return{attributes:this._boundTarget.attributes,geometry:!0===e?.keepGeometryType?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(e=null,t=null){return Promise.resolve(this.castAsJson(t))}}function h(e){const t=[];for(const n in e)t.push({name:n,alias:n,type:"string"==typeof e[n]?"esriFieldTypeString":"esriFieldTypeDouble"});return t}},64714:(e,t,n)=>{n.d(t,{F0:()=>a,Vx:()=>c,e2:()=>p,f:()=>f});var r=n(44208),i=n(4718),s=n(99352),o=n(93470);function a(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?o.Cb:"esriGeometryPolyline"===e?o.yM:o.WR}}}const l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let u=1;function c(e,t){if((0,r.A)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let n=`this${d(t)} = null;`;for(const t in e)n+=`this${d(t)} = ${JSON.stringify(e[t])};`;const r=new Function(`\n      return class AttributesClass$${u++} {\n        constructor() {\n          ${n};\n        }\n      }\n    `)();return()=>new r}catch(n){return()=>({[t]:null,...e})}}function d(e){return l.test(e)?`.${e}`:`["${e}"]`}function p(e={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,i.o8)(e)}}]}function f(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:s.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:s.P,editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},67482:(e,t,n)=>{function r(e){return null!=a(e)||null!=o(e)}function i(e){return l.test(e)}function s(e){return a(e)??o(e)}function o(e){const t=new Date(e);return function(e,t){if(Number.isNaN(e.getTime()))return!1;let n=!0;if(c&&/\d+\W*$/.test(t)){const e=t.match(/[a-zA-Z]{2,}/);if(e){let t=!1,r=0;for(;!t&&r<=e.length;)t=!u.test(e[r]),r++;n=!t}}return n}(t,e)?Number.isNaN(t.getTime())?null:t.getTime()-6e4*t.getTimezoneOffset():null}function a(e){const t=l.exec(e);if(!t?.groups)return null;const n=t.groups,r=+n.year,i=+n.month-1,s=+n.day,o=+(n.hours??"0"),a=+(n.minutes??"0"),u=+(n.seconds??"0");if(o>23)return null;if(a>59)return null;if(u>59)return null;const c=n.ms??"0",d=c?+c.padEnd(3,"0").slice(0,3):0;let p;if(n.isUTC||!n.offsetSign)p=Date.UTC(r,i,s,o,a,u,d);else{const e=+n.offsetHours,t=+n.offsetMinutes;p=6e4*("+"===n.offsetSign?-1:1)*(60*e+t)+Date.UTC(r,i,s,o,a,u,d)}return Number.isNaN(p)?null:p}n.d(t,{Br:()=>i,Cq:()=>r,_U:()=>s});const l=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,u=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,c=!Number.isNaN(new Date("technology 10").getTime())},73681:(e,t,n)=>{n.d(t,{n:()=>l});var r=n(49186),i=n(53966),s=n(46140),o=n(95466),a=n(55674);class l{static async from(e,t,n){const o=e.dictionary_version?s.R.parse(e.dictionary_version):null,c=new Set(e.itemsNames),d={};if(t)for(const e in t)d[e]=t[e];if(e.authoringInfo.configuration)for(const t of e.authoringInfo.configuration)d.hasOwnProperty(t.name)||(d[t.name]=t.value);const p=new Set(e.authoringInfo.symbol);for(const e of Object.keys(n))p.delete(e);p.size&&i.A.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("missing-fields: fieldMap entries for the following symbol fields are missing",{symbolFields:p});const f=await(0,a.xR)(e.expression,null,d);if(!f)throw new r.A("dictionary-renderer:expression-error","Unable to create dictionary renderer expression");const m=!o||!o.greaterEqual(4,0);m&&i.A.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("Dictionary script does not support native field types. Applying fallback",{version:o});const g=new u(n,m);return new l(m,c,f,g)}constructor(e,t,n,r){this._requiresFieldCoercionToString=e,this._itemNames=t,this._compiled=n,this._reader=r}get itemNames(){return this._itemNames}evaluate(e,t,n,r){try{return this._reader.bind(e,n,r),this._compiled.evaluate(this._reader,{$view:{scale:t}})}catch(e){i.A.getLogger("esri.renderers.support.DictionaryScriptEvaluator").warnOnce("arcade: dictionary script evaluation failed",{error:e})}return null}createDictionaryFieldsIndex(e){if(!this._requiresFieldCoercionToString)return new o.A(e);const t=e.map((e=>({...e,type:"esriFieldTypeString"})));return new o.A(t)}}class u extends a.Gj{constructor(e,t){super(),this._fieldMap=e,this._requiresFieldCoercionToString=t}_getField(e){const t=this._fieldMap[e]??e;return this._boundSchema.fieldsIndex.get(t)}field(e){if(!this._requiresFieldCoercionToString)return super.field(e,!1);const t=this._getField(e);return null==t?"":""+this._boundTarget.attributes[t.name]}}},75321:(e,t,n)=>{n.d(t,{GA:()=>j,GL:()=>_,I:()=>P,J0:()=>E,Ki:()=>$,Px:()=>v,QE:()=>A,bV:()=>I,bW:()=>N,vJ:()=>x});var r=n(78888),i=n(49186),s=n(53966),o=n(84952),a=n(16930),l=n(21325),u=n(28735),c=n(90708),d=n(58512),p=n(85113),f=n(64714),m=n(82832),g=n(95466),y=n(98453),h=n(98623);const w=()=>s.A.getLogger("esri.layers.ogc.ogcFeatureUtils"),b="startindex",T=new Set([b,"offset"]),x="http://www.opengis.net/def/crs/",A=`${x}OGC/1.3/CRS84`;var F,S;async function _(e,t,n={},s=5){const{links:a}=e,l=O(a,"items",F.geojson)||O(a,"http://www.opengis.net/def/rel/ogc/1.0/items",F.geojson);if(null==l)throw new i.A("ogc-feature-layer:missing-items-page","Missing items url");const{apiKey:u,customParameters:c,signal:d}=n,m=(0,o.s2)(l.href,e.landingPage.url),T={limit:s,...c,token:u},x=(0,o.a6)(m,T),A={accept:F.geojson},{data:S}=await(0,r.A)(x,{signal:d,headers:A}),_=M(x,s,S.links)??b;(0,p.sO)(S);const I=(0,p.BM)(S,{geometryType:t.geometryType}),v=t.fields||I.fields||[],$=null!=t.hasZ?t.hasZ:I.hasZ,j=I.geometryType,E=t.objectIdField||I.objectIdFieldName||"OBJECTID";let N=t.timeInfo;const P=v.find((({name:e})=>e===E));if(P)P.editable=!1,P.nullable=!1;else{if(!I.objectIdFieldType)throw new i.A("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");v.unshift({name:E,alias:E,type:"number"===I.objectIdFieldType?"esriFieldTypeOID":"esriFieldTypeString",editable:!1,nullable:!1})}if(E!==I.objectIdFieldName){const e=v.find((({name:e})=>e===I.objectIdFieldName));e&&(e.type="esriFieldTypeInteger")}v===I.fields&&I.unknownFields.length>0&&w().warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:I.unknownFields}});for(const e of v){if(null==e.name&&(e.name=e.alias),null==e.alias&&(e.alias=e.name),"esriFieldTypeOID"!==e.type&&"esriFieldTypeGlobalID"!==e.type&&(e.editable=null==e.editable||!!e.editable,e.nullable=null==e.nullable||!!e.nullable),!e.name)throw new i.A("ogc-feature-layer:invalid-field-name","field name is missing",{field:e});if(!y.m.jsonValues.includes(e.type))throw new i.A("ogc-feature-layer:invalid-field-type",`invalid type for field "${e.name}"`,{field:e})}if(N){const e=new g.A(v);if(N.startTimeField){const t=e.get(N.startTimeField);t?(N.startTimeField=t.name,t.type="esriFieldTypeDate"):N.startTimeField=null}if(N.endTimeField){const t=e.get(N.endTimeField);t?(N.endTimeField=t.name,t.type="esriFieldTypeDate"):N.endTimeField=null}if(N.trackIdField){const t=e.get(N.trackIdField);t?N.trackIdField=t.name:(N.trackIdField=null,w().warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:N}}))}N.timeReference||={timeZoneIANA:h.n$},N.startTimeField||N.endTimeField||(w().warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:N}}),N=void 0)}return{drawingInfo:j?(0,f.F0)(j):null,extent:R(e),geometryType:j,fields:v,hasZ:!!$,objectIdField:E,paginationParameter:_,timeInfo:N}}async function I(e,t={}){const{links:n,url:s}=e,a=O(n,"data",F.json)||O(n,"http://www.opengis.net/def/rel/ogc/1.0/data",F.json);if(null==a)throw new i.A("ogc-feature-layer:missing-collections-page","Missing collections url");const{apiKey:l,customParameters:u,signal:c}=t,d=(0,o.s2)(a.href,s),{data:p}=await(0,r.A)(d,{signal:c,headers:{accept:F.json},query:{...u,token:l}});for(const t of p.collections)t.landingPage=e;return p}async function v(e,t={}){const{links:n,url:s}=e,a=O(n,"conformance",F.json)||O(n,"http://www.opengis.net/def/rel/ogc/1.0/conformance",F.json);if(null==a)throw new i.A("ogc-feature-layer:missing-conformance-page","Missing conformance url");const{apiKey:l,customParameters:u,signal:c}=t,d=(0,o.s2)(a.href,s),{data:p}=await(0,r.A)(d,{signal:c,headers:{accept:F.json},query:{...u,token:l}});return p}async function $(e,t={}){const{apiKey:n,customParameters:i,signal:s}=t,{data:o}=await(0,r.A)(e,{signal:s,headers:{accept:F.json},query:{...i,token:n}});return o.url=e,o}async function j(e,t={}){const{links:n,url:i}=e,s=O(n,"service-desc",F.openapi);if(null==s)return w().warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const{apiKey:a,customParameters:l,signal:u}=t,c=(0,o.s2)(s.href,i),{data:d}=await(0,r.A)(c,{signal:u,headers:{accept:F.openapi},query:{...l,token:a}});return d}function E(e){const t=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(e),n=t?.groups;if(!n)return null;const{authority:r,code:i}=n;switch(r.toLowerCase()){case"ogc":switch(i.toLowerCase()){case"crs27":return a.A.GCS_NAD_1927.wkid;case"crs83":return 4269;case"crs84":case"crs84h":return a.A.WGS84.wkid;default:return null}case"esri":case"epsg":{const e=Number.parseInt(i,10);return Number.isNaN(e)?null:e}default:return null}}async function N(e,t,n){const r=await P(e,t,n);return(0,c.ZF)(r)}async function P(e,t,n){const{collection:{links:s,landingPage:{url:f}},layerDefinition:y,maxRecordCount:h,queryParameters:{apiKey:w,customParameters:b},spatialReference:T,supportedCrs:x}=e,A=O(s,"items",F.geojson)||O(s,"http://www.opengis.net/def/rel/ogc/1.0/items",F.geojson);if(null==A)throw new i.A("ogc-feature-layer:missing-items-page","Missing items url");const{geometry:S,num:_,start:I,timeExtent:v,where:$}=t;if(t.objectIds)throw new i.A("ogc-feature-layer:query-by-objectids-not-supported","Queries with object ids are not supported");const j=a.A.fromJSON(T),E=t.outSpatialReference??j,N=E.isWGS84?null:k(E,x),P=D(S,x),C=function(e){if(null==e)return null;const{start:t,end:n}=e;return`${null!=t?t.toISOString():".."}/${null!=n?n.toISOString():".."}`}(v),R=null!=(Y=$)&&Y&&"1=1"!==Y?Y:null,M=_??(null==I?h:10),G=0===I?void 0:I,{fields:q,geometryType:Z,hasZ:U,objectIdField:B,paginationParameter:W}=y,L=(0,o.s2)(A.href,f),{data:J}=await(0,r.A)(L,{...n,query:{...b,...P,crs:N,datetime:C,query:R,limit:M,[W]:G,token:w},headers:{accept:F.geojson}}),V=(0,p.bd)(J,{geometryType:Z,hasZ:U,objectIdField:B}),H=V.length===M&&!!O(J.links??[],"next",F.geojson),z=new g.A(q);var Y;for(const e of V){const t={};(0,m.MB)(z,t,e.attributes,!0);for(const e of z.fields)e.nullable&&!(e.name in t)&&(t[e.name]=null);t[B]=e.attributes[B],e.attributes=t}if(!N&&E.isWebMercator)for(const e of V)if(null!=e.geometry&&null!=Z){const t=(0,c.zv)(e.geometry,Z,U,!1);t.spatialReference=a.A.WGS84,e.geometry=(0,c.Ux)((0,u.Cv)(t,E))}for(const e of V)e.objectId=e.attributes[B];const K=N||!N&&E.isWebMercator?E.toJSON():l.KK,Q=new d.A;return Q.exceededTransferLimit=H,Q.features=V,Q.fields=q,Q.geometryType=Z,Q.hasZ=U,Q.objectIdFieldName=B,Q.spatialReference=K,Q}function k(e,t){const{isWebMercator:n,wkid:r}=e;if(!r)return null;const i=n?t[3857]??t[102100]??t[102113]??t[900913]:t[e.wkid];return i?`${x}${i}`:null}function C(e){if(null==e)return"";const{xmin:t,ymin:n,xmax:r,ymax:i}=e;return`${t},${n},${r},${i}`}function D(e,t){if(!function(e){return null!=e&&"extent"===e.type}(e))return null;const{spatialReference:n}=e;if(!n||n.isWGS84)return{bbox:C(e)};const r=k(n,t);return null!=r?{bbox:C(e),"bbox-crs":r}:n.isWebMercator?{bbox:C((0,u.Cv)(e,a.A.WGS84))}:null}function R(e){const t=e.extent?.spatial;if(!t)return null;const n=t.bbox[0],r=4===n.length,[i,s]=n,o=r?void 0:n[2];return{xmin:i,ymin:s,xmax:r?n[2]:n[3],ymax:r?n[3]:n[4],zmin:o,zmax:r?void 0:n[5],spatialReference:a.A.WGS84.toJSON()}}function O(e,t,n){return e.find((({rel:e,type:r})=>e===t&&r===n))??e.find((({rel:e,type:n})=>e===t&&!n))}function M(e,t,n){if(!n)return;const r=O(n,"next",F.geojson),i=(0,o.An)(r?.href)?.query;if(!i)return;const s=(0,o.An)(e).query,a=Object.keys(s??{}),l=Object.entries(i).filter((([e])=>!a.includes(e))).find((([e,n])=>T.has(e.toLowerCase())&&Number.parseInt(n,10)===t)),u=l?.[0];return u}(S=F||(F={})).json="application/json",S.geojson="application/geo+json",S.openapi="application/vnd.oai.openapi+json;version=3.0"},82832:(e,t,n)=>{n.d(t,{$1:()=>y,CR:()=>g,MB:()=>p,PC:()=>h,Yx:()=>l,bP:()=>c});var r=n(67482),i=n(21325),s=n(30524);class o{constructor(e){this.description=e,this.code=null}}class a{constructor(e){this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error=new o(e)}}function l(e){return new a(e)}class u{constructor(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e}}function c(e){return new u(e)}const d=new Set;function p(e,t,n,r=!1){d.clear();for(const i in n){const o=e.get(i);if(!o)continue;const a=f(o,n[i]);if(d.add(o.name),o&&(r||o.editable)){const e=(0,s.CJ)(o,a);if(e)return l((0,s.uo)(e,o,a));t[o.name]=a}}for(const t of e.requiredFields??[])if(!d.has(t.name))return l(`missing required field "${t.name}"`);return null}function f(e,t){let n=t;return(0,s.WA)(e)&&"string"==typeof t?n=parseFloat(t):(0,s.yM)(e)&&null!=t&&"string"!=typeof t?n=String(t):(0,s.vE)(e)&&"string"==typeof t&&(n=(0,r._U)(t)),(0,s.WX)(n)}let m;function g(e,t){if(!e||!(0,i.fn)(t))return e;if("rings"in e||"paths"in e){if(null==m)throw new TypeError("geometry engine not loaded");return m.simplify(t,e)}return e}async function y(e,t){!(0,i.fn)(e)||"esriGeometryPolygon"!==t&&"esriGeometryPolyline"!==t||await async function(){return null==m&&(m=await Promise.all([n.e(9930),n.e(7559)]).then(n.bind(n,47559))),m}()}const h={supportsAutoIntervalBin:!0,supportsFixedIntervalBin:!0,supportsFixedBoundariesBin:!0,supportsDateBin:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsNormalization:!0,supportedStatisticTypes:["COUNT","SUM","AVG","VAR","STDDEV","MIN","MAX","PERCENTILE_CONT","PERCENTILE_DISC","CentroidAggregate","EnvelopeAggregate","ConvexHullAggregate"],supportedNormalizationTypes:["field","log","naturalLog","percentOfTotal","squareRoot"]}},85113:(e,t,n)=>{n.d(t,{BM:()=>S,bd:()=>_,sO:()=>F,xD:()=>c});var r=n(67482),i=n(49186),s=n(21325),o=n(43334),a=n(92722),l=n(30524);const u={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function c(e){return u[e]}function*d(e){switch(e.type){case"Feature":yield e;break;case"FeatureCollection":for(const t of e.features)t&&(yield t)}}function*p(e){if(e)switch(e.type){case"Point":yield e.coordinates;break;case"LineString":case"MultiPoint":yield*e.coordinates;break;case"MultiLineString":case"Polygon":for(const t of e.coordinates)yield*t;break;case"MultiPolygon":for(const t of e.coordinates)for(const e of t)yield*e}}function f(e){for(const t of e)if(t.length>2)return!0;return!1}function m(e){let t=0;for(let n=0;n<e.length;n++){const r=e[n],i=e[(n+1)%e.length];t+=r[0]*i[1]-i[0]*r[1]}return t<=0}function g(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]||e.push(t),e}function y(e,t,n){switch(t.type){case"LineString":case"MultiPoint":return function(e,t,n){return b(e,t.coordinates,n),e}(e,t,n);case"MultiLineString":return function(e,t,n){for(const r of t.coordinates)b(e,r,n);return e}(e,t,n);case"MultiPolygon":return function(e,t,n){for(const r of t.coordinates){h(e,r[0],n);for(let t=1;t<r.length;t++)w(e,r[t],n)}return e}(e,t,n);case"Point":return function(e,t,n){return x(e,t.coordinates,n),e}(e,t,n);case"Polygon":return function(e,t,n){const r=t.coordinates;h(e,r[0],n);for(let t=1;t<r.length;t++)w(e,r[t],n);return e}(e,t,n)}}function h(e,t,n){const r=g(t);!function(e){return!m(e)}(r)?b(e,r,n):T(e,r,n)}function w(e,t,n){const r=g(t);!function(e){return m(e)}(r)?b(e,r,n):T(e,r,n)}function b(e,t,n){for(const r of t)x(e,r,n);e.lengths.push(t.length)}function T(e,t,n){for(let r=t.length-1;r>=0;r--)x(e,t[r],n);e.lengths.push(t.length)}function x(e,t,n){const[r,i,s]=t;e.coords.push(r,i),n.hasZ&&e.coords.push(s||0)}function A(e){switch(typeof e){case"string":return(0,r.Br)(e)?"esriFieldTypeDate":"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function F(e,t=4326){if(!e)throw new i.A("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new i.A("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});const{crs:n}=e;if(!n)return;const r="string"==typeof n?n:"name"===n.type?n.properties.name:"EPSG"===n.type?n.properties.code:null,o=(0,s.oT)({wkid:t})?new RegExp(".*(CRS84H?|4326)$","i"):new RegExp(`.*(${t})$`,"i");if(!r||!o.test(r))throw new i.A("geojson:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:n})}function S(e,t={}){const n=[],r=new Set,i=new Set;let s,o=!1,a=null,u=!1,{geometryType:m=null}=t;for(const t of d(e)){const{geometry:e,properties:d,id:g}=t;if((!e||(m||(m=c(e.type)),c(e.type)===m))&&(o||(o=f(p(e))),u||(u=null!=g,u&&(s=typeof g,d&&(a=Object.keys(d).filter((e=>d[e]===g))))),d&&a&&u&&null!=g&&(a.length>1?a=a.filter((e=>d[e]===g)):1===a.length&&(a=d[a[0]]===g?a:[])),d))for(const e in d){if(r.has(e))continue;const t=A(d[e]);if("unknown"===t){i.add(e);continue}i.delete(e),r.add(e);const s=(0,l.rS)(e);s&&n.push({name:s,alias:e,type:t})}}const g=(0,l.rS)(1===a?.length&&a[0]||null)??void 0;if(g)for(const e of n)if(e.name===g&&(0,l.WA)(e)){e.type="esriFieldTypeOID";break}return{fields:n,geometryType:m,hasZ:o,objectIdFieldName:g,objectIdFieldType:s,unknownFields:Array.from(i)}}function _(e,t){return Array.from(function*(e,t={}){const{geometryType:n,objectIdField:r}=t;for(const i of e){const{geometry:e,properties:s,id:l}=i;if(e&&c(e.type)!==n)continue;const u=s||{};let d;r&&(d=u[r],null==l||d||(u[r]=d=l));const p=new o.Om(e?y(new a.A,e,t):null,u,null,d);yield p}}(d(e),t))}}}]);