"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[8916],{8916:(e,t,r)=>{r.r(t),r.d(t,{_checkAuthentication:()=>pr,_esriRequestWrapper:()=>lr,_fetchWrapper:()=>sr,_getClientDataCacheCopy:()=>Nt,_setMaxQueryParsingDurationForTesting:()=>gr,_submitJobWrapper:()=>dr,clearClientDataCache:()=>ir,clientDataCache:()=>Ct,executeAddGraphFieldIndex:()=>Jt,executeAddGraphProperties:()=>$t,executeAddNamedTypes:()=>Zt,executeApplyEdits:()=>Ft,executeDeleteGraphFieldIndex:()=>Vt,executeDeleteGraphProperty:()=>qt,executeDeleteNamedType:()=>Ut,executeFindPaths:()=>or,executeFindPathsAsynchronous:()=>nr,executeQuery:()=>Yt,executeQueryStreaming:()=>Bt,executeSearch:()=>Qt,executeSearchStreaming:()=>Ht,executeUpdateGraphProperty:()=>zt,executeUpdateNamedType:()=>Lt,executeUpdateSearchIndex:()=>Kt,fetchAllClientDataKeys:()=>Wt,fetchAsynchronousFindPathsResultData:()=>ar,fetchClientDataAtKeys:()=>Xt,fetchKnowledgeGraph:()=>er,kgRestServices:()=>Ot,refreshDataModel:()=>tr,refreshServiceDefinition:()=>rr});var n,o=r(70333),a=r(78888),i=r(49186),s=r(53966),d=r(74887),l=r(91075),p=r(16930),u=r(90237),c=r(69622),y=r(10107),h=r(56507),g=(r(44208),r(87811),r(40608)),f=r(5443);let _=n=class extends c.A{constructor(e){super(e),this.outSpatialReference=null,this.processExtent=null,this.processSpatialReference=null,this.returnColumnName=!1,this.returnFeatureCollection=!1,this.returnM=!1,this.returnZ=!1}static from(e){return(0,h.PZ)(n,e)}};(0,u._)([(0,y.MZ)({type:p.A})],_.prototype,"outSpatialReference",void 0),(0,u._)([(0,y.MZ)({type:f.A})],_.prototype,"processExtent",void 0),(0,u._)([(0,y.MZ)({type:p.A})],_.prototype,"processSpatialReference",void 0),(0,u._)([(0,y.MZ)({nonNullable:!0})],_.prototype,"returnColumnName",void 0),(0,u._)([(0,y.MZ)({nonNullable:!0})],_.prototype,"returnFeatureCollection",void 0),(0,u._)([(0,y.MZ)({nonNullable:!0})],_.prototype,"returnM",void 0),(0,u._)([(0,y.MZ)({nonNullable:!0})],_.prototype,"returnZ",void 0),_=n=(0,u._)([(0,g.$)("esri.rest.geoprocessor.GPOptions")],_);var w=r(17136),m=r(20437),v=r(25482);let b=class extends v.A{constructor(){super(...arguments),this.extent=null,this.height=null,this.href=null,this.opacity=1,this.rotation=0,this.scale=null,this.visible=!0,this.width=null}};(0,u._)([(0,y.MZ)({type:f.A})],b.prototype,"extent",void 0),(0,u._)([(0,y.MZ)()],b.prototype,"height",void 0),(0,u._)([(0,y.MZ)()],b.prototype,"href",void 0),(0,u._)([(0,y.MZ)()],b.prototype,"opacity",void 0),(0,u._)([(0,y.MZ)()],b.prototype,"rotation",void 0),(0,u._)([(0,y.MZ)()],b.prototype,"scale",void 0),(0,u._)([(0,y.MZ)()],b.prototype,"visible",void 0),(0,u._)([(0,y.MZ)()],b.prototype,"width",void 0),b=(0,u._)([(0,g.$)("esri.layers.support.MapImage")],b);var T=r(2272),G=r(93223),A=r(2073);let M=class extends v.A{constructor(e){super(e),this.area=0,this.units=null}};(0,u._)([(0,y.MZ)({json:{write:!0}})],M.prototype,"area",void 0),(0,u._)([(0,G.e)(A.UO)],M.prototype,"units",void 0),M=(0,u._)([(0,g.$)("esri.rest.support.ArealUnit")],M);let P=class extends v.A{constructor(e){super(e),this.itemId=null,this.url=null}};(0,u._)([(0,y.MZ)({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],P.prototype,"itemId",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],P.prototype,"url",void 0),P=(0,u._)([(0,g.$)("esri.rest.support.DataFile")],P);var I=r(22671);let S=class extends v.A{constructor(e){super(e),this.distance=0,this.units=null}};(0,u._)([(0,y.MZ)({json:{write:!0}})],S.prototype,"distance",void 0),(0,u._)([(0,G.e)(A.Y8)],S.prototype,"units",void 0),S=(0,u._)([(0,g.$)("esri.rest.support.LinearUnit")],S);var E=r(66552);const R="multi-value-",x=new E.J({GPArealUnit:"areal-unit",GPBoolean:"boolean",GPComposite:"composite",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",Field:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string",GPValueTable:"value-table","GPMultiValue:GPArealUnit":`${R}areal-unit`,"GPMultiValue:GPBoolean":`${R}boolean`,"GPMultiValue:GPComposite":`${R}composite`,"GPMultiValue:GPDataFile":`${R}data-file`,"GPMultiValue:GPDate":`${R}date`,"GPMultiValue:GPDouble":`${R}double`,"GPMultiValue:GPFeatureRecordSetLayer":`${R}feature-record-set-layer`,"GPMultiValue:Field":`${R}field`,"GPMultiValue:GPLinearUnit":`${R}linear-unit`,"GPMultiValue:GPLong":`${R}long`,"GPMultiValue:GPRasterData":`${R}raster-data`,"GPMultiValue:GPRasterDataLayer":`${R}raster-data-layer`,"GPMultiValue:GPRecordSet":`${R}record-set`,"GPMultiValue:GPString":`${R}string`});let k=class extends v.A{constructor(e){super(e),this.dataType=null,this.paramName=null,this.value=null}};(0,u._)([(0,G.e)(x,{ignoreUnknown:!1})],k.prototype,"dataType",void 0),(0,u._)([(0,y.MZ)()],k.prototype,"paramName",void 0),(0,u._)([(0,y.MZ)()],k.prototype,"value",void 0),k=(0,u._)([(0,g.$)("esri.rest.support.ParameterValue")],k);var D=r(36005);let j=class extends v.A{constructor(e){super(e),this.format=null,this.itemId=null,this.type=null,this.url=null}readType(e){return"ImageService"===e?"image-service":null}};async function C(e,t){switch(e){case"areal-unit":return M.fromJSON(t);case"boolean":case"double":case"long":case"string":case"value-table":return t;case"date":return new Date(t);case"data-file":return P.fromJSON(t);case"linear-unit":return S.fromJSON(t);case"feature-record-set-layer":if("url"in t)return P.fromJSON(t);if("layerDefinition"in t){const e=new(0,(await Promise.all([r.e(6131),r.e(8219),r.e(5715),r.e(13),r.e(1214),r.e(9953),r.e(1956),r.e(4796),r.e(3029),r.e(4111),r.e(8506),r.e(3600),r.e(3651)]).then(r.bind(r,13600))).default),{layerDefinition:n,featureSet:o}=t;return e.read({layerDefinition:n,featureSet:o},{origin:"portal-item"}),e.spatialReference=p.A.fromJSON(o.spatialReference??n.spatialReference??n.extent.spatialReference),e}return I.A.fromJSON(t);case"record-set":return"url"in t?P.fromJSON(t):I.A.fromJSON(t);case"raster-data":case"raster-data-layer":return"mapImage"in t?b.fromJSON(t.mapImage):j.fromJSON(t);case"field":return m.A.fromJSON(t)}}async function N(e){const t=x.fromJSON(e.dataType),{paramName:r}=e,n=function(e){return e.startsWith(R)}(t)?await async function(e,t){const r=function(e){return e.replace(R,"")}(e),n="composite"===r?t.map((e=>C(x.fromJSON(e.dataType),e.value))):t.map((e=>C(r,e)));return Promise.all(n)}(t,e.value):await C(t,e.value);return new k({dataType:t,paramName:r,value:n})}function O(e,t,r){for(const t in e){const r=e[t];Array.isArray(r)?e[t]=JSON.stringify(r.map((e=>O({item:e},!0).item))):r instanceof Date&&(e[t]=r.getTime())}return(0,T.lF)(e,t,r)}(0,u._)([(0,y.MZ)()],j.prototype,"format",void 0),(0,u._)([(0,y.MZ)({json:{name:"itemID",write:!0}})],j.prototype,"itemId",void 0),(0,u._)([(0,y.MZ)()],j.prototype,"type",void 0),(0,u._)([(0,D.w)("type")],j.prototype,"readType",null),(0,u._)([(0,y.MZ)({json:{write:!0}})],j.prototype,"url",void 0),j=(0,u._)([(0,g.$)("esri.rest.support.RasterData")],j);var F,Z=r(37807);const U=(0,E.O)()({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"},{ignoreUnknown:!1}),L=1e3;let $=class extends v.A{static{F=this}constructor(e){super(e),this.jobId=null,this.jobStatus=null,this.messages=null,this.progress=null,this.requestOptions=null,this.sourceUrl=null,this._cancelJobTimer=void 0,this._jobCompletionTimer=void 0}async cancelJob(e){const{jobId:t,sourceUrl:r}=this,{path:n}=(0,T.Dl)(r),o={...this.requestOptions,...e,query:{f:"json"}},i=`${n}/jobs/${t}/cancel`,{data:s}=await(0,a.A)(i,o),{messages:l,jobStatus:p,progress:u}=F.fromJSON(s);return this.set({messages:l,jobStatus:p,progress:u}),"job-cancelled"===p?this:new Promise(((t,r)=>{(0,d.u7)(o.signal,(()=>{this.clearCancelJobTimer(),r((0,d.NK)())})),this.clearCancelJobTimer();const n=()=>{this._cancelJobTimer||r((0,d.NK)()),this.checkJobStatus(e).then((({jobStatus:e})=>{switch(e){case"job-cancelling":default:this._cancelJobTimer=setTimeout(n,L);break;case"job-deleted":case"job-deleting":case"job-executing":case"job-failed":case"job-new":case"job-submitted":case"job-succeeded":case"job-timed-out":case"job-waiting":r(this);break;case"job-cancelled":t(this)}})).catch((e=>{r(e)}))};this._cancelJobTimer=setTimeout(n,L)}))}destroy(){clearInterval(this._cancelJobTimer),clearInterval(this._jobCompletionTimer)}async checkJobStatus(e){const{path:t}=(0,T.Dl)(this.sourceUrl),r={...this.requestOptions,...e,query:{f:"json"}},n=`${t}/jobs/${this.jobId}`,{data:o}=await(0,a.A)(n,r),{messages:i,jobStatus:s,progress:d}=F.fromJSON(o);return this.set({messages:i,jobStatus:s,progress:d}),this}async fetchResultData(e,t,r){t=_.from(t||{});const{returnColumnName:n,returnFeatureCollection:o,returnM:i,returnZ:s,outSpatialReference:d}=t,{path:l}=(0,T.Dl)(this.sourceUrl),p=O({returnColumnName:n||null,returnFeatureCollection:o||null,returnM:i||null,returnZ:s||null,outSR:d,returnType:"data",f:"json"},null),u={...this.requestOptions,...r,query:p},c=`${l}/jobs/${this.jobId}/results/${e}`,{data:y}=await(0,a.A)(c,u);return N(y)}async fetchResultImage(e,t,r){const{path:n}=(0,T.Dl)(this.sourceUrl),o=O({...t.toJSON(),f:"json"}),i={...this.requestOptions,...r,query:o},s=`${n}/jobs/${this.jobId}/results/${e}`,{data:d}=await(0,a.A)(s,i);return N(d)}async fetchResultMapImageLayer(){const{path:e}=(0,T.Dl)(this.sourceUrl),t=e.indexOf("/GPServer/"),n=`${e.slice(0,Math.max(0,t))}/MapServer/jobs/${this.jobId}`;return new(0,(await Promise.all([r.e(6131),r.e(8219),r.e(5715),r.e(13),r.e(1214),r.e(1956),r.e(4796),r.e(4111),r.e(364),r.e(5962),r.e(7656),r.e(8407)]).then(r.bind(r,7656))).default)({url:n})}async waitForJobCompletion(e={}){const{interval:t=L,signal:r,statusCallback:n}=e;return new Promise(((e,o)=>{(0,d.u7)(r,(()=>{this.clearJobCompletionTimer(),o((0,d.NK)())})),this.clearJobCompletionTimer();const a=()=>{this._jobCompletionTimer||o((0,d.NK)()),this.checkJobStatus().then((({jobStatus:r})=>{switch(r){case"job-succeeded":e(this);break;case"job-executing":case"job-new":case"job-submitted":case"job-waiting":n&&n(this),this._jobCompletionTimer=setTimeout(a,t);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-failed":case"job-timed-out":o(this);break;default:this._jobCompletionTimer=setTimeout(a,t)}})).catch((e=>{o(e)}))};this._jobCompletionTimer=setTimeout(a,t)}))}clearCancelJobTimer(){clearTimeout(this._cancelJobTimer),this._cancelJobTimer=void 0}clearJobCompletionTimer(){clearTimeout(this._jobCompletionTimer),this._jobCompletionTimer=void 0}};(0,u._)([(0,y.MZ)()],$.prototype,"jobId",void 0),(0,u._)([(0,G.e)(U,{ignoreUnknown:!1})],$.prototype,"jobStatus",void 0),(0,u._)([(0,y.MZ)({type:[Z.A]})],$.prototype,"messages",void 0),(0,u._)([(0,y.MZ)()],$.prototype,"progress",void 0),(0,u._)([(0,y.MZ)()],$.prototype,"requestOptions",void 0),(0,u._)([(0,y.MZ)({json:{write:!0}})],$.prototype,"sourceUrl",void 0),$=F=(0,u._)([(0,g.$)("esri.rest.support.JobInfo")],$);let q=class extends c.A{constructor(e){super(e),this.headerKeys=[],this.outSpatialReference=null,this.exceededTransferLimit=!1}};(0,u._)([(0,y.MZ)()],q.prototype,"headerKeys",void 0),(0,u._)([(0,y.MZ)()],q.prototype,"outSpatialReference",void 0),(0,u._)([(0,y.MZ)()],q.prototype,"exceededTransferLimit",void 0),q=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphQueryResultHeader")],q);let z=class extends c.A{constructor(e){super(e),this.resultRows=[],this.resultHeader=new q}};(0,u._)([(0,y.MZ)()],z.prototype,"resultRows",void 0),(0,u._)([(0,y.MZ)()],z.prototype,"resultHeader",void 0),z=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphQueryResult")],z);let J=class extends c.A{constructor(e){super(e),this.resultRowsStream=new ReadableStream,this.resultHeader=new q}};(0,u._)([(0,y.MZ)()],J.prototype,"resultRowsStream",void 0),(0,u._)([(0,y.MZ)()],J.prototype,"resultHeader",void 0),J=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphQueryStreamingResult")],J);let V=class extends v.A{constructor(e){super(e),this.name=null,this.unique=null,this.ascending=!0,this.description="",this.fieldNames=[]}};(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],V.prototype,"name",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],V.prototype,"unique",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],V.prototype,"ascending",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],V.prototype,"description",void 0),(0,u._)([(0,y.MZ)({type:[String],json:{write:!0}})],V.prototype,"fieldNames",void 0),V=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.FieldIndex")],V);let K=class extends v.A{constructor(e){super(e),this.name=null,this.alias=null,this.fieldType=null,this.geometryType=null,this.hasM=null,this.hasZ=null,this.nullable=null,this.editable=!0,this.required=!1,this.defaultVisibility=!0,this.systemMaintained=null,this.role="esriGraphPropertyUNSPECIFIED",this.defaultValue=null}};(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],K.prototype,"name",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],K.prototype,"alias",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],K.prototype,"fieldType",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],K.prototype,"geometryType",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],K.prototype,"hasM",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],K.prototype,"hasZ",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],K.prototype,"nullable",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],K.prototype,"editable",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],K.prototype,"required",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],K.prototype,"defaultVisibility",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],K.prototype,"systemMaintained",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],K.prototype,"role",void 0),(0,u._)([(0,y.MZ)({json:{write:!0}})],K.prototype,"defaultValue",void 0),K=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphProperty")],K);let Y=class extends v.A{constructor(e){super(e),this.name=null,this.alias=null,this.role="Regular",this.strict=null,this.properties=[],this.fieldIndexes=[],this.type=null}};(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],Y.prototype,"name",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],Y.prototype,"alias",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],Y.prototype,"role",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],Y.prototype,"strict",void 0),(0,u._)([(0,y.MZ)({type:[K],json:{write:!0}})],Y.prototype,"properties",void 0),(0,u._)([(0,y.MZ)({type:[V],json:{write:!0}})],Y.prototype,"fieldIndexes",void 0),Y=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphObjectType")],Y);let B=class extends Y{constructor(e){super(e),this.type="entity"}};B=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.EntityType")],B);let Q=class extends Y{constructor(e){super(e),this.endPoints=[],this.type="relationship"}};(0,u._)([(0,y.MZ)({json:{write:!0}})],Q.prototype,"endPoints",void 0),Q=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.RelationshipType")],Q);let H=class extends v.A{constructor(e){super(e),this.value=null,this.behavior=null}};(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],H.prototype,"value",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],H.prototype,"behavior",void 0),H=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.SourceTypeValueBehavior")],H);let W=class extends v.A{constructor(e){super(e),this.timestamp=null,this.spatialReference=null,this.strict=null,this.objectIdField=null,this.globalIdField=null,this.arcgisManaged=null,this.identifierInfo=null,this.searchIndexes=[],this.entityTypes=[],this.relationshipTypes=[],this.metaEntityTypes=[],this.provenanceSourceTypeValues=[]}};(0,u._)([(0,y.MZ)({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.timestamp=e?.getTime()}}}})],W.prototype,"timestamp",void 0),(0,u._)([(0,y.MZ)({type:p.A,json:{write:!0}})],W.prototype,"spatialReference",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],W.prototype,"strict",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],W.prototype,"objectIdField",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],W.prototype,"globalIdField",void 0),(0,u._)([(0,y.MZ)()],W.prototype,"arcgisManaged",void 0),(0,u._)([(0,y.MZ)()],W.prototype,"identifierInfo",void 0),(0,u._)([(0,y.MZ)()],W.prototype,"searchIndexes",void 0),(0,u._)([(0,y.MZ)({type:[B],json:{write:!0}})],W.prototype,"entityTypes",void 0),(0,u._)([(0,y.MZ)({type:[Q],json:{write:!0}})],W.prototype,"relationshipTypes",void 0),(0,u._)([(0,y.MZ)({type:[B],json:{write:!0}})],W.prototype,"metaEntityTypes",void 0),(0,u._)([(0,y.MZ)({type:[H],json:{write:!0}})],W.prototype,"provenanceSourceTypeValues",void 0),W=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.DataModel")],W);let X=class extends v.A{constructor(e){super(e),this.capabilities=[],this.supportsSearch=!1,this.supportedQueryFormats=[],this.allowGeometryUpdates=!1,this.searchMaxRecordCount=null,this.serviceCapabilities=null,this.maxRecordCount=null,this.description="",this.copyrightText="",this.units="",this.spatialReference=null,this.currentVersion=null,this.dateFieldsTimeReference=null,this.serviceItemId="",this.supportsDocuments=!1,this.dataEditingNotSupported=!1,this.schemaEditingNotSupported=!1,this.supportsProvenance=!1}};(0,u._)([(0,y.MZ)({type:[String],json:{write:!0}})],X.prototype,"capabilities",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],X.prototype,"supportsSearch",void 0),(0,u._)([(0,y.MZ)({type:[String],json:{write:!0}})],X.prototype,"supportedQueryFormats",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],X.prototype,"allowGeometryUpdates",void 0),(0,u._)([(0,y.MZ)({type:Number,json:{write:!0}})],X.prototype,"searchMaxRecordCount",void 0),(0,u._)([(0,y.MZ)({type:Object,json:{write:!0}})],X.prototype,"serviceCapabilities",void 0),(0,u._)([(0,y.MZ)({type:Number,json:{write:!0}})],X.prototype,"maxRecordCount",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],X.prototype,"description",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],X.prototype,"copyrightText",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],X.prototype,"units",void 0),(0,u._)([(0,y.MZ)({type:p.A,json:{write:!0}})],X.prototype,"spatialReference",void 0),(0,u._)([(0,y.MZ)({type:Number,json:{write:!0}})],X.prototype,"currentVersion",void 0),(0,u._)([(0,y.MZ)({type:Object,json:{write:!0}})],X.prototype,"dateFieldsTimeReference",void 0),(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],X.prototype,"serviceItemId",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],X.prototype,"supportsDocuments",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],X.prototype,"dataEditingNotSupported",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],X.prototype,"schemaEditingNotSupported",void 0),(0,u._)([(0,y.MZ)({type:Boolean,json:{write:!0}})],X.prototype,"supportsProvenance",void 0),X=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.ServiceDefinition")],X);let ee=class extends v.A{constructor(e){super(e),this.url=null,this.dataModel=null,this.serviceDefinition=null}};function te(e,t,r){if(0!==e.error_code)throw new i.A(t,r,{errorCode:e.error_code,errorMessage:e.error_message})}function re(e){return e?.error_code?new i.A("knowledgeGraphService:server-or-decoding-error",e.error_message,{errorCode:e.error_code}):void 0}function ne(e,t,r,n){const o=new r.ClientDataKey;o.deleteLater(),o.key_string=e;const a=new r.ClientDataFetchRequestParameter;a.deleteLater(),a.set_key(o);const i=t.get(e);return i&&!n&&(a.v_tag={v_tag:i.version}),a}(0,u._)([(0,y.MZ)({type:String,json:{write:!0}})],ee.prototype,"url",void 0),(0,u._)([(0,y.MZ)({type:W,json:{write:!0}})],ee.prototype,"dataModel",void 0),(0,u._)([(0,y.MZ)({type:X,json:{write:!0}})],ee.prototype,"serviceDefinition",void 0),ee=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.KnowledgeGraph")],ee);var oe,ae,ie,se=r(45724),de=r(48526),le=r(86738),pe=r(39829),ue=r(82799);function ce(e,t){const r=new t.ArrayValue;return r.deleteLater(),e.forEach((e=>{r.add_value(ge(e,t))})),r}function ye(e,t){const r=new t.ObjectValue;r.deleteLater();for(const[n,o]of Object.entries(e))r.set_key_value(n,ge(o,t));return r}function he(e,t){if(e instanceof de.A)return function(e,t){const r=new t.GeometryValue;r.deleteLater(),r.geometry_type=r.geometry_type=t.esriGeometryType.esriGeometryMultipoint,r.has_z=e.hasZ,r.has_m=e.hasM;const n=[],o=[];o[0]=e.points.length;let a=0;return e.points.forEach((e=>{e.forEach((e=>{n[a]=e,a++}))})),r.coords=new Float64Array(n),r.lengths=new Uint32Array(o),r}(e,t);if(e instanceof le.A)return function(e,t){const r=new t.GeometryValue;r.deleteLater(),r.geometry_type=t.esriGeometryType.esriGeometryPoint,r.has_z=e.hasZ,r.has_m=e.hasM;const n=[],o=[];o[0]=1,n[0]=e.x,n[1]=e.y;let a=2;return e.hasZ&&(n[a]=e.z,a++),e.hasM&&(n[a]=e.m,a++),r.coords=new Float64Array(n),r.lengths=new Uint32Array(o),r}(e,t);if(e instanceof ue.A||e instanceof pe.A)return function(e,t){const r=new t.GeometryValue;r.deleteLater(),r.has_z=e.hasZ,r.has_m=e.hasM;const n=[],o=[];let a=[];e instanceof ue.A?(r.geometry_type=t.esriGeometryType.esriGeometryPolyline,a=e.paths):e instanceof pe.A&&(r.geometry_type=t.esriGeometryType.esriGeometryPolygon,a=e.rings);let i=0,s=0;return a.forEach((e=>{let t=0;e.forEach((e=>{t++,e.forEach((e=>{n[s]=e,s++}))})),o[i]=t,i++})),r.coords=new Float64Array(n),r.lengths=new Uint32Array(o),r}(e,t);throw new i.A("knowledge-graph:unsupported-geometry","Only Point, Multipoint, Polyline, and Polygon geometry are supported by ArcGIS Knowledge",{geometry:e})}function ge(e,t){if(null==e)return"";if("object"!=typeof e)return e;if(e instanceof Date)return e;if(e instanceof l.A)return he(e,t);if(Array.isArray(e)){const r=new t.ArrayValue;return r.deleteLater(),e.forEach((e=>{r.add_value(ge(e,t))})),r}return ye(e,t)}!function(e){e[e.OBJECT=0]="OBJECT",e[e.ENTITY=1]="ENTITY",e[e.RELATIONSHIP=2]="RELATIONSHIP",e[e.PATH=3]="PATH",e[e.ARRAY=4]="ARRAY"}(oe||(oe={})),function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(ae||(ae={})),function(e){e[e.exclude=0]="exclude",e[e.include=1]="include"}(ie||(ie={}));var fe,_e,we,me,ve=r(35448);function be(e,t){if(!e.typeName)throw new i.A("knowledge-graph:no-type-name","You must indicate the entity/relationship named object type to apply edits");if(!("originId"in e)){const r=new t.EntityValue;r.deleteLater(),r.type_name=e.typeName;for(const[n,o]of Object.entries(e.properties))r.set_key_value(n,Pe(o,t));return e.id&&r.set_id(e.id),r}if("originId"in e&&"destinationId"in e){const r=new t.RelationshipValue;r.deleteLater(),r.type_name=e.typeName;for(const[n,o]of Object.entries(e.properties))r.set_key_value(n,Pe(o,t));return e.id&&r.set_id(e.id),e.originId&&e.destinationId&&r.set_related_entity_ids(e.originId,e.destinationId),r}throw new i.A("knowledge-graph:applyEdits-encoding-failure","Could not determine the type of a named graph object passed to the encoder")}function Te(e,t){const r=new t.GraphProperty;return r.deleteLater(),r.name=e.name,r.alias=e.alias??"",r.field_type={value:ve.r5[e.fieldType]},r.geometry_type={value:e.geometryType?ve.bV[e.geometryType]:ve.bV.esriGeometryNull},r.has_m=e.hasM??!1,r.has_z=e.hasZ??!1,r.nullable=e.nullable??!1,r.editable=e.editable,r.required=e.required,r.default_visibility=e.defaultVisibility,r.system_maintained=e.systemMaintained??!1,r.role={value:ve.ti[e.role]},r.default_value=Pe(e.defaultValue,t),r}function Ge(e,t){const r=new t.SearchIndexProperties;r.deleteLater();for(const t of e.propertyNames)r.add_search_property_name(t);return r}function Ae(e,t,r){r.name=e.name,r.alias=e.alias??"",r.role={value:ve.Eq[e.role]},r.strict=e.strict;for(const n of e.properties){const e=Te(n,t);r.add_property(e)}return r}function Me(e,t){return e.hasOwnProperty("alias")&&(t.alias=e.alias),t}function Pe(e,t){return null==e?null:"object"!=typeof e||e instanceof Date?e:e instanceof l.A?he(e,t):null}function Ie(e){const t=e.get_keys(),r=new Array;for(let e=0;e<t.get_keys_count();e++){const n=t.get_key_at(e);n.get_client_data_key_type().value===fe.ClientDataKeyTypeString&&r.push(n.key_string)}return r}!function(e){e[e.ClientDataKeyTypeUNSPECIFIED=0]="ClientDataKeyTypeUNSPECIFIED",e[e.ClientDataKeyTypeString=1]="ClientDataKeyTypeString"}(fe||(fe={})),function(e){e[e.ClientDataTypeUNSPECIFIED=0]="ClientDataTypeUNSPECIFIED",e[e.ClientDataTypeString=1]="ClientDataTypeString"}(_e||(_e={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.ClientData=1]="ClientData",e[e.NotModified=2]="NotModified"}(we||(we={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Error=1]="Error",e[e.ClientDataValue=2]="ClientDataValue"}(me||(me={}));let Se=class extends c.A{constructor(e){super(e),this.decoderError=null,this.resultsCount=0,this.results=[],this.updatedKnowledgeGraph=null}};(0,u._)([(0,y.MZ)()],Se.prototype,"decoderError",void 0),(0,u._)([(0,y.MZ)()],Se.prototype,"resultsCount",void 0),(0,u._)([(0,y.MZ)()],Se.prototype,"results",void 0),(0,u._)([(0,y.MZ)()],Se.prototype,"updatedKnowledgeGraph",void 0),Se=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphDataModelOperationResult")],Se);const Ee=Se;let Re=class extends Ee{constructor(e){super(e)}};Re=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphAddFieldIndexResult")],Re);const xe=Re;let ke=class extends Ee{constructor(e){super(e),this.entityAddResultsCount=0,this.relationshipAddResultsCount=0,this.entityAddResults=[],this.relationshipAddResults=[]}};(0,u._)([(0,y.MZ)()],ke.prototype,"entityAddResultsCount",void 0),(0,u._)([(0,y.MZ)()],ke.prototype,"relationshipAddResultsCount",void 0),(0,u._)([(0,y.MZ)()],ke.prototype,"entityAddResults",void 0),(0,u._)([(0,y.MZ)()],ke.prototype,"relationshipAddResults",void 0),ke=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphAddNamedTypesResult")],ke);const De=ke;let je=class extends Ee{constructor(e){super(e)}};je=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphAddPropertyResult")],je);const Ce=je;let Ne=class extends Ee{constructor(e){super(e)}};Ne=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphDeleteFieldIndexResult")],Ne);const Oe=Ne;let Fe=class extends Ee{constructor(e){super(e)}};Fe=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphDeleteNamedTypeResult")],Fe);const Ze=Fe;let Ue=class extends Ee{constructor(e){super(e)}};Ue=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphDeletePropertyResult")],Ue);const Le=Ue;let $e=class extends Ee{constructor(e){super(e)}};$e=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphUpdateNamedTypesResult")],$e);const qe=$e;let ze=class extends Ee{constructor(e){super(e)}};ze=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphUpdatePropertyResult")],ze);const Je=ze;let Ve=class extends Ee{constructor(e){super(e)}};Ve=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphUpdateSearchIndexResult")],Ve);const Ke=Ve;function Ye(e,t){const r=[];for(let n=0;n<t;n++){const t=e.get_result_at(n);r.push({name:t.get_name(),error:re(t.get_error())})}return r}function Be(e){const t=e.get_results_count(),r=e.get_entity_type_add_results_count(),n=e.get_relationship_type_add_results_count(),o=new De({resultsCount:t,results:Ye(e,t),decoderError:re(e.error),entityAddResultsCount:r,relationshipAddResultsCount:n});for(let t=0;t<r;t++){const r=e.get_entity_type_add_results_at(t),n=r.get_name(),a=r.get_error();o.entityAddResults.push({name:n,error:re(a)})}for(let t=0;t<n;t++){const r=e.get_relationship_type_add_results_at(t),n=r.get_name(),a=r.get_error();o.relationshipAddResults.push({name:n,error:re(a)})}return o}function Qe(e){const t=e.get_results_count();return new qe({resultsCount:t,results:Ye(e,t),decoderError:re(e.error)})}function He(e){const t=e.get_results_count();return new Ze({resultsCount:t,results:Ye(e,t),decoderError:re(e.error)})}function We(e){const t=e.get_results_count();return new Ce({resultsCount:t,results:Ye(e,t),decoderError:re(e.error)})}function Xe(e){const t=e.get_results_count();return new Le({resultsCount:t,results:Ye(e,t),decoderError:re(e.error)})}function et(e){const t=e.get_results_count();return new Je({resultsCount:t,results:Ye(e,t),decoderError:re(e.error)})}function tt(e){const t=e.get_results_count();return new Ke({resultsCount:t,results:Ye(e,t),decoderError:re(e.error)})}function rt(e){const t=e.get_results_count();return new xe({resultsCount:t,results:Ye(e,t),decoderError:re(e.error)})}function nt(e){const t=e.get_results_count();return new Oe({resultsCount:t,results:Ye(e,t),decoderError:re(e.error)})}let ot=class extends c.A{constructor(e){super(e),this.name=null,this.supportedCategory="esriTypeUNSPECIFIED",this.analyzers=[],this.searchProperties=new Map}};(0,u._)([(0,y.MZ)()],ot.prototype,"name",void 0),(0,u._)([(0,y.MZ)()],ot.prototype,"supportedCategory",void 0),(0,u._)([(0,y.MZ)()],ot.prototype,"analyzers",void 0),(0,u._)([(0,y.MZ)()],ot.prototype,"searchProperties",void 0),ot=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.SearchIndex")],ot);let at=!1;function it(e){return e.deleteLater(),new B(dt(e))}function st(e){return e.deleteLater(),new V({name:e.name,unique:e.unique,ascending:e.ascending,description:e.description,fieldNames:yt(e.fields)})}function dt(e){return{name:e.name,alias:e.alias,role:ve.Eq[e.role.value],strict:e.strict,properties:ht(e.properties),fieldIndexes:gt(e.field_indexes)}}function lt(e){return e.deleteLater(),new K({alias:e.alias,name:e.name,fieldType:ve.r5[e.field_type.value]?ve.r5[e.field_type.value]:void 0,geometryType:ve.bV[e.geometry_type.value]?ve.bV[e.geometry_type.value]:null,hasM:e.has_m,hasZ:e.has_z,nullable:e.nullable,editable:e.editable,required:e.required,defaultVisibility:e.default_visibility,systemMaintained:e.system_maintained,role:ve.ti[e.role.value],defaultValue:e.default_value})}function pt(e){e.deleteLater();const t=dt(e),r=[];for(let t=0;t<e.end_points.size();t++){const n=e.end_points.get(t);r.push({originEntityType:n.origin_entity_type,destinationEntityType:n.dest_entity_type})}return e.end_points.delete(),new Q(Object.assign({endPoints:r},t))}function ut(e){return new H({behavior:e.behavior,value:e.value})}function ct(e){const t=[];for(let r=0;r<e.size();r++)t.push(it(e.get(r)));return e.delete(),t}function yt(e){const t=[];for(let r=0;r<e.size();r++)t.push(e.get(r));return e.delete(),t}function ht(e){const t=[];for(let r=0;r<e.size();r++){const n=lt(e.get(r));"esriFieldTypeBigInteger"===n.fieldType&&(at=!0),t.push(n)}return e.delete(),t}function gt(e){const t=[];for(let r=0;r<e.size();r++)t.push(st(e.get(r)));return e.delete(),t}function ft(e){const t=[];for(let r=0;r<e.size();r++)t.push(pt(e.get(r)));return e.delete(),t}function _t(e){const t=[];for(let r=0;r<e.size();r++){const n=e.get(r);n.deleteLater(),t.push(ut(n))}return e.delete(),t}function wt(e){const t=[];for(let r=0;r<e.size();r++){const n=new ot,o=e.get(r);n.name=o.name,n.supportedCategory=ve.nP[o.supported_category.value];const a=o.analyzers.size();for(let e=0;e<a;e++)n.analyzers.push({name:o.analyzers.get(e).name});o.analyzers.delete();for(let e=0;e<o.search_properties.keys().size();e++){const t=o.search_properties.keys().get(e),r=o.search_properties.get(t),a=[];for(let e=0;e<r.property_names.size();e++)a.push(r.property_names.get(e));n.searchProperties.set(t,{propertyNames:a})}t.push(n)}return e.delete(),t}var mt,vt=r(25927),bt=(r(77901),r(40662)),Tt=r(42095),Gt=r(23150);function At(e,t){const r={paths:[],hasM:!1,hasZ:!1},n=Mt(e,r),{coords:o,geometry_type:a,lengths:s}=e;if(a.value!==t)throw new i.A("KnowledgeGraph:illegal-geometry-type","Illegal Geometry type for multipath conversion");let d=0;return s.forEach((e=>{const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e[t]=o[d],d++;t.push(e)}r.paths.push(t)})),r}function Mt(e,t){let r=2;return e.has_z?(t.hasZ=e.has_z,r++):t.hasZ=!1,e.has_m?(t.hasM=e.has_m,r++):t.hasM=!1,r}!function(e){e[e.ESRI_GEOMETRY_NULL=0]="ESRI_GEOMETRY_NULL",e[e.ESRI_GEOMETRY_POINT=1]="ESRI_GEOMETRY_POINT",e[e.ESRI_GEOMETRY_MULTIPOINT=2]="ESRI_GEOMETRY_MULTIPOINT",e[e.ESRI_GEOMETRY_POLYLINE=3]="ESRI_GEOMETRY_POLYLINE",e[e.ESRI_GEOMETRY_POLYGON=4]="ESRI_GEOMETRY_POLYGON",e[e.ESRI_GEOMETRY_ENVELOPE=5]="ESRI_GEOMETRY_ENVELOPE",e[e.ESRI_GEOMETRY_ANY=6]="ESRI_GEOMETRY_ANY",e[e.ESRI_GEOMETRY_MULTI_PATCH=7]="ESRI_GEOMETRY_MULTI_PATCH"}(mt||(mt={}));const Pt=()=>s.A.getLogger("esri.rest.knowledgeGraph.WasmToQueryResponseObjConstructors");function It(e,t,r){return((e,t,r)=>{if(null==e)return null;if("object"!=typeof e)return e;if("getDate"in e)return e;if("geometry_type"in e)switch(e.geometry_type.value){case null:return null;case mt.ESRI_GEOMETRY_POINT:return function(e,t){const r={spatialReference:t};let n=2;Mt(e,r);const o=e.coords;return r.x=o[0],r.y=o[1],e.has_z&&(r.z=o[n],n++),e.has_m&&(r.m=o[n]),new le.A(r)}(e,r);case mt.ESRI_GEOMETRY_MULTIPOINT:return function(e,t){const r={spatialReference:t},n=Mt(e,r),o=e.lengths,a=e.coords,i=o[0];r.points=[];let s=0;for(let e=0;e<i;e++){const e=[];for(let t=0;t<n;t++)e[t]=a[s],s++;r.points.push(e)}return new de.A(r)}(e,r);case mt.ESRI_GEOMETRY_POLYLINE:return function(e,t){const{paths:r,hasM:n,hasZ:o}=At(e,mt.ESRI_GEOMETRY_POLYLINE);return new ue.A({paths:r,hasM:n,hasZ:o,spatialReference:t})}(e,r);case mt.ESRI_GEOMETRY_POLYGON:return function(e,t){const{paths:r,hasM:n,hasZ:o}=At(e,mt.ESRI_GEOMETRY_POLYGON);return new pe.A({rings:r,hasM:n,hasZ:o,spatialReference:t})}(e,r);case mt.ESRI_GEOMETRY_ENVELOPE:case mt.ESRI_GEOMETRY_MULTI_PATCH:return Pt().warnOnce("Envelope and Multipatch are not supported on knowledge entities, but one of those geometry types was detected. Result interpreted as null"),null;case mt.ESRI_GEOMETRY_NULL:case mt.ESRI_GEOMETRY_ANY:default:return Pt().warnOnce("Unknown or blank geometry type returned - Result interpreted as null"),null}else{if(!("object_value_type"in e))return Pt().warnOnce("A decoded value came back of a type that is not supported. Result interpreted as null"),null;switch(e.object_value_type.value){case oe.OBJECT:return function(e,t,r){return new bt.A(Et(e,t,r))}(e,t,r);case oe.ENTITY:return St(e,t,r);case oe.RELATIONSHIP:return Rt(e,t,r);case oe.PATH:return function(e,t,r){const n=e.entity_count(),o=e.relationship_count(),a=[];for(let i=0;i<n;i++)a.push(St(e.get_entity_at(i),t,r)),i<o&&a.push(Rt(e.get_relationship_at(i),t,r));return new Tt.A({path:a})}(e,t,r);case oe.ARRAY:return function(e,t,r){const n=[],o=e.count();for(let a=0;a<o;a++){const o=e.get_value_at(a);n.push(It(o,t,r))}return n}(e,t,r);default:return Pt().warnOnce("Unknown graph object type detected!  Result interpreted as null"),null}}})(e,t,r)}function St(e,t,r){const n=e.type_name,o=Et(e,t,r),a=e.get_id();return new vt.A(Object.assign({typeName:n,id:a},o))}function Et(e,t,r){const n={},o=e.key_count();for(let a=0;a<o;a++)n[e.get_key_at(a)]=It(e.get_value_at(a),t,r);return{properties:n}}function Rt(e,t,r){const n=e.type_name,o=Et(e,t,r);return new Gt.A(Object.assign({typeName:n,id:e.get_id(),originId:e.get_origin_entity_id(),destinationId:e.get_destination_entity_id()},o))}function xt(e){const t=[];for(let r=0;r<e.get_header_keys().size();r++)t.push(e.get_header_keys().get(r));const r=new p.A(e.get_out_sr());return new q({headerKeys:t,outSpatialReference:r,exceededTransferLimit:e.exceeded_transfer_limit()})}let kt=class extends c.A{constructor(e){super(e),this.hasError=!1,this.error=null,this.editResults=[]}};(0,u._)([(0,y.MZ)()],kt.prototype,"hasError",void 0),(0,u._)([(0,y.MZ)()],kt.prototype,"error",void 0),(0,u._)([(0,y.MZ)()],kt.prototype,"editResults",void 0),kt=(0,u._)([(0,g.$)("esri.rest.knowledgeGraph.GraphApplyEditsResult")],kt);const Dt=kt;function jt(e){const t=e.has_error(),r=new Dt({hasError:t,error:t?re(e.error):null}),n=e.get_edit_results_count();for(let t=0;t<n;t++){const n=e.get_edit_results_at(t),o=e.get_edit_results_type_name_at(t),a=[],i=[],s=[],d=n.get_add_results_count(),l=n.get_update_results_count(),p=n.get_delete_results_count();for(let e=0;e<d;e++){const t=n.get_add_result_at(e);a.push({id:t.id,error:re(t.error)})}for(let e=0;e<l;e++){const t=n.get_update_result_at(e);i.push({id:t.id,error:re(t.error)})}for(let e=0;e<p;e++){const t=n.get_delete_result_at(e);s.push({id:t.id,error:re(t.error)})}r.editResults.push({typeName:o,adds:a,updates:i,deletes:s})}return r}const Ct=new Map,Nt=()=>new Map(Ct.entries()),Ot={fetchKnowledgeGraph:async e=>{const t=new ee({url:e}),r=[];return r.push(tr(t)),r.push(rr(t)),await Promise.all(r),t},refreshDataModel:async e=>{e.dataModel=await wr(e)},refreshServiceDefinition:async e=>{const t=(await(0,a.A)(e.url,{query:{f:"json"}})).data;return t.capabilities=t?.capabilities?.split(","),t.supportedQueryFormats=t?.supportedQueryFormats?.split(","),e.serviceDefinition=new X(t),e.serviceDefinition},executeFindPathsAsynchronous:async(e,t)=>{const r=e.inKnowledgeGraphUrl.split("/rest/services");if(r.length<2)throw new i.A("knowledge-graph:invalid-tool-url","The URL for the KG Service was not correctly formatted.  It should contain /rest/services/");const n=r[0],o=(await lr(`${n}/rest/services/System`,{query:{f:"pjson"}})).data.currentVersion,a=`/rest/services/${o&&o<12?"System":"Utilities"}/KnowledgeGraphServerToolsAsync/GPServer/ServerFilteredFindPaths`;return await dr(`${n}${a}`,{in_knowledge_graph_url:e.inKnowledgeGraphUrl,config_type:"STRING",config_string:e.config.toJSON(),result_type:"STRING"},{},t)},executeFindPaths:async(e,t)=>{const r=e.inKnowledgeGraphUrl.split("/rest/services");if(r.length<2)throw new i.A("knowledge-graph:invalid-tool-url","The URL for the KG Service was not correctly formatted.  It should contain /rest/services/");const n=r[0],o=(await lr(`${n}/rest/services/System`,{query:{f:"pjson"}})).data.currentVersion,a=`/rest/services/${o&&o<12?"System":"Utilities"}/KnowledgeGraphServerTools/GPServer/ServerFilteredFindPaths/execute`,s=await lr(`${n}${a}`,{method:"post",query:{f:"pjson",in_knowledge_graph_url:e.inKnowledgeGraphUrl,config_type:"STRING",config_string:JSON.stringify(e.config),result_type:"STRING"},...t});if(s.data.results.length<1)throw new i.A("knowledge-graph:no-results","No results were returned from the FindPaths tool - no results returned",s);let d;for(const e of s.data.results)if("out_results_string"===e.paramName){d=e.value;break}if(!d)throw new i.A("knowledge-graph:no-results","No results were returned from the FindPaths tool - no results were returned on the expected paramater out_results_string",s);return d},fetchAsynchronousFindPathsResultData:async(e,t)=>(await e.fetchResultData("out_results_string",null,t)).value,executeQueryStreaming:async(e,t,r)=>{const n=`${e.url}/graph/query`;await pr(e);const o=await cr(n,r);if(!e.serviceDefinition?.supportsProvenance&&"include"===t.provenanceBehavior)throw new i.A("knowledge-graph:provenance-not-supported","The Knowledge Graph Service definition indicated that provenance is not supported");o.data.body=await async function(e,t){const r=await(0,se.I)(),n=new r.GraphQueryRequestEncoder;if(n.deleteLater(),e.outputSpatialReference?n.output_spatial_reference={wkid:e.outputSpatialReference.wkid,latestWkid:e.outputSpatialReference.latestWkid,vcsWkid:e.outputSpatialReference.vcsWkid,latestVcsWkid:e.outputSpatialReference.latestVcsWkid,wkt:e.outputSpatialReference.wkt??""}:n.output_spatial_reference=r.SpatialReferenceUtil.WGS84(),n.open_cypher_query=e.openCypherQuery,e.bindParameters)for(const[t,o]of Object.entries(e.bindParameters))ur(t,o,n,r);if(e.bindGeometryQuantizationParameters)!function(e,t){t.input_quantization_parameters={xy_resolution:e.xyResolution,x_false_origin:e.xFalseOrigin,y_false_origin:e.yFalseOrigin,z_resolution:e.zResolution,z_false_origin:e.zFalseOrigin,m_resolution:e.mResolution,m_false_origin:e.mFalseOrigin}}(e.bindGeometryQuantizationParameters,n);else{if(t.dataModel||await tr(t),4326!==t.dataModel?.spatialReference?.wkid)throw new i.A("knowledge-graph:SR-quantization-mismatch","If the DataModel indicates a coordinate system other than WGS84, inputQuantizationParameters must be provided to the query encoder");n.input_quantization_parameters=r.InputQuantizationUtil.WGS84_lossless()}e.outputQuantizationParameters&&function(e,t,r){if(!e.extent)throw new i.A("knowledge-graph:illegal-output-quantization","The Output quantization provided to the encoder had an illegal value as part of its extent",e.extent);if(!e.quantizeMode)throw new i.A("knowledge-graph:illegal-output-quantization","The Output quantization contained an illegal mode setting",e.quantizeMode);if(!e.tolerance)throw new i.A("knowledge-graph:illegal-output-quantization","The Output quantization contained an illegal tolerance setting",e.quantizeMode);t.output_quantization_parameters={extent:{xmax:e.extent.xmax,ymax:e.extent.ymax,xmin:e.extent.xmin,ymin:e.extent.ymin},quantize_mode:r.esriQuantizeMode[e.quantizeMode],tolerance:e.tolerance}}(e.outputQuantizationParameters,n,r),e.provenanceBehavior&&function(e,t){t.provenance_behavior={value:ie[e]}}(e.provenanceBehavior,n);try{n.encode()}catch(e){throw new i.A("knowledge-graph:query-encoding-failed","Attempting to encode the query failed",{error:e})}const o=n.get_encoding_result();if(0!==o.error.error_code)throw new i.A("knowledge-graph:query-encoding-failed","Attempting to encode the query failed",{errorCode:o.error.error_code,errorMessage:o.error.error_message});return structuredClone(o.get_byte_buffer())}(t,e);const a=await sr(o.data.url,o.data);if(e.dataModel){const t=await _r(a,e.dataModel);return new J({resultRowsStream:t.readableStream,resultHeader:t.resultHeader})}throw new i.A("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model")},executeApplyEdits:async(e,t,r)=>{if(e.serviceDefinition?.dataEditingNotSupported)throw new i.A("knowledge-graph:data-editing-not-supported","The Knowledge Graph Service definition indicated that data editing is not supported");const n=`${e.url}/graph/applyEdits`;await pr(e);const o=await cr(n,r);return o.data.body=await async function(e,t){if(t.dataModel||await tr(t),!t.dataModel)throw new i.A("knowledge-graph:data-model-undefined","Encoding could not proceed because a data model was not provided and it could not be determined from the service");const r=await(0,se.I)(),n=!!e.options?.cascadeDelete,o=new r.GraphApplyEditsEncoder(r.SpatialReferenceUtil.WGS84(),e.options?.inputQuantizationParameters?function(e){return{xy_resolution:e.xyResolution,x_false_origin:e.xFalseOrigin,y_false_origin:e.yFalseOrigin,z_resolution:e.zResolution,z_false_origin:e.zFalseOrigin,m_resolution:e.mResolution,m_false_origin:e.mFalseOrigin}}(e.options?.inputQuantizationParameters):r.InputQuantizationUtil.WGS84_lossless());o.deleteLater(),o.cascade_delete=n;try{let t;e.entityAdds?.forEach((e=>{t=o.add_entity(be(e,r)),te(t,"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - an entity failed to be added to the encoder")})),e.relationshipAdds?.forEach((e=>{if(!e.originId||!e.destinationId)throw new i.A("knowledge-graph:relationship-origin-destination-missing","When adding a new relationship, you must provide both an origin and destination id on the appropriate class property");t=o.add_relationship(be(e,r)),te(t,"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - a relationship failed to be added to the encoder")})),e.entityUpdates?.forEach((e=>{if(!e.id)throw new i.A("knowledge-graph:entity-id-missing","When updating an entity or relationship, you must specify the id on the class level property");t=o.update_entity(be(e,r)),te(t,"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - an entity failed to be added to the encoder")})),e.relationshipUpdates?.forEach((e=>{if(!e.id)throw new i.A("knowledge-graph:relationship-id-missing","When updating an entity or relationship, you must specify the id on the class level property");t=o.update_relationship(be(e,r)),te(t,"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - a relationship failed to be added to the encoder")})),e.entityDeletes?.forEach((e=>{if(!e.typeName)throw new i.A("knowledge-graph:no-type-name","You must indicate the entity/relationship named object type to apply edits - delete");const t=o.make_delete_helper(e.typeName,!0);t.deleteLater(),e.ids?.forEach((e=>{t.delete_by_id(e)}))})),e.relationshipDeletes?.forEach((e=>{if(!e.typeName)throw new i.A("knowledge-graph:no-type-name","You must indicate the entity/relationship named object type to apply edits - delete");const t=o.make_delete_helper(e.typeName,!1);e.ids?.forEach((e=>{t.delete_by_id(e)}))})),o.encode()}catch(e){throw new i.A("knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits failed",{error:e})}const a=o.get_encoding_result();return te(a.error,"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits failed"),structuredClone(a.get_byte_buffer())}(t,e),async function(e){return yr(e,(await(0,se.I)()).GraphApplyEditsDecoder,jt)}(await sr(o.data.url,o.data))},executeAddNamedTypes:async(e,t,r)=>{if(!t.newEntityTypes?.length&&!t.newRelationshipTypes?.length)throw new i.A("knowledge-graph:no-arguments","The operation to add types to the data model contained no values");const n=`${e.url}/dataModel/edit/namedTypes/add`;await pr(e);const o=await cr(n,r);o.data.body=await async function(e){const t=await(0,se.I)(),r=new t.GraphNamedObjectTypeAddsRequestEncoder;r.deleteLater(),e.newEntityTypes?.forEach((e=>{r.add_entity_type(function(e,t){const r=new t.EntityType;return r.deleteLater(),Ae(e,t,r)}(e,t))})),e.newRelationshipTypes?.forEach((e=>{r.add_relationship_type(function(e,t){const r=new t.RelationshipType;r.deleteLater();for(const n of e.endPoints){const e=new t.EndPoint;e.deleteLater(),e.origin_entity_type=n.originEntityType,e.dest_entity_type=n.destinationEntityType,r.add_end_point(e)}return Ae(e,t,r)}(e,t))}));try{r.encode()}catch(e){throw new i.A("knowledge-graph:addNamedTypes-encoding-failed","Attempting to encode the addNamedTypes failed",{error:e})}const n=r.get_encoding_result();return te(n.error,"knowledge-graph:addNamedTypes-encoding-failed","Attempting to encode the addNamedTypes failed"),structuredClone(n.get_byte_buffer())}(t);const a=await sr(o.data.url,o.data),s=await async function(e){return yr(e,(await(0,se.I)()).GraphNamedObjectTypeAddsResponseDecoder,Be)}(a);return s.updatedKnowledgeGraph=await er(e.url),s},executeDeleteNamedType:async(e,t,r)=>{if(!t)throw new i.A("knowledge-graph:no-arguments","The operation to delete a named type from the data model contained no value");const n=`${e.url}/dataModel/edit/namedTypes/${t}/delete`;await pr(e);const o=await cr(n,r);o.data.body="";const a=await sr(o.data.url,o.data),s=await async function(e){return yr(e,(await(0,se.I)()).GraphNamedObjectTypeDeleteResponseDecoder,He)}(a);return s.updatedKnowledgeGraph=await er(e.url),s},executeUpdateNamedType:async(e,t,r,n)=>{if(!t&&!Object.keys(r).length)throw new i.A("knowledge-graph:no-arguments","The operation to update types in the data model contained missing or empty values");const o=`${e.url}/dataModel/edit/namedTypes/${t}/update`;await pr(e);const a=await cr(o,n);a.data.body=await async function(e,t,r){const n=await(0,se.I)(),o=new n.GraphNamedObjectTypeUpdateRequestEncoder;if(o.deleteLater(),r.entityTypes.some((e=>e.name===t)))o.update_entity_type(function(e,t){const r=new t.EntityType;return r.deleteLater(),Me(e,r)}(e,n));else{if(!r.relationshipTypes.some((e=>e.name===t)))throw new i.A("knowledge-graph:updateNamedType-encoding-failed","The named type you are trying to update does not exist in the data model");o.update_relationship_type(function(e,t){const r=new t.RelationshipType;return r.deleteLater(),Me(e,r)}(e,n))}o.update_alias=e.hasOwnProperty("alias");try{o.encode()}catch(e){throw new i.A("knowledge-graph:updateNamedType-encoding-failed","Attempting to encode the updateNamedType failed",{error:e})}const a=o.get_encoding_result();return te(a.error,"knowledge-graph:updateNamedType-encoding-failed","Attempting to encode the updateNamedType failed"),structuredClone(a.get_byte_buffer())}(r,t,e.dataModel);const s=await sr(a.data.url,a.data),d=await async function(e){return yr(e,(await(0,se.I)()).GraphNamedObjectTypeUpdateResponseDecoder,Qe)}(s);return d.updatedKnowledgeGraph=await er(e.url),d},executeAddGraphProperties:async(e,t,r,n)=>{if(!t&&!r.length)throw new i.A("knowledge-graph:no-arguments","The operation to add properties to the data model contained missing or empty values");const o=`${e.url}/dataModel/edit/namedTypes/${t}/fields/add`;await pr(e);const a=await cr(o,n);a.data.body=await async function(e){const t=await(0,se.I)(),r=new t.GraphPropertyAddsRequestEncoder;r.deleteLater(),e.forEach((e=>{r.add_graph_property(Te(e,t))}));try{r.encode()}catch(e){throw new i.A("knowledge-graph:addGraphProperties-encoding-failed","Attempting to encode the addGraphProperties failed",{error:e})}const n=r.get_encoding_result();return te(n.error,"knowledge-graph:addGraphProperties-encoding-failed","Attempting to encode the addGraphProperties failed"),structuredClone(n.get_byte_buffer())}(r);const s=await sr(a.data.url,a.data),d=await async function(e){return yr(e,(await(0,se.I)()).GraphPropertyAddsResponseDecoder,We)}(s);return d.updatedKnowledgeGraph=await er(e.url),d},executeDeleteGraphProperty:async(e,t,r,n)=>{if(!t&&!r)throw new i.A("knowledge-graph:no-arguments","The operation to delete property contained missing or empty values");const o=`${e.url}/dataModel/edit/namedTypes/${t}/fields/delete`;await pr(e);const a=await cr(o,n);a.data.body=await async function(e){const t=new((await(0,se.I)()).GraphPropertyDeleteRequestEncoder);t.deleteLater(),t.field_name=e;try{t.encode()}catch(e){throw new i.A("knowledge-graph:deleteGraphProperty-encoding-failed","Attempting to encode the deleteGraphProperty failed",{error:e})}const r=t.get_encoding_result();return te(r.error,"knowledge-graph:deleteGraphProperty-encoding-failed","Attempting to encode the deleteGraphProperty failed"),structuredClone(r.get_byte_buffer())}(r);const s=await sr(a.data.url,a.data),d=await async function(e){return yr(e,(await(0,se.I)()).GraphPropertyDeleteResponseDecoder,Xe)}(s);return d.updatedKnowledgeGraph=await er(e.url),d},executeUpdateGraphProperty:async(e,t,r,n,o)=>{if(!t&&!r&&!Object.keys(n).length)throw new i.A("knowledge-graph:no-arguments","The operation to update properties in the data model contained missing or empty values");const a=`${e.url}/dataModel/edit/namedTypes/${t}/fields/update`;await pr(e);const s=await cr(a,o);s.data.body=await async function(e,t){const r=await(0,se.I)(),n=new r.GraphPropertyUpdateRequestEncoder;n.deleteLater(),n.update_graph_property(function(e,t){const r=new t.GraphProperty;return r.deleteLater(),e.hasOwnProperty("alias")&&(r.alias=e.alias),e.hasOwnProperty("editable")&&(r.editable=e.editable),e.hasOwnProperty("required")&&(r.required=e.required),e.hasOwnProperty("defaultVisibility")&&(r.default_visibility=e.defaultVisibility),e.hasOwnProperty("defaultValue")&&(r.default_value=Pe(e.defaultValue,t)),r}(t,r)),n.set_property_name(e),n.update_alias=t.hasOwnProperty("alias"),n.update_editable=t.hasOwnProperty("editable"),n.update_required=t.hasOwnProperty("required"),n.update_visible=t.hasOwnProperty("defaultVisibility"),n.update_default_value=t.hasOwnProperty("defaultValue");try{n.encode()}catch(e){throw new i.A("knowledge-graph:updateGraphProperty-encoding-failed","Attempting to encode the updateGraphProperty failed",{error:e})}const o=n.get_encoding_result();return te(o.error,"knowledge-graph:updateGraphProperty-encoding-failed","Attempting to encode the updateGraphProperty failed"),structuredClone(o.get_byte_buffer())}(r,n);const d=await sr(s.data.url,s.data),l=await async function(e){return yr(e,(await(0,se.I)()).GraphPropertyUpdateResponseDecoder,et)}(d);return l.updatedKnowledgeGraph=await er(e.url),l},executeAddGraphFieldIndex:async(e,t,r,n)=>{if(!t)throw new i.A("knowledge-graph:no-arguments","The operation to update search index in the data model contained missing named type");if(!r?.length)throw new i.A("knowledge-graph:no-arguments","The operation to update search index in the data model contained missing or empty field index values");const o=`${e.url}/dataModel/edit/namedTypes/${t}/indexes/add`;await pr(e);const a=await cr(o,n);a.data.body=await async function(e){const t=await(0,se.I)(),r=new t.GraphIndexAddsRequestEncoder;r.deleteLater(),e.forEach((e=>{r.add_field_index(function(e,t){const r=new t.FieldIndex;r.deleteLater(),r.name=e.name,r.unique=e.unique,r.ascending=e.ascending,r.description=e.description??"";for(const t of e.fieldNames)r.add_field(t);return r}(e,t))}));try{r.encode()}catch(e){throw new i.A("knowledge-graph:addGraphFieldIndex-encoding-failed","Attempting to encode the addGraphFieldIndex failed",{error:e})}const n=r.get_encoding_result();return te(n.error,"knowledge-graph:addGraphFieldIndex-encoding-failed","Attempting to encode the addGraphFieldIndex failed"),structuredClone(n.get_byte_buffer())}(r);const s=await sr(a.data.url,a.data),d=await async function(e){return yr(e,(await(0,se.I)()).GraphIndexAddsResponseDecoder,rt)}(s);return d.updatedKnowledgeGraph=await er(e.url),d},executeDeleteGraphFieldIndex:async(e,t,r,n)=>{if(!t)throw new i.A("knowledge-graph:no-arguments","The operation to update search index in the data model contained missing named type");if(!r?.length)throw new i.A("knowledge-graph:no-arguments","The operation to update search index in the data model contained missing or empty field index values");const o=`${e.url}/dataModel/edit/namedTypes/${t}/indexes/delete`;await pr(e);const a=await cr(o,n);a.data.body=await async function(e){const t=new((await(0,se.I)()).GraphIndexDeleteRequestEncoder);t.deleteLater(),e.forEach((e=>{t.add_index_name(e)}));try{t.encode()}catch(e){throw new i.A("knowledge-graph:deleteGraphFieldIndex-encoding-failed","Attempting to encode the deleteGraphFieldIndex failed",{error:e})}const r=t.get_encoding_result();return te(r.error,"knowledge-graph:deleteGraphFieldIndex-encoding-failed","Attempting to encode the deleteGraphFieldIndex failed"),structuredClone(r.get_byte_buffer())}(r);const s=await sr(a.data.url,a.data),d=await async function(e){return yr(e,(await(0,se.I)()).GraphIndexDeleteResponseDecoder,nt)}(s);return d.updatedKnowledgeGraph=await er(e.url),d},executeUpdateSearchIndex:async(e,t,r,n)=>{if(!t)throw new i.A("knowledge-graph:no-arguments","The operation to update search index in the data model contained missing named type");if(!Object.keys(r.addSearchProperties??{}).length&&!Object.keys(r.removeSearchProperties??{}).length)throw new i.A("knowledge-graph:no-arguments","The operation to update search index in the data model contained missing or empty properties values");const o=`${e.url}/dataModel/searchIndex/update`;await pr(e);const a=await cr(o,n);a.data.body=await async function(e,t){const r=await(0,se.I)(),n=new r.GraphUpdateSearchIndexRequestEncoder;n.deleteLater(),t.hasOwnProperty("addSearchProperties")&&n.insert_add_search_property(e,Ge(t.addSearchProperties,r)),t.hasOwnProperty("removeSearchProperties")&&n.insert_delete_search_property(e,Ge(t.removeSearchProperties,r));try{n.encode()}catch(e){throw new i.A("knowledge-graph:updateSearchIndex-encoding-failed","Attempting to encode the updateSearchIndex failed",{error:e})}const o=n.get_encoding_result();return te(o.error,"knowledge-graph:updateSearchIndex-encoding-failed","Attempting to encode the updateSearchIndex failed"),structuredClone(o.get_byte_buffer())}(t,r);const s=await sr(a.data.url,a.data),d=await async function(e){return yr(e,(await(0,se.I)()).GraphUpdateSearchIndexResponseDecoder,tt)}(s);return d.updatedKnowledgeGraph=await er(e.url),d},executeQuery:async(e,t,r)=>{const n=`${e.url}/graph/query`,o=await(0,a.A)(n,{responseType:"array-buffer",query:{f:"pbf",openCypherQuery:t.openCypherQuery,...r?.query},signal:r?.signal,timeout:r?.timeout}),s=o.getHeader?.("content-type"),d=o.data;if(s?.includes("application/x-protobuf")){const t=new((await(0,se.I)()).GraphQueryDecoder);if(t.deleteLater(),e.dataModel){const r=fr({wasmQueryDecoder:t,newArrayBufferToParse:d,dataModel:e.dataModel});return new z({resultRows:r.resultRows,resultHeader:r.resultHeader})}throw new i.A("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model")}throw new i.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:s,data:o.data})},executeSearch:async(e,t,r)=>{const n=t.typeCategoryFilter,o=`${e.url}/graph/search`,s=await(0,a.A)(o,{responseType:"array-buffer",query:{f:"pbf",searchQuery:`"${t.searchQuery}"`,typeCategoryFilter:n,...r?.query},signal:r?.signal,timeout:r?.timeout}),d=s.getHeader?.("content-type"),l=s.data;if(d?.includes("application/x-protobuf")){const t=new((await(0,se.I)()).GraphQueryDecoder);if(t.deleteLater(),e.dataModel){const r=fr({wasmQueryDecoder:t,newArrayBufferToParse:l,dataModel:e.dataModel});return new z({resultRows:r.resultRows,resultHeader:r.resultHeader})}throw new i.A("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model")}throw new i.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:d,data:s.data})},executeSearchStreaming:async(e,t,r)=>{const n=`${e.url}/graph/search`;await pr(e);const o=await cr(n,r);o.data.body=await async function(e){const t=await(0,se.I)(),r=new t.GraphSearchRequestEncoder;if(r.deleteLater(),r.search_query=e.searchQuery,r.type_category_filter=t.esriNamedTypeCategory[e.typeCategoryFilter],!0===e.returnSearchContext&&(r.return_search_context=e.returnSearchContext),null!=e.start&&e.start>0&&(r.start_index=e.start),null!=e.num&&(r.max_num_results=e.num),null!=e.idsFilter&&Array.isArray(e.idsFilter)&&e.idsFilter.length>0)try{r.set_ids_filter(ce(e.idsFilter,t))}catch(e){throw new i.A("knowledge-graph:ids-format-error","Attempting to set ids filter failed.  This is usually caused by an incorrectly formatted UUID string",{error:e})}e.namedTypesFilter?.forEach((e=>{r.add_named_type_filter(e)}));try{r.encode()}catch(e){throw new i.A("knowledge-graph:search-encoding-failed","Attempting to encode the search failed",{error:e})}const n=r.get_encoding_result();if(0!==n.error.error_code)throw new i.A("knowledge-graph:search-encoding-failed","Attempting to get encoding result from the query failed",{errorCode:n.error.error_code,errorMessage:n.error.error_message});return structuredClone(n.get_byte_buffer())}(t);const a=await sr(o.data.url,o.data);if(e.dataModel){const t=await _r(a,e.dataModel);return new J({resultRowsStream:t.readableStream,resultHeader:t.resultHeader})}throw new i.A("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model")},fetchClientDataAtKeys:async(e,t,r={ignoreCache:!1})=>{if(!t.length)return new Map;let n=Ct.get(e.url||"");n||(n=new Map,Ct.set(e.url||"",n));const o=new Map(n.entries()),a=`${e.url}/clientData/fetch`;t=Array.from(new Set(t));const s=await(0,se.I)(),d=function(e,t,r,n=!1){const o=new r.ClientDataFetchRequestEncoder;o.deleteLater();for(const a of e){const e=ne(a,t,r,n);o.add_client_data_fetch_request_parameter(e)}o.encode();const a=o.get_encoding_result();return te(a.error,"knowledge-graph:fetchClientDataAtKeys-encoding-failed","Attempting to encode the fetchClientDataAtKeys failed"),structuredClone(a.get_byte_buffer())}(t,n,s,r.ignoreCache),l=await cr(a,r.requestOptions);l.data.body=d;const p=await sr(l.data.url,l.data),u=p.headers.get("content-type");if(u?.includes("application/x-protobuf")){const e=new s.ClientDataFetchResponseDecoder;e.deleteLater();const t=await p.arrayBuffer();return e.decode(new Uint8Array(t)),e.has_error()&&te(e.error,"knowledge-graph:fetchClientDataAtKeys-decoding-error","An error occurred while decoding the client data keys response"),function(e,t,r,n=!1){const o=new Map;for(let a=0;a<e.get_results_count();a++){const i=e.get_result_at(a);if(i.get_fetch_result_case().value!==me.ClientDataValue||0!==i.error().error_code){const e=i.get_key().key_string;r.has(e)&&t.delete(e);continue}const s=i.get_value(),d=i.get_key().key_string,l=r.get(d);let p;if(s.get_data_case().value===we.NotModified&&l)p=l.value;else{if(s.get_data_case().value!==we.ClientData)continue;{p=s.get_data().client_data_string;const e=i.get_value().get_v_tag().v_tag;n||t.set(d,{key:d,version:e,value:p})}}o.set(d,p)}return o}(e,n,o,r.ignoreCache)}throw new i.A("knowledge-graph:unexpected-server-response","server returned an unexpected response when fetching client data",{responseType:u,data:p})},fetchAllClientDataKeys:async(e,t)=>{const r=`${e.url}/clientData`,n=await(0,a.A)(r,{responseType:"array-buffer",query:{f:"pbf"},signal:t?.signal,timeout:t?.timeout}),o=n.getHeader?.("content-type"),s=n.data;if(o?.includes("application/x-protobuf")){const e=new((await(0,se.I)()).ClientDataKeysResponseDecoder);return e.deleteLater(),e.decode(new Uint8Array(s)),e.has_error()&&te(e.error,"knowledge-graph:fetchAllClientDataKeys-decoding-error","An error occurred while decoding the client data keys response"),Ie(e)}throw new i.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:o,data:n.data})},clearClientDataCache:()=>Ct.clear(),_fetchWrapper:async(e,t)=>fetch(e,t),_submitJobWrapper:async(e,t,r,n)=>async function(e,t,r,n){return r=_.from(r||{}),async function(e,t,r,n,o){const i={},s={},d=[];return function(e,t,r){for(const n in e){const o=e[n];if(o&&"object"==typeof o&&o instanceof I.A){const{features:e}=o;r[n]=[t.length,t.length+e.length],e.forEach((e=>{t.push(e.geometry)}))}}}(n,d,i),(0,w.el)(d).then((d=>{const{outSpatialReference:l,processExtent:p,processSpatialReference:u,returnColumnName:c,returnFeatureCollection:y,returnM:h,returnZ:g}=r,{path:f}=(0,T.Dl)(e);for(const e in i){const[t,r]=i[e];s[e]=d.slice(t,r)}const _=l?l.wkid||l:null,w=u?u.wkid||u:null,m="execute"===t?{returnColumnName:c||void 0,returnFeatureCollection:y||void 0,returnM:h||void 0,returnZ:g||void 0}:null,v=O({...p?{context:{extent:p,outSR:_,processSR:w}}:{"env:outSR":_,"env:processSR":w},...n,...m,f:"json"},null,s),b={...o,query:v};return(0,a.A)(`${f}/${t}`,b)}))}(e,"submitJob",r,t??{},n).then((({data:t})=>{const r=$.fromJSON(t);return r.sourceUrl=e,r}))}(e,t,r,n),_esriRequestWrapper:async(e,t)=>(0,a.A)(e,t)};async function Ft(e,t,r){return Ot.executeApplyEdits(e,t,r)}async function Zt(e,t,r){return Ot.executeAddNamedTypes(e,t,r)}async function Ut(e,t,r){return Ot.executeDeleteNamedType(e,t,r)}async function Lt(e,t,r,n){return Ot.executeUpdateNamedType(e,t,r,n)}async function $t(e,t,r,n){return Ot.executeAddGraphProperties(e,t,r,n)}async function qt(e,t,r,n){return Ot.executeDeleteGraphProperty(e,t,r,n)}async function zt(e,t,r,n,o){return Ot.executeUpdateGraphProperty(e,t,r,n,o)}async function Jt(e,t,r,n){return Ot.executeAddGraphFieldIndex(e,t,r,n)}async function Vt(e,t,r,n){return Ot.executeDeleteGraphFieldIndex(e,t,r,n)}async function Kt(e,t,r,n){return Ot.executeUpdateSearchIndex(e,t,r,n)}async function Yt(e,t,r){return Ot.executeQuery(e,t,r)}async function Bt(e,t,r){return Ot.executeQueryStreaming(e,t,r)}async function Qt(e,t,r){return Ot.executeSearch(e,t,r)}async function Ht(e,t,r){return Ot.executeSearchStreaming(e,t,r)}function Wt(e,t){return Ot.fetchAllClientDataKeys(e,t)}function Xt(e,t,r){return Ot.fetchClientDataAtKeys(e,t,r)}async function er(e){return Ot.fetchKnowledgeGraph(e)}async function tr(e){return Ot.refreshDataModel(e)}async function rr(e){return Ot.refreshServiceDefinition(e)}async function nr(e,t){return Ot.executeFindPathsAsynchronous(e,t)}async function or(e,t){return Ot.executeFindPaths(e,t)}async function ar(e,t){return Ot.fetchAsynchronousFindPathsResultData(e,t)}function ir(){return Ot.clearClientDataCache()}async function sr(e,t){return Ot._fetchWrapper(e,t)}async function dr(e,t,r,n){return Ot._submitJobWrapper(e,t,r,n)}async function lr(e,t){return Ot._esriRequestWrapper(e,t)}async function pr(e){const t=o.id?.findCredential(e.url);t||(e.dataModel?await wr(e):await tr(e))}function ur(e,t,r,n){null==t?r.set_param_key_value(e,""):"object"!=typeof t||t instanceof Date?r.set_param_key_value(e,t):t instanceof l.A?r.set_param_key_value(e,he(t,n)):Array.isArray(t)?r.set_param_key_value(e,ce(t,n)):r.set_param_key_value(e,ye(t,n))}async function cr(e,t){return(0,a.A)(e,{responseType:"native-request-init",method:"post",query:{f:"pbf",...t?.query},body:"x",headers:{"Content-Type":"application/octet-stream"},signal:t?.signal,timeout:t?.timeout})}async function yr(e,t,r){const n=e.headers.get("content-type");if(n?.includes("application/x-protobuf")){const n=await e.arrayBuffer(),o=new t;try{return o.decode(new Uint8Array(n)),r(o)}finally{o.deleteLater()}}throw new i.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:n,data:await e.text()})}let hr=50;function gr(e){hr=e}function fr({wasmQueryDecoder:e,newArrayBufferToParse:t,dataModel:r,decodedHeader:n,limitMaxProcessingTime:o=!1}){t&&e.push_buffer(new Uint8Array(t));const a=[];let s,d,l=0;const u=Date.now();let c=!0;for(;e.next_row();){s&&d||(s=n??xt(e),d=s.outSpatialReference??new p.A({wkid:4326})),l||(l=e.get_header_keys().size());const t=new Array(l);for(let n=0;n<l;n++){const o=e.get_value(n);t[n]=It(o,r,d)}if(a.push(t),o&&Date.now()-u>hr){c=!1;break}}if(e.has_error())throw new i.A("knowledge-graph:stream-decoding-error","One or more result rows were not successfully decoded - inner row decoding",{errorCode:e.error.error_code,errorMessage:e.error.error_message});return{resultHeader:s,resultRows:a,parsedAllResultsFromBuffer:c}}async function _r(e,t){const r=e.headers.get("content-type");if(e.headers.get("content-length")&&s.A.getLogger("esri.rest.knowledgeGraph.knowledgeGraphService").warnOnce("Found `Content-Length` header when expecting a streaming HTTP response! Please investigate whether all intermediate HTTP proxies and/or load balancers are configured such that they don't forcefully buffer the entire response before returning it to the client. A valid HTTP streaming response should use Chunked Transfer Encoding and not have a Content Length defined."),r?.includes("application/x-protobuf")){const r=e.body?.getReader(),n=new((await(0,se.I)()).GraphQueryDecoder);let o,a,l;n.deleteLater();const p=new Promise(((e,t)=>{a=e,l=t}));let u=!1,c=null;const y=new ReadableStream({pull:async function e(p){if(!r){const e=new i.A("knowledge-graph:stream-decoding-error","Error reading from stream - reader is undefined");throw l(e),e}const{done:y,value:h}=c?{done:!1,value:null}:await r.read().catch((e=>{throw l(e),r.releaseLock(),e}));h&&(c=h);try{if(y){let e;if(n.has_error()?e=new i.A("knowledge-graph:stream-decoding-error","One or more result rows were not successfully decoded - query stream done",{errorCode:n.error.error_code,errorMessage:n.error.error_message}):u||a(new q),r.releaseLock(),e)throw p.error(e),l(e),e;return void p.close()}const{resultHeader:s,resultRows:d,parsedAllResultsFromBuffer:g}=fr({wasmQueryDecoder:n,newArrayBufferToParse:h,dataModel:t,decodedHeader:o,limitMaxProcessingTime:!0});return g&&(c=null),!o&&s&&(o=s,a(s),u=!0),d.length>0?void p.enqueue(d):await e(p)}catch(e){throw s.A.getLogger("esri.rest.knowledgeGraph.knowledgeGraphService").error(e),l(e),r.releaseLock(),(0,d.zf)(e)?e:new i.A("knowledge-graph:unexpected-server-response","Error inside streaming data return parsing",{error:e})}}});return{readableStream:y,resultHeader:await p}}throw new i.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:r,data:e.text()})}async function wr(e){const t=`${e.url}/dataModel/queryDataModel`,r=await(0,a.A)(t,{responseType:"array-buffer",query:{f:"pbf"}}),n=r.getHeader?.("content-type"),o=r.data;if(n?.includes("application/x-protobuf")){const e=(await(0,se.I)()).decode_data_model_from_protocol_buffer(new Uint8Array(o));if(!e)throw new i.A("knowledge-graph:data-model-decode-failure","The server responded to the data model query, but the response failed to be decoded.  This typically occurs when the Knowledge JS API (4.26 or later) is used with an unsupported backend (11.0 or earlier)");return function(e){e.deleteLater(),at=!1;const t=new W({timestamp:e.timestamp,spatialReference:new p.A(e.spatial_reference),strict:e.strict,objectIdField:e.objectid_property,globalIdField:e.globalid_property,arcgisManaged:e.arcgis_managed,identifierInfo:{identifierMappingInfo:{identifierInfoType:ve.vy[e.identifier_info?.identifier_mapping_info?.identifier_info_type?.value],databaseNativeIdentifier:e.identifier_info?.identifier_mapping_info?.database_native_identifier,uniformPropertyIdentifier:{identifierPropertyName:e.identifier_info?.identifier_mapping_info?.uniform_property_identifier?.identifier_property_name}},identifierGenerationInfo:{uuidMethodHint:ve.wr[e.identifier_info?.identifier_generation_info?.uuid_method_hint?.value]}},searchIndexes:wt(e.search_indexes),entityTypes:ct(e.entity_types),relationshipTypes:ft(e.relationship_types),metaEntityTypes:ct(e.meta_entity_types),provenanceSourceTypeValues:_t(e.provenance_source_type_values.value_behavior_array)});return at&&s.A.getLogger("esri.rest.knowledgeGraph.knowledgeGraphService").warnOnce("A big integer field was detected in the retrieved data model.  The `big-integer` field type is not fully supported in web clients.  Please see https://developers.arcgis.com/javascript/latest/api-reference/esri-layers-support-Field.html#type"),t}(e)}throw new i.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:n,data:r.data})}},35448:(e,t,r)=>{var n,o,a,i,s,d,l;r.d(t,{Eq:()=>n,bV:()=>a,nP:()=>s,r5:()=>o,ti:()=>d,vy:()=>l,wr:()=>i}),function(e){e[e.Regular=0]="Regular",e[e.Provenance=1]="Provenance",e[e.Document=2]="Document"}(n||(n={})),function(e){e[e.esriFieldTypeSmallInteger=0]="esriFieldTypeSmallInteger",e[e.esriFieldTypeInteger=1]="esriFieldTypeInteger",e[e.esriFieldTypeSingle=2]="esriFieldTypeSingle",e[e.esriFieldTypeDouble=3]="esriFieldTypeDouble",e[e.esriFieldTypeString=4]="esriFieldTypeString",e[e.esriFieldTypeDate=5]="esriFieldTypeDate",e[e.esriFieldTypeOID=6]="esriFieldTypeOID",e[e.esriFieldTypeGeometry=7]="esriFieldTypeGeometry",e[e.esriFieldTypeBlob=8]="esriFieldTypeBlob",e[e.esriFieldTypeRaster=9]="esriFieldTypeRaster",e[e.esriFieldTypeGUID=10]="esriFieldTypeGUID",e[e.esriFieldTypeGlobalID=11]="esriFieldTypeGlobalID",e[e.esriFieldTypeXML=12]="esriFieldTypeXML",e[e.esriFieldTypeBigInteger=13]="esriFieldTypeBigInteger",e[e.esriFieldTypeDateOnly=14]="esriFieldTypeDateOnly",e[e.esriFieldTypeTimeOnly=15]="esriFieldTypeTimeOnly",e[e.esriFieldTypeTimestampOffset=16]="esriFieldTypeTimestampOffset"}(o||(o={})),function(e){e[e.esriGeometryNull=0]="esriGeometryNull",e[e.esriGeometryPoint=1]="esriGeometryPoint",e[e.esriGeometryMultipoint=2]="esriGeometryMultipoint",e[e.esriGeometryPolyline=3]="esriGeometryPolyline",e[e.esriGeometryPolygon=4]="esriGeometryPolygon",e[e.esriGeometryEnvelope=5]="esriGeometryEnvelope",e[e.esriGeometryAny=7]="esriGeometryAny",e[e.esriGeometryMultiPatch=9]="esriGeometryMultiPatch"}(a||(a={})),function(e){e[e.esriMethodHintUNSPECIFIED=0]="esriMethodHintUNSPECIFIED",e[e.esriUUIDESRI=1]="esriUUIDESRI",e[e.esriUUIDRFC4122=2]="esriUUIDRFC4122"}(i||(i={})),function(e){e[e.esriTypeUNSPECIFIED=0]="esriTypeUNSPECIFIED",e[e.esriTypeEntity=1]="esriTypeEntity",e[e.esriTypeRelationship=2]="esriTypeRelationship",e[e.esriTypeBoth=4]="esriTypeBoth",e[e.esriTypeMetaEntityProvenance=8]="esriTypeMetaEntityProvenance"}(s||(s={})),function(e){e[e.esriGraphPropertyUNSPECIFIED=0]="esriGraphPropertyUNSPECIFIED",e[e.esriGraphPropertyRegular=1]="esriGraphPropertyRegular",e[e.esriGraphPropertyDocumentName=2]="esriGraphPropertyDocumentName",e[e.esriGraphPropertyDocumentTitle=3]="esriGraphPropertyDocumentTitle",e[e.esriGraphPropertyDocumentUrl=4]="esriGraphPropertyDocumentUrl",e[e.esriGraphPropertyDocumentText=5]="esriGraphPropertyDocumentText",e[e.esriGraphPropertyDocumentKeywords=6]="esriGraphPropertyDocumentKeywords",e[e.esriGraphPropertyDocumentContentType=7]="esriGraphPropertyDocumentContentType",e[e.esriGraphPropertyDocumentMetadata=8]="esriGraphPropertyDocumentMetadata",e[e.esriGraphPropertyDocumentFileExtension=9]="esriGraphPropertyDocumentFileExtension",e[e.esriGraphPropertyProvenanceInstanceId=10]="esriGraphPropertyProvenanceInstanceId",e[e.esriGraphPropertyProvenanceSourceType=11]="esriGraphPropertyProvenanceSourceType",e[e.esriGraphPropertyProvenanceSourceName=12]="esriGraphPropertyProvenanceSourceName",e[e.esriGraphPropertyProvenanceSource=13]="esriGraphPropertyProvenanceSource",e[e.esriGraphPropertyProvenanceComment=14]="esriGraphPropertyProvenanceComment",e[e.esriGraphPropertyProvenanceTypeName=15]="esriGraphPropertyProvenanceTypeName",e[e.esriGraphPropertyProvenancePropertyName=16]="esriGraphPropertyProvenancePropertyName"}(d||(d={})),function(e){e[e.esriIdentifierInfoTypeUNSPECIFIED=0]="esriIdentifierInfoTypeUNSPECIFIED",e[e.esriIdentifierInfoTypeDatabaseNative=1]="esriIdentifierInfoTypeDatabaseNative",e[e.esriIdentifierInfoTypeUniformProperty=2]="esriIdentifierInfoTypeUniformProperty"}(l||(l={}))},45724:(e,t,r)=>{r.d(t,{I:()=>d});var n=r(2741),o=r(44208);const a="esri/rest/knowledgeGraph/wasmInterface/";let i,s=null;async function d(){const e=s??i;if(e)return e;const t=!!(0,o.A)("wasm-simd");return i=l(t),i}async function l(e){if(e){const{default:e}=await r.e(5367).then(r.bind(r,15367)).then((e=>e.a));return e({locateFile:e=>(0,n.s)(a+e)})}const{default:t}=await r.e(9013).then(r.bind(r,29013)).then((e=>e.a));return t({locateFile:e=>(0,n.s)(a+e)})}}}]);