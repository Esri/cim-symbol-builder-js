"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[830],{30830:(e,t,n)=>{n.r(t),n.d(t,{fromGeometries:()=>me,fromGeometry:()=>le,fromGeometryToGXGeometry:()=>ce,getSpatialReference:()=>oe,toGeometry:()=>de});var r=n(55537),i=n(11878),a=n(26986),s=n(35368),o=n(83047),u=n(21325);function m(){if(-1===this.m_i)return this.m_i=0,{value:{m_token:1,m_value:null},done:!1};if(this.m_i<this.m_keys.length){const e=this.m_bReturnKey,t=Math.trunc(this.m_i);return this.m_bReturnKey=!this.m_bReturnKey,this.m_i+=.5,e?{value:{m_token:5,m_value:this.m_keys[t]},done:!1}:{value:{m_token:6,m_value:this.m_o[this.m_keys[t]]},done:!1}}return{value:{m_token:3,m_value:null},done:!0}}function l(){if(-1===this.m_i)return this.m_i=0,{value:{m_token:2,m_value:null},done:!1};if(this.m_i<this.m_a.length){const e={value:{m_token:6,m_value:this.m_a[this.m_i++]},done:!1};return this.m_strict||void 0===e.value.m_value&&(e.value.m_value=Number.NaN),e}return{value:{m_token:4,m_value:null},done:!0}}(0,a.i)((e=>{let t,n;"number"==typeof e?t=e:n=e;const r={wkid:t,wkt:n};let i,a;if(n){i=(0,o.x1)(n);const e=(0,u.EA)(r);if(!i&&!e)throw new Error(`Unsupported WKT type: ${n}`)}else i=!(0,u.EA)(r);return a=t&&o.yD.has(t)?Math.PI/200:i?(0,o.Ao)(r):Math.PI/180,{isPCS:i,metersOrRadiansPerUnit:a,semiMajor:0,wkidOrWkt:e}}));class c{createJSONObjectIterator(e){return{m_iteratorType:"object",m_o:e,m_keys:this.m_options.strict?Object.keys(e):Object.keys(e).filter((t=>void 0!==e[t])),m_i:-1,m_bReturnKey:!0,next:m}}createJSONArrayIterator(e){return{m_iteratorType:"array",m_strict:this.m_options.strict,m_i:-1,m_a:e,next:l}}constructor(e,t){this.m_currentToken=0,this.m_options=t?{...t}:{strict:!0};const n=e;this.m_iteratorStack=[n instanceof Array?this.createJSONArrayIterator(n):this.createJSONObjectIterator(n)],this.m_nextFlatToken={m_value:null,m_token:0}}nextToken(){if(0===this.m_iteratorStack.length)return this.m_currentToken=0;switch(this.m_nextFlatToken=this.m_iteratorStack.at(-1).next().value,this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_currentToken=1;case 3:return this.m_iteratorStack.pop(),this.m_currentToken=3;case 2:return this.m_currentToken=2;case 4:return this.m_iteratorStack.pop(),this.m_currentToken=4;case 5:return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=5;case 6:if(this.m_nextFlatToken.m_value instanceof Array)return this.m_iteratorStack.push(this.createJSONArrayIterator(this.m_nextFlatToken.m_value)),this.nextToken();if(this.m_nextFlatToken.m_value instanceof Object)return this.m_iteratorStack.push(this.createJSONObjectIterator(this.m_nextFlatToken.m_value)),this.nextToken();if("number"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,Number.isSafeInteger(this.m_currentValue)&&this.m_currentValue>=(0,i.L)()&&this.m_currentValue<=(0,i.o)()?this.m_currentToken=8:this.m_currentToken=7;if("string"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=6;if("boolean"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=this.m_nextFlatToken.m_value?11:12;if("object"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=null,this.m_currentToken=10;(0,r.a)("unrecognized json element type")}return(0,r.a)("unrecognized json element type"),0}currentToken(){return this.m_currentToken}skipChildren(){if(0!==this.m_iteratorStack.length)switch(this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=3,void(this.m_currentToken=3);case 2:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=4,void(this.m_currentToken=4)}}currentString(){return 6!==this.m_currentToken&&5!==this.m_currentToken&&(0,r.t)("invalid token"),this.m_currentValue}currentDoubleValue(){return 7!==this.m_currentToken&&8!==this.m_currentToken&&(0,r.t)("invalid token"),this.m_currentValue}currentInt32Value(){return 8!==this.m_currentToken&&(0,r.t)("invalid token"),this.m_currentValue}currentInt64Value(){return(0,r.g)(0),0n}currentBoolValue(){return 12!==this.m_currentToken&&11!==this.m_currentToken&&(0,r.t)("invalid token"),this.m_currentValue}isError(){return 0}}class d{constructor(e){return this.m_buffer=null,this.m_view=null,this.m_sz=0,this.m_offset=0,this.m_bOwnsBuffer=!0,this.m_bLittleEndian=!0,this.m_element=new ArrayBuffer(8),this.m_elementBytes=new Uint8Array(this.m_element),this.m_elementView=new DataView(this.m_element),this.m_elementDouble=new Float64Array(this.m_element),this.m_elementFloat=new Float32Array(this.m_element),this.m_elementInt64=new BigInt64Array(this.m_element),this.m_elementInt32=new Int32Array(this.m_element),this.m_elementInt16=new Int16Array(this.m_element),void 0!==e.sz?(this.m_sz=e.sz,e.buffer?(this.m_sz<0&&(0,r.w)("size out of range"),this.m_buffer=e.buffer,this.m_offset=void 0!==e.offset?e.offset:0,this.m_view=void 0!==e.offset?new DataView(e.buffer,e.offset,e.sz):new DataView(this.m_buffer),this.m_bOwnsBuffer=!1,void(this.m_bLittleEndian=!0)):(this.m_sz<0&&(0,r.w)("size out of range"),void(this.m_sz>0&&(this.m_buffer=new ArrayBuffer(this.m_sz),this.m_view=new DataView(this.m_buffer))))):e.move?(this.m_sz=e.move.m_sz,this.m_buffer=e.move.m_buffer,this.m_view=e.move.m_view,this.m_bOwnsBuffer=e.move.m_bOwnsBuffer,this.m_bLittleEndian=e.move.m_bLittleEndian,e.move.m_buffer=null,e.move.m_view=null,e.move.m_sz=0,void(e.move.m_bOwnsBuffer=!0)):void(0,r.a)("unrecognized constructor options")}swapBytesDouble(){this.doSwap()&&(this.m_elementDouble[0]=this.m_elementBytes[0]<<56|this.m_elementBytes[1]<<48|this.m_elementBytes[2]<<40|this.m_elementBytes[3]<<32|this.m_elementBytes[4]<<24|this.m_elementBytes[5]<<16|this.m_elementBytes[6]<<8|this.m_elementBytes[7])}swapBytesInt32(){this.doSwap()&&(this.m_elementInt32[0]=this.m_elementBytes[0]<<24|this.m_elementBytes[1]<<16|this.m_elementBytes[2]<<8|this.m_elementBytes[3])}getOffset(){return this.m_offset}assignMove(e){return this===e||(this.clear(),this.m_sz=e.m_sz,this.m_buffer=e.m_buffer,this.m_view=e.m_view,this.m_bOwnsBuffer=e.m_bOwnsBuffer,this.m_bLittleEndian=e.m_bLittleEndian,e.m_buffer=null,e.m_sz=0,e.m_bOwnsBuffer=!0),this}doSwap(){return this.m_bLittleEndian!==(1===d.getNativeByteOrder())}setNativeByteOrder(){this.m_bLittleEndian=1===d.getNativeByteOrder()}setOrder(e){this.m_bLittleEndian=1===e}getOrder(){return this.m_bLittleEndian?1:0}getView(){return this.m_view||(0,r.u)("buffer not defined"),this.m_view}static getNativeByteOrder(){return 1}clear(){this.m_buffer=null,this.m_sz=0,this.m_bOwnsBuffer=!0}size(){return this.m_sz}readDouble(e){return this.doSwap()?(this.m_elementDouble[0]=this.m_view.getFloat64(e,this.m_bLittleEndian),this.swapBytesDouble(),this.m_elementDouble[0]):this.m_view.getFloat64(e,this.m_bLittleEndian)}writeDouble(e,t){this.m_elementDouble[0]=t,this.swapBytesDouble(),this.m_view.setFloat64(e,this.m_elementDouble[0],this.m_bLittleEndian)}readInt32(e){return this.doSwap()?(this.m_elementInt32[0]=this.m_view.getInt32(e,this.m_bLittleEndian),this.swapBytesInt32(),this.m_elementInt32[0]):this.m_view.getInt32(e,this.m_bLittleEndian)}writeInt32(e,t){this.m_elementInt32[0]=t,this.swapBytesInt32(),this.m_view.setInt32(e,this.m_elementInt32[0],this.m_bLittleEndian)}getPtr(){return this.m_buffer}setSizeNoRealloc(e){(0,r.g)(e>=0&&e<=this.m_sz),this.m_sz=e}}function h(e){let t=!1;for(;3!==e.nextToken();){const n=e.currentString();e.nextToken(),"uwkid"===n?t||(t=!0,8===e.currentToken()&&e.currentInt32Value()):e.skipChildren()}return null}function _(e){let t=!1,n=!1,r=!1,i=!1,s=!1,o=!1,u=!1,m=!1,l=!1,c=!1,d=!1,_=!1,f=!1,p=!1,k=!1,b=!1,y=!1,g=-1,T=-1,N=-1,v=-1,x=0,A=0,S=0,w=0,C=0,D=0,F=0,j=0,O=0,I=0,z="",E="",G=null;for(;3!==e.nextToken();){const a=e.currentString();e.nextToken(),"wkid"===a?t||(t=!0,8===e.currentToken()&&(g=e.currentInt32Value())):"latestWkid"===a?n||(n=!0,8===e.currentToken()&&(T=e.currentInt32Value())):"wkt"===a?s||(s=!0,6===e.currentToken()&&(z=e.currentString())):"wkt2"===a?s||6===e.currentToken()&&(E=e.currentString()):"vcsWkid"===a?r||(r=!0,8===e.currentToken()&&(N=e.currentInt32Value())):"latestVcsWkid"===a?i||(i=!0,8===e.currentToken()&&(v=e.currentInt32Value())):"xyTolerance"===a?u||(u=!0,o=!0,x=e.currentDoubleValue()):"zTolerance"===a?m||(m=!0,o=!0,A=e.currentDoubleValue()):"mTolerance"===a?l||(l=!0,o=!0,S=e.currentDoubleValue()):"falseX"===a?c||(c=!0,o=!0,F=e.currentDoubleValue()):"falseY"===a?d||(d=!0,o=!0,j=e.currentDoubleValue()):"falseZ"===a?_||(_=!0,o=!0,O=e.currentDoubleValue()):"falseM"===a?f||(f=!0,o=!0,I=e.currentDoubleValue()):"xyUnits"===a?p||(p=!0,o=!0,w=e.currentDoubleValue()):"zUnits"===a?k||(k=!0,o=!0,C=e.currentDoubleValue()):"mUnits"===a?b||(b=!0,o=!0,D=e.currentDoubleValue()):"unit"===a?y||(y=!0,G=h(e)):e.skipChildren()}v<=0&&N>0&&(v=N),N<=0&&v>0&&(N=v);let P=null,B=!0;if(0!==z.length&&(B=!1,(0,a.a3)(z)&&(P=(0,a.a)(z))),P||0===E.length||(B=!1,(0,a.a3)(E)&&(P=(0,a.a)(E))),!P&&T>0&&(B=!1,(0,a.a4)(T)&&(v<=0||(0,a.a5)())&&(P=(0,a.c)(T,v))),!P&&g>0&&(B=!1,(0,a.a4)(g)&&(N<=0||(0,a.a5)())&&(P=(0,a.c)(g,N))),B&&(P=(0,a.j)(G)),o&&P){const e=new a.S;P.queryPrecisionDescriptorWithoutFalseXY(e),u&&e.setTolerance(0,x),m&&e.setTolerance(1,A),l&&e.setTolerance(2,S),p&&c&&d&&e.setGridParams(F,j,w),k&&_&&e.setZParams(O,C),b&&f&&e.setMParams(I,D),P=(0,a.a6)(P,e)}return P}function f(e,t,n,a){2!==a.currentToken()&&(0,r.t)("failed to parse multipath: array of array of vertices is expected");const o=e?new s.g:new s.h,u=o,m=(0,s.az)(0),l=(0,s.ax)(2,0),c=(0,s.aA)(0);let d=null,h=null,_=null,f=null,p=null,k=0,y=0,v=0;const x=new s.S,A=i.P.getNAN();let S=0,w=0;const C=e?1:0;for(;4!==a.nextToken();){2!==a.currentToken()&&(0,r.t)("failed to parse multipath: ring/path array is expected");let n=2,o=0,D=!0;const F=4;let j=0,O=0;const I=i.P.getNAN(),z=new Array(F),E=new Array(F);let G=!1;for(a.nextToken();4!==a.currentToken();){if(t&&1===a.currentToken())D&&(0,r.t)("failed to parse multipath: starting vertex array is expected"),_||(_=(0,s.aA)(S-1,1),f=(0,s.az)(S-1,-1),p=(0,s.ax)(0)),G=!0,n=1,({segFlag:v,toPointSz:j}=N(x,z,A,a));else{for(G=!1,2!==a.currentToken()&&(0,r.t)("failed to parse multipath: array is expected, rings/paths vertices consist of arrays of coordinates"),j=0;4!==a.nextToken();)j===F&&(0,r.t)("failed to parse multipath: each vertex array has to have at most 4 elements"),z[j++]=b(a);j<2&&(0,r.t)("failed to parse multipath: each vertex array has to have at least 2 elements"),(0,s.aB)(z[0],z[1])||(0,r.t)("failed to parse multipath: x and y must be finite")}a.nextToken();do{if(l.size()===2*S&&l.resize(g(S)),l.writePoint2D(2*S,I.setCoords(z[0],z[1])),d&&d.size()===S&&d.resize(T(S)),j>2?(d||(d=(0,s.ax)(S+1,Number.NaN)),d.write(S,z[2])):d&&d.write(S,Number.NaN),h&&h.size()===S&&h.resize(T(S)),j>3?(h||(h=(0,s.ax)(S+1,Number.NaN)),h.write(S,z[3])):h&&h.write(S,Number.NaN),D)w++,m.add(S),c.add(C),D=!1,O=j,(0,i.D)(E,z,0,0,O);else if(null!==_)if(G){const e=(0,s.aG)(v),t=p.size();p.resize(t+e),_.add(v),f.add(k),x.get().writeInBufferStream(p,k),k+=e,u.incCurveType(v,1),y++}else _.add(1),f.add(-1);S++,o++,A.setCoords(z[0],z[1])}while(o<n&&4===a.currentToken())}0!==o&&(e&&o>n&&j===O&&0===(0,i.N)(z,E,j)?(S--,o--):null!==_&&(_.add(1),f.add(-1)))}return S&&(m.resize(w),c.resize(w),S>0&&(m.add(S),c.add(0)),u.setAttributeStreamRef(0,l),u.setPathFlagsStreamRef(c),u.setPathStreamRef(m),null!==_&&(u.updateCurveCounter(y),u.setSegmentData(f,p,_,k)),u.notifyModifiedFlags(65535)),{geometry:o,as:d,bs:h}}function p(e,t){2!==t.currentToken()&&(0,r.t)("failed to parse multipoint: array of vertices is expected");let n=0;const a=new s.M,o=(0,s.ax)(2,0);let u=0;const m=new Array(4),l=new i.P;let c=null,d=null;for(;4!==t.nextToken();){for(2!==t.currentToken()&&(0,r.t)("failed to parse multipoint: array is expected, multipoint vertices consist of arrays of cooridinates"),u=0;4!==t.nextToken();)4===u&&(0,r.t)("failed to parse multipoint: each vertex array has to have at most 4 elements"),m[u++]=b(t);u<2&&(0,r.t)("failed to parse multipoint: each vertex array has to have at least 2 elements"),(0,s.aB)(m[0],m[1])||(0,r.t)("failed to parse multipoint: x and y must be finite"),o.size()===2*n&&o.resize(g(n)),o.writePoint2D(2*n,l.setCoords(m[0],m[1])),c&&c.size()===n&&c.resize(T(n)),u>2?(c||(c=(0,s.ax)(n+1,Number.NaN)),c.write(n,m[2])):c&&c.write(n,Number.NaN),d&&d.size()===n&&d.resize(T(n)),u>3?(d||(d=(0,s.ax)(n+1,Number.NaN)),d.write(n,m[3])):d&&d.write(n,Number.NaN),n++}if(n){const e=a.getImpl();e.setAttributeStreamRef(0,o),e.resizeNoInit(n),e.notifyModifiedFlags(65535)}return{geometry:a,as:c,bs:d}}function k(e,t){2!==t.currentToken()&&(0,r.t)("failed to parse array of IDs: array of array of integers is expected");const n=(0,s.aC)(2,0);let i=0,a=-1;for(;4!==t.nextToken();){const e=i;n.size()===i&&n.resize(T(i)),i++;let s=0;for(-1===a?a=2===t.currentToken()?1:0:1===a&&2!==t.currentToken()&&(0,r.t)("failed to parse array of IDs: array of array of integers is expected"),0===a&&(n.size()===i&&n.resize(T(i)),n.write(i,y(t)),s++,i++);4!==t.nextToken();)n.size()===i&&n.resize(T(i)),n.write(i,y(t)),s++,i++;if(n.write(e,s),0===a)break}return n.resize(i),n}function b(e){const t=e.currentToken();if(10===t||6===t&&"NaN"===e.currentString())return Number.NaN;{const t=e.currentDoubleValue();return Number.isNaN(t)?Number.NaN:t}}function y(e){return e.currentInt32Value()}function g(e){let t=2*Math.trunc(3*(e+1)/2);return t<8?t=8:t<32&&(t=32),t}function T(e){let t=Math.trunc(3*(e+1)/2);return t<4?t=4:t<16&&(t=16),t}function N(e,t,n,a,o){const u={segFlag:0,toPointSz:0};let m=a.currentToken();m=a.nextToken();const l=a.currentString(),c=l[0];for((1!==l.length||"a"!==c&&"b"!==c&&"c"!==c&&"n"!==c&&"q"!==c)&&(0,r.t)('failed to parse curve: expecting "a", "b", "n", "q", or "c"'),m=a.nextToken(),2!==m&&(0,r.t)("failed to parse curve: start array is expected for curve parameters"),m=a.nextToken(),2!==m&&(0,r.t)("failed to parse curve: start array is expected for to point"),u.toPointSz=0;4!==a.nextToken();)4===u.toPointSz&&(0,r.t)("failed to parse curve: vertex array cannot have more than 4 elements"),t[u.toPointSz++]=b(a);u.toPointSz<2&&(0,r.t)("failed to parse curve: vertex array must have at least 2 elements");const h=i.P.construct(t[0],t[1]),_=i.P.getNAN();let f=-1,p=-1,k=!1,y=Number.NaN,g=Number.NaN,T=Number.NaN;const N=[i.P.getNAN(),i.P.getNAN(),i.P.getNAN()],x=i.P.getNAN();if("a"===c){m=a.nextToken(),2!==m&&(0,r.t)("failed to parse curve: start array is expected for center point"),m=a.nextToken();const e=b(a);m=a.nextToken();const t=b(a);m=a.nextToken(),4!==m&&(0,r.t)("failed to parse curve: end array is expected for center point"),_.setCoords(e,t),m=a.nextToken(),f=a.currentInt32Value(),m=a.nextToken(),p=a.currentInt32Value(),m=a.nextToken(),4!==m?(k=!1,y=b(a),m=a.nextToken(),g=b(a),m=a.nextToken(),T=b(a),m=a.nextToken(),4!==m&&(0,r.t)("failed to parse curve: end array is expected for curve parameters")):k=!0,u.segFlag=4}else if("b"===c){for(let e=0;e<2;e++){m=a.nextToken(),2!==m&&(0,r.t)("failed to parse curve: start array is expected for control point"),m=a.nextToken();const t=b(a);m=a.nextToken();const n=b(a);m=a.nextToken(),4!==m&&(0,r.t)("failed to parse curve: end array is expected for control point"),N[e].setCoords(t,n)}m=a.nextToken(),4!==m&&(0,r.t)("failed to parse curve: end array is expected for curve parameters"),u.segFlag=2}else if("n"===c){{m=a.nextToken(),2!==m&&(0,r.t)("failed to parse curve: start array is expected for control point"),m=a.nextToken();const e=b(a);m=a.nextToken();const t=b(a);m=a.nextToken(),4!==m&&(0,r.t)("failed to parse curve: end array is expected for control point"),N[0].setCoords(e,t)}m=a.nextToken();const e=b(a);m=a.nextToken();const t=b(a);m=a.nextToken();const n=b(a);N[1].setCoords(e,t),N[2].setCoords(n,n),m=a.nextToken(),4!==m&&(0,r.t)("failed to parse curve: end array is expected for curve parameters"),u.segFlag=8}else if("q"===c){for(let e=0;e<1;e++){m=a.nextToken(),2!==m&&(0,r.t)("failed to parse curve: start array is expected for control point"),m=a.nextToken();const t=b(a);m=a.nextToken();const n=b(a);m=a.nextToken(),4!==m&&(0,r.t)("failed to parse curve: end array is expected for control point"),N[e].setCoords(t,n)}m=a.nextToken(),4!==m&&(0,r.t)("failed to parse curve: end array is expected for curve parameters"),u.segFlag=16}else{m=a.nextToken(),2!==m&&(0,r.t)("failed to parse curve: start array is expected for interior point"),m=a.nextToken();const e=b(a);m=a.nextToken();const t=b(a);m=a.nextToken(),4!==m&&(0,r.t)("failed to parse curve: end array is expected for interior point"),x.setCoords(e,t),m=a.nextToken(),4!==m&&(0,r.t)("failed to parse curve: end array is expected for curve parameters"),u.segFlag=4}if(m=a.nextToken(),3!==m&&(0,r.t)("failed to parse curve: end object is expected for curve"),"a"===c)if(e.createEllipticArc(),k){const t=!0;v(e.get(),n,h,_,t,f,p)}else!function(e,t,n,r,i,a,o,u,m){e.dropAllAttributes();const l=new ArrayBuffer(44),c=new d({sz:44,buffer:l});let h=0;c.writeDouble(h,r.x),h+=8,c.writeDouble(h,r.y),h+=8,c.writeDouble(h,o),h+=8,c.writeDouble(h,u),h+=8,c.writeDouble(h,m),h+=8;let _=0;a||(_|=2048),i&&(_|=4096),c.writeInt32(h,_),h+=4,function(e,t,n,r){e.m_bits=0,e.m_center.x=r.readDouble(0),e.m_center.y=r.readDouble(8),e.m_rotation=r.readDouble(16),e.m_semiMajorAxis=r.readDouble(24),e.m_minorMajorRatio=r.readDouble(32),e.m_XStart=t.x,e.m_YStart=t.y,e.m_XEnd=n.x,e.m_YEnd=n.y;const i=r.readInt32(40);if(1&i)return!1;let a=!!(64&i),o=!!(128&i);const u=!!(2048&i),m=!!(4096&i);!(512&i)&&!(1024&i)||o||(a=!0),o&&!t.equals(n)?(o=!1,a=!0):a&&t.equals(n)&&(o=!0,a=!1),o?(e.m_center.assign(t),e.m_startAngle=e.m_center.x,e.m_sweepAngle=e.m_center.y,(0,s.aF)(e,Number.NaN,u,m),e.m_semiMajorAxis=0,e.m_interior.setCoordsPoint2D(t)):a?(e.m_center.setNAN(),e.m_semiMajorAxis=1,e.m_minorMajorRatio=0,e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0,(0,s.aD)(e),e.queryCoord2D(.5,e.m_interior)):e.constructEllipticArcEndPointsCenter(t,n,e.m_semiMajorAxis,e.m_minorMajorRatio,e.m_rotation,!m,u,e.m_center),e.setProjectionBehavior(1),(0,s.aD)(e)}(e,t,n,c)}(e.get(),n,h,_,f,p,y,g,T);else if("b"===c)e.createCubicBezier(),function(e,t,n,a){e.dropAllAttributes();const s=new ArrayBuffer(32),o=new d({sz:32,buffer:s});let u=0;o.writeDouble(u,a[0].x),u+=8,o.writeDouble(u,a[0].y),u+=8,o.writeDouble(u,a[1].x),u+=8,o.writeDouble(u,a[1].y),u+=8,function(e,t,n,a){(0,r.g)(32<=a.size()),e.m_cp=(0,i.m)(i.P,2),e.m_cp[0].x=a.readDouble(0),e.m_cp[0].y=a.readDouble(8),e.m_cp[1].x=a.readDouble(16),e.m_cp[1].y=a.readDouble(24),e.m_XStart=t.x,e.m_YStart=t.y,e.m_XEnd=n.x,e.m_YEnd=n.y}(e,t,n,o)}(e.get(),n,h,N);else if("n"===c)e.createQuadraticRationalBezier(),function(e,t,n,r,i,a,s){e.dropAllAttributes();const o=new ArrayBuffer(40),u=new d({sz:40,buffer:o});let m=0;u.writeDouble(m,r.x),m+=8,u.writeDouble(m,r.y),m+=8,u.writeDouble(m,i),m+=8,u.writeDouble(m,a),m+=8,u.writeDouble(m,s),m+=8,function(e,t,n,r){e.m_cp.x=r.readDouble(0),e.m_cp.y=r.readDouble(8),e.m_weights[0]=r.readDouble(16),e.m_weights[1]=r.readDouble(24),e.m_weights[2]=r.readDouble(32),e.m_XStart=t.x,e.m_YStart=t.y,e.m_XEnd=n.x,e.m_YEnd=n.y}(e,t,n,u)}(e.get(),n,h,N[0],N[1].x,N[1].y,N[2].x);else if("q"===c)e.createQuadraticBezier(),e.get().construct(n,N[0],h);else{e.createEllipticArc();const t=!1;v(e.get(),n,h,x,t,-1,-1)}return u}function v(e,t,n,a,o,u,m){e.dropAllAttributes();const l=new ArrayBuffer(20),c=new d({sz:20,buffer:l});let h=0;c.writeDouble(h,a.x),h+=8,c.writeDouble(h,a.y),h+=8;let _=0;o?(m||(_|=8),u&&(_|=16)):_|=128,c.writeInt32(h,_),h+=4,function(e,t,n,a){0>=a.size()&&(0,r.w)("Byte_buffer out of range access"),e.m_bits=0,e.m_rotation=0,e.m_cosr=1,e.m_sinr=0,e.setStartXY(t),e.setEndXY(n);const o=i.P.getNAN();o.x=a.readDouble(0),o.y=a.readDouble(8);const u=a.readInt32(16);if(1&u)return e.m_semiMajorAxis=0,e.m_minorMajorRatio=1,e.m_interior.assign(o),e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0,(0,s.aD)(e),!1;let m=!!(64&u);const l=!!(128&u);let c=!!(32&u);const d=!!(8&u),h=!!(16&u),_=t.equals(n);m&&!_&&(m=!1,c=!0),c&&_&&(m=!0,c=!1,o.setCoords(0,0)),m||(l?c?(e.m_semiMajorAxis=1,e.m_minorMajorRatio=0,e.m_interior.assign(o),e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0):(e.constructCircularArcThreePoint(t,n,o),_&&d===e.isClockwise()&&e.reverse()):c?(e.m_semiMajorAxis=1,e.m_minorMajorRatio=0,e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0,(0,s.aD)(e),e.queryCoord2D(.5,e.m_interior)):(0,s.aE)(e,t,n,o,d,h)),m&&(e.m_center.assign(t),e.m_startAngle=o.x,e.m_sweepAngle=o.y,(0,s.aF)(e,Number.NaN,d,h),e.m_semiMajorAxis=0,e.m_minorMajorRatio=1,e.m_interior.setCoordsPoint2D(t)),e.setProjectionBehavior(0),(0,s.aD)(e)}(e,t,n,c)}function x(e,t,n,i,a){const o=e.getGeometryType();if(o===r.G.enumEllipticArc)return function(e,t,n,i,a){(0,r.g)(!(0,s.aw)(e));const o=e.getEndXY(),u=e.hasAttribute(1)&&!t,m=e.hasAttribute(2)&&!n;let l=Number.NaN,c=Number.NaN;if(u&&(l=e.getEndAttributeAsDbl(1,0)),m&&(c=e.getEndAttributeAsDbl(2,0)),e.isDegenerateToLine()||e.isDegenerate(0))return S(u,m,o.x,o.y,l,c,i,a),!0;const d=0===e.projectionBehavior(),h=!!d&&e.isClosed();if(d&&!h)a.startObject(),a.addFieldName("c"),a.startArray(),S(u,m,o.x,o.y,l,c,i,a),w(e.m_interior.x,e.m_interior.y,17,a),a.endArray(),a.endObject();else if(d){a.startObject(),a.addFieldName("a"),a.startArray(),S(u,m,o.x,o.y,l,c,i,a);const t=0,n=0;w(e.m_center.x+t,e.m_center.y+n,17,a);const r=!e.isMajor();a.addInt32(r?1:0);const s=e.isClockwise();a.addInt32(s?1:0),a.endArray(),a.endObject()}else{a.startObject(),a.addFieldName("a"),a.startArray(),S(u,m,o.x,o.y,l,c,i,a);const t=e;w(t.m_center.x,t.m_center.y,17,a);const n=!t.isMajor();a.addInt32(n?1:0);const r=t.isClockwise();a.addInt32(r?1:0),a.addDouble(t.m_rotation,17),a.addDouble(t.m_semiMajorAxis,17),a.addDouble(t.m_minorMajorRatio,17),a.endArray(),a.endObject()}return!1}(e,t,n,i,a);if(o===r.G.enumBezier)return A(e,t,n,i,a);if(o===r.G.enumRationalBezier2)return function(e,t,n,r,i){const a=e.getEndXY(),s=e.hasAttribute(1)&&!t,o=e.hasAttribute(2)&&!n;let u=Number.NaN,m=Number.NaN;s&&(u=e.getEndAttributeAsDbl(1,0)),o&&(m=e.getEndAttributeAsDbl(2,0)),i.startObject(),i.addFieldName("n"),i.startArray(),S(s,o,a.x,a.y,u,m,r,i),w(e.m_cp.x,e.m_cp.y,r,i);const l=r;return i.addDouble(e.m_weights[0],l),i.addDouble(e.m_weights[1],l),i.addDouble(e.m_weights[2],l),i.endArray(),i.endObject(),!1}(e,t,n,i,a);if(o===r.G.enumBezier2){const r=new s.af;return r.constructFromQuadraticSegment(e),A(r,t,n,i,a)}(0,r.k)("")}function A(e,t,n,r,i){const a=e.getEndXY(),s=e.hasAttribute(1)&&!t,o=e.hasAttribute(2)&&!n;let u=Number.NaN,m=Number.NaN;return s&&(u=e.getEndAttributeAsDbl(1,0)),o&&(m=e.getEndAttributeAsDbl(2,0)),i.startObject(),i.addFieldName("b"),i.startArray(),S(s,o,a.x,a.y,u,m,r,i),w(e.m_cp[0].x,e.m_cp[0].y,r,i),w(e.m_cp[1].x,e.m_cp[1].y,r,i),i.endArray(),i.endObject(),!1}function S(e,t,n,r,i,a,s,o){o.startArray(),o.addDouble(n,s),o.addDouble(r,s),e&&o.addDouble(i,s),t&&o.addDouble(a,s),o.endArray()}function w(e,t,n,r){r.startArray(),r.addDouble(e,n),r.addDouble(t,n),r.endArray()}function C(e,t,n,i){const a=n.getImpl(),o=!!(2&t),u=!!(4&t),m=!!(8&t),l=a.hasAttribute(1)&&!o,c=a.hasAttribute(2)&&!u,d=a.hasAttribute(3)&&!m,h=a.hasNonLinearSegments();l&&(i.addFieldName("hasZ"),i.addBool(!0)),c&&(i.addFieldName("hasM"),i.addBool(!0)),e?h?i.addFieldName("curveRings"):i.addFieldName("rings"):h?i.addFieldName("curvePaths"):i.addFieldName("paths");let _=null;const f=[];if(n.isEmpty())i.startArray(),i.endArray();else{const e=17-(31&t>>13);i.startArray();const m=n.getPathCount();let p=0;const k=a.getAttributeStreamRef(0);let b=null,y=null,g=null;const T=new s.S;let N=null,v=null,A=null;h&&(N=a.getSegmentFlagsStreamRef(),v=a.getSegmentIndexStreamRef(),A=a.getSegmentDataStreamRef()),l&&(b=a.getAttributeStreamRef(1)),c&&(y=a.getAttributeStreamRef(2)),d&&(g=a.getAttributeStreamRef(3),_=(0,s.aH)(3,0));for(let t=0;t<m;t++){i.startArray(),d&&f.push(0);const a=n.getPathEnd(t);if(p===a){i.endArray();continue}const s=n.isClosedPath(t);let m=k.read(2*p),h=k.read(2*p+1),S=l?b.read(p):Number.NaN,w=c?y.read(p):Number.NaN,C=d?g.read(p):0;D(l,c,m,h,S,w,e,i);let F=1;d&&(_.add(C),f[f.length-1]++);const j=m,O=h,I=S,z=w,E=C;let G=!1,P=0,B=Number.NaN,V=Number.NaN,M=0;for(let t=p+1,n=p,R=s?a+1:a;t<R;t++,n++){const s=null!==N?31&N.read(n):1;let p,R;if(t<a?(p=k.read(2*t),R=k.read(2*t+1),l&&(B=b.read(t)),c&&(V=y.read(t)),d&&(M=g.read(t))):(p=j,R=O,B=I,V=z,M=E),1!==s){G=!0,4===s?T.createEllipticArc():2===s?T.createCubicBezier():16===s?T.createQuadraticBezier():8===s?T.createQuadraticRationalBezier():(0,r.k)("JSON export.unsupported curve");const t=T.get(),a=v.read(n);t.setStartXYCoords(m,h),t.setEndXYCoords(p,R),l&&(t.setStartAttribute(1,0,S),t.setEndAttribute(1,0,B)),c&&(t.setStartAttribute(2,0,w),t.setEndAttribute(2,0,V)),t.readFromBufferStream(A,a),x(T.get(),o,u,e,i)&&P++}else D(l,c,p,R,B,V,e,i);d&&(_.add(M),f[f.length-1]++),F++,m=p,h=R,S=B,w=V,C=M}G&&0===P||(F<2&&P<1&&(D(l,c,m,h,S,w,e,i),F++,d&&(_.add(C),f[f.length-1]++)),s&&F<3&&P<2&&(D(l,c,j,O,I,z,e,i),F++,m=j,h=O,S=I,w=z,C=E,d&&(_.add(E),f[f.length-1]++))),i.endArray(),p=a}i.endArray()}if(d){i.addFieldName("ids"),i.startArray();let e=0;for(let t=0,n=f.length;t<n;++t){const n=f[t];(0,r.g)(0===n||null!==_&&e+n<=_.size()),i.startArray();for(let t=0;t<n;++t)i.addInt32(_.read(e)),e++;i.endArray()}i.endArray()}}function D(e,t,n,r,i,a,s,o){o.startArray(),o.addDouble(n,s),o.addDouble(r,s),e&&o.addDouble(i,s),t&&o.addDouble(a,s),o.endArray()}const F="a".charCodeAt(0),j="A".charCodeAt(0),O="*".charCodeAt(0),I="b".charCodeAt(0),z=("\b".charCodeAt(0),"\\".charCodeAt(0)),E="[".charCodeAt(0),G="{".charCodeAt(0),P=":".charCodeAt(0),B=".".charCodeAt(0),V=",".charCodeAt(0),M='"'.charCodeAt(0),R="]".charCodeAt(0),U="}".charCodeAt(0),X="e".charCodeAt(0),W="E".charCodeAt(0),L="f".charCodeAt(0),Y=("\f".charCodeAt(0),"F".charCodeAt(0)),K="/".charCodeAt(0),q=("<".charCodeAt(0),"-".charCodeAt(0)),Z="+".charCodeAt(0),J="n".charCodeAt(0),H="N".charCodeAt(0),Q=("\n".charCodeAt(0),"r".charCodeAt(0)),$=("\r".charCodeAt(0),"t".charCodeAt(0)),ee=("\t".charCodeAt(0),"u".charCodeAt(0)),te="0".charCodeAt(0),ne="9".charCodeAt(0);class re{constructor(e){this.m_functionStack=[],this.m_pushPositions=[],this.m_utf8Decoder=new TextDecoder("utf-8",{fatal:!0}),void 0===e?(this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_endToken=0,this.m_currentTokenType=0,this.m_functionStack.push((()=>this.accept_())),this.m_jsonString=null,this.m_bHasEscapes=!1):e.jsonString?this.resetParserFromString(e.jsonString):e.jsonStream?(0,r.k)("streaming json parsing not yet impl"):(0,r.a)("invalid constructor parameter")}prepSubstrString_(){}getCurrentSubstrString_(){return this.m_jsonString.slice(this.m_startToken,this.m_endToken)}stepOverCharString_(){this.m_endToken++}peekCharString_(){return this.m_jsonString.charCodeAt(this.m_endToken)}getString_(e){const t=this.m_jsonString?.slice(this.m_startToken,this.m_startToken+e-1);return this.m_endToken+=e-1,{s:t,bDone:this.m_endToken>=this.m_jsonString.length}}incrementString_(){this.m_endToken++}eofString_(){return this.m_endToken>=this.m_jsonString.length}setStringFunctions_(){this.m_prepSubstr=this.prepSubstrString_,this.m_getCurrentSubstr=this.getCurrentSubstrString_,this.m_stepOverChar=this.stepOverCharString_,this.m_peekChar=this.peekCharString_,this.m_get=this.getString_,this.m_increment=this.incrementString_,this.m_eof=this.eofString_}setStreamFunctions_(){(0,r.k)("streaming json parsing not yet impl")}reset_(){this.m_jsonString=null,this.m_endToken=0,this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_currentTokenType=0,this.m_bHasEscapes=!1,this.m_functionStack.length=0,this.m_functionStack.push((()=>this.start_())),this.m_pushPositions.length=0}resetParserFromString(e){this.reset_(),this.setStringFunctions_(),this.m_jsonString=e}resetParserFromStream(e){(0,r.k)("streaming json parsing not yet impl")}resetToPosition(e){return(0,r.g)(0),!1}nextToken(){return this.m_functionStack.at(-1)(),this.m_currentTokenType}currentToken(){return this.m_currentTokenType}currentTokenStartIndex(){return this.m_startToken}currentTokenEndIndex(){return this.m_endToken}currentText(){return(0,r.g)(0),""}childrenAsString(){return(0,r.g)(0),""}skipChildren(){this.skipChildren_()}skipChildren_(){if(1!==this.m_currentTokenType)if(2!==this.m_currentTokenType);else{let e=1;do{this.m_currentTokenType=this.nextToken(),2===this.m_currentTokenType?e++:4===this.m_currentTokenType&&e--}while(4!==this.m_currentTokenType||0!==e)}else{let e=1;do{this.m_currentTokenType=this.nextToken(),1===this.m_currentTokenType?e++:3===this.m_currentTokenType&&e--}while(3!==this.m_currentTokenType||0!==e)}}currentTerminalAsString_(){switch(this.m_currentTokenType){case 7:case 8:case 9:return this.m_getCurrentSubstr().slice(0,this.m_endToken-this.m_startToken);case 10:return"null";case 11:return"true";case 12:return"false"}(0,r.t)("invalid token")}toUTF8_(e,t){let n=0,r=e;for(;t.charCodeAt(r)===z&&t.charCodeAt(r+1)===ee;)n++,r+=6;r=e;const i=new Uint8Array(n);let a=0;for(;t.charCodeAt(r)===z&&t.charCodeAt(r+1)===ee;)i[a++]=Number.parseInt(t.slice(r+2,r+6),16),r+=6;return{u8s:this.m_utf8Decoder.decode(i),end:r}}unquoteCurrentString_(){let e="",t=1;const n=this.m_endToken-this.m_startToken-1;let r=0;const i=this.m_getCurrentSubstr();for(let a=t;a<n;a++)if(i.charCodeAt(a)!==z)r++;else{switch(r>0&&(e+=i.slice(t,t+r)),i.charCodeAt(++a)){case M:e+='"';break;case ee:{const{u8s:t,end:n}=this.toUTF8_(a-1,i);a=n-1,e+=t;break}case z:e+="\\";break;case K:e+="/";break;case I:e+="\b";break;case L:e+="\f";break;case J:e+="\n";break;case Q:e+="\r";break;case $:e+="\t"}t=a+1,r=0}return r>0&&(e+=i.slice(t,t+r)),e}currentString(){return 5!==this.m_currentTokenType&&6!==this.m_currentTokenType?this.currentTerminalAsString_():this.m_bHasEscapes?this.unquoteCurrentString_():this.m_getCurrentSubstr().slice(1,this.m_endToken-this.m_startToken-2+1)}currentDoubleValue(){if(7!==this.m_currentTokenType&&8!==this.m_currentTokenType&&9!==this.m_currentTokenType&&6!==this.m_currentTokenType&&10!==this.m_currentTokenType&&(0,r.t)("invalid token"),10===this.m_currentTokenType)return Number.NaN;let e=this.m_getCurrentSubstr(),t=this.m_endToken-this.m_startToken;if(6===this.m_currentTokenType){if("NaN"===this.currentString())return Number.NaN;e=e.slice(1),t-=2,0===t&&(0,r.t)("invalid token")}const n=Number.parseFloat(e);if(6===this.m_currentTokenType)Number.isNaN(n)&&(0,r.t)("invalid token");else if(Number.isNaN(n))return Number.NaN;return n}currentInt32Value(){8!==this.m_currentTokenType&&6!==this.m_currentTokenType&&(0,r.t)("invalid token");let e=this.m_getCurrentSubstr(),t=this.m_endToken-this.m_startToken;6===this.m_currentTokenType&&(e=e.slice(1),t-=2,0===t&&(0,r.t)("invalid token"));const n=parseInt(e);return Number.isNaN(n)&&(0,r.t)("invalid token"),n}currentInt64Value(){return(0,r.g)(0),0n}currentBoolValue(){return(0,r.g)(0),!1}isError(){return 0}JSONString(){return(0,r.g)(0),""}pushPosition(){return(0,r.g)(0),!1}popPosition(){return(0,r.g)(0),!1}skipCStyleComments_(){(0,r.g)(0)}skipCppStyleComments_(){(0,r.g)(0)}skipComments_(){this.m_prepSubstr();let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,r.t)("invalid token"),e=this.m_peekChar(),e===O?this.skipCStyleComments_():e===K?this.skipCppStyleComments_():(0,r.t)("invalid token")}skipWhiteSpace_(){let e;do{this.m_eof()&&(0,r.t)("invalid token");let t=this.m_peekChar();for(;t>=9&&t<=13||32===t;)this.m_increment(),this.m_eof()&&(0,r.t)("invalid token"),t=this.m_peekChar();t===K?(this.m_startToken=this.m_endToken,e=!0,this.skipComments_()):e=!1}while(e)}rightBracket_(){return this.m_peekChar()===R&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=4,!0)}rightBrace_(){return this.m_peekChar()===U&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=3,!0)}string_(){this.m_prepSubstr(),this.m_bHasEscapes=!1,this.m_stepOverChar(),this.m_eof()&&(0,r.t)("invalid token");let e=this.m_peekChar();for(;e!==M;){const t=e===z;if(this.m_stepOverChar(),this.m_eof()&&(0,r.t)("invalid token"),e=this.m_peekChar(),t)if(this.m_bHasEscapes=!0,e===M||e===z||e===K||e===I||e===L||e===J||e===Q||e===$)this.m_stepOverChar(),this.m_eof()&&(0,r.t)("invalid token"),e=this.m_peekChar();else if(e===ee)for(let t=0;t<4;t++)this.m_stepOverChar(),this.m_eof()&&(0,r.t)("invalid token"),e=this.m_peekChar(),e>=te&&e<=ne||e>=F&&e<=L||e>=j&&e<=Y||(0,r.t)("invalid token");else(0,r.t)("invalid token")}this.m_stepOverChar()}comma_(){return this.m_peekChar()===V&&(this.m_increment(),!0)}colon_(){return this.m_peekChar()===P&&(this.m_increment(),!0)}fieldNameEnd_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.colon_()?(this.skipWhiteSpace_(),this.value_()):(0,r.t)("invalid token")}fieldNameStart_(){this.m_startToken=this.m_endToken,this.m_peekChar()!==M&&(0,r.t)("invalid token"),this.string_(),this.m_currentTokenType=5,this.m_functionStack.push((()=>this.fieldNameEnd_()))}pairEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.fieldNameStart_()):this.rightBrace_()?this.m_functionStack.pop():(0,r.t)("invalid token")}arrayStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBracket_()||(this.m_functionStack.push((()=>this.elementEnd_())),this.value_())}elementEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.value_()):this.rightBracket_()?this.m_functionStack.pop():(0,r.t)("invalid token")}objectStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBrace_()||(this.m_functionStack.push((()=>this.pairEnd_())),this.fieldNameStart_())}valueStartObject_(){this.m_increment(),this.m_currentTokenType=1,this.m_functionStack.push((()=>this.objectStart_()))}valueStartArray_(){this.m_increment(),this.m_currentTokenType=2,this.m_functionStack.push((()=>this.arrayStart_()))}valueString_(){this.string_(),this.m_currentTokenType=6}int_(){this.m_peekChar()!==te?this.digits_():this.m_stepOverChar()}digits_(){let e=this.m_peekChar();do{this.m_stepOverChar(),this.m_eof()&&(0,r.t)("invalid token"),e=this.m_peekChar()}while(e>=te&&e<=ne)}frac_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,r.t)("invalid token"),e=this.m_peekChar(),e>=te&&e<=ne||(0,r.t)("invalid token"),this.digits_()}exp_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,r.t)("invalid token"),e=this.m_peekChar(),e!==Z&&e!==q||(this.m_stepOverChar(),this.m_eof()&&(0,r.t)("invalid token"),e=this.m_peekChar()),e>=te&&e<=ne||(0,r.t)("invalid token"),this.digits_()}valueNumber_(){this.m_prepSubstr();let e=!1,t=this.m_peekChar();if(t===q?(this.m_stepOverChar(),this.m_eof()&&(0,r.t)("invalid token"),t=this.m_peekChar(),e=!0,t>=te&&t<=ne||(0,r.t)("invalid token"),this.int_()):this.int_(),t=this.m_peekChar(),t===B)this.m_currentTokenType=7,this.frac_(),t=this.m_peekChar(),t!==X&&t!==W||this.exp_();else if(t===X||t===W)this.m_currentTokenType=7,this.exp_();else{let t=0;e&&t++;const n=this.m_endToken-this.m_startToken-t;if(n<10)this.m_currentTokenType=8;else if(10===n){const n=this.m_getCurrentSubstr();e?n.slice(t)<="2147483648"?this.m_currentTokenType=8:this.m_currentTokenType=9:n.slice(t)<="2147483647"?this.m_currentTokenType=8:this.m_currentTokenType=9}else if(n<19)this.m_currentTokenType=9;else if(19===n){const n=this.m_getCurrentSubstr();e?n.slice(t)<="9223372036854775808"?this.m_currentTokenType=9:this.m_currentTokenType=7:n.slice(t)<="9223372036854775807"?this.m_currentTokenType=9:this.m_currentTokenType=7}else this.m_currentTokenType=7}}valueNull_(){const{s:e,bDone:t}=this.m_get(5);t&&(0,r.t)("invalid token"),"null"!==e&&(0,r.t)("invalid token"),this.m_currentTokenType=10}valueTrue_(){const{s:e,bDone:t}=this.m_get(5);t&&(0,r.t)("invalid token"),"true"!==e&&(0,r.t)("invalid token"),this.m_currentTokenType=11}valueFalse_(){const{s:e,bDone:t}=this.m_get(6);t&&(0,r.t)("invalid token"),"false"!==e&&(0,r.t)("invalid token"),this.m_currentTokenType=12}valueNan_(){const{s:e,bDone:t}=this.m_get(4);t&&(0,r.t)("invalid token"),"NaN"!==e&&(0,r.t)("invalid token"),this.m_currentTokenType=7}value_(){this.m_startToken=this.m_endToken;const e=this.m_peekChar();e===G?this.valueStartObject_():e===E?this.valueStartArray_():e===M?this.valueString_():e===q||e>=te&&e<=te+9?this.valueNumber_():e===J?this.valueNull_():e===$?this.valueTrue_():e===L?this.valueFalse_():e===H?this.valueNan_():(0,r.t)("invalid token")}start_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.m_functionStack.push((()=>this.accept_()));const e=this.m_peekChar();e!==G&&e!==E&&(0,r.t)("invalid token"),this.value_()}accept_(){this.m_startToken=this.m_endToken,this.m_currentTokenType=0}}const ie=new class{constructor(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject=[]}reset(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject.length=0}startObject(){const e={};this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}startArray(){const e=[];this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}endObject(){this.m_acceptedObject=this.m_currentObject.at(-1),this.m_currentObject.pop()}endArray(){this.m_currentObject.pop()}addFieldName(e){this.m_pendingKey=e}addValue_(e){this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):this.m_currentObject.at(-1).push(e)}addString(e){this.addValue_(e)}addDouble(e,t){this.addValue_(e)}addInt64(e){(0,r.g)(0)}addInt32(e){this.addValue_(e)}addBool(e){this.addValue_(e)}addNull(){this.addValue_(null)}getObject(){return this.m_acceptedObject}},ae=new class{getOperatorType(){return 10405}accelerateGeometry(e,t,n){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,t,n,i,s,o){!function(e,t,n,i){if(t||n){if(i.startObject(),null!==t)switch(t.getGeometryType()){case r.G.enumPolygon:C(!0,e,t,i);break;case r.G.enumPolyline:C(!1,e,t,i);break;case r.G.enumMultiPoint:!function(e,t,n){const i=t.getImpl(),a=i.hasAttribute(1)&&!(2&e),s=i.hasAttribute(2)&&!(4&e),o=i.hasAttribute(3)&&!(8&e);a&&(n.addFieldName("hasZ"),n.addBool(!0)),s&&(n.addFieldName("hasM"),n.addBool(!0)),n.addFieldName("points");const u=t.getPointCount();if(t.isEmpty())n.startArray(),n.endArray();else{const t=17-(31&e>>13);n.startArray();const r=i.getAttributeStreamRef(0);let o=null,m=null;a&&(o=i.getAttributeStreamRef(1)),s&&(m=i.getAttributeStreamRef(2));for(let e=0;e<u;e++){const i=r.read(2*e),u=r.read(2*e+1);let l=Number.NaN,c=Number.NaN;a&&(l=o.read(e)),s&&(c=m.read(e)),D(a,s,i,u,l,c,t,n)}n.endArray()}if(o){let e=null;i.isEmpty()||(e=i.getAttributeStreamRef(3)),(0,r.g)(0===u||null!==e&&e.size()>=u),n.addFieldName("ids"),n.startArray();for(let t=0;t<u;t++)n.addInt32(e.read(t));n.endArray()}}(e,t,i);break;case r.G.enumPoint:!function(e,t,n){const r=t.hasAttribute(1)&&!(2&e),i=t.hasAttribute(2)&&!(4&e),a=t.hasAttribute(3)&&!(8&e);if(t.isEmpty())return n.addFieldName("x"),n.addNull(),n.addFieldName("y"),n.addNull(),r&&(n.addFieldName("z"),n.addNull()),i&&(n.addFieldName("m"),n.addNull()),void(a&&(n.addFieldName("id"),n.addInt32(0)));const s=17-(31&e>>13);n.addFieldName("x"),n.addDouble(t.getX(),s),n.addFieldName("y"),n.addDouble(t.getY(),s),r&&(n.addFieldName("z"),n.addDouble(t.getZ(),s)),i&&(n.addFieldName("m"),n.addDouble(t.getM(),s)),a&&(n.addFieldName("id"),n.addInt32(t.getID()))}(e,t,i);break;case r.G.enumEnvelope:!function(e,t,n){const r=t.hasAttribute(1)&&!(2&e),i=t.hasAttribute(2)&&!(4&e),a=t.hasAttribute(3)&&!(8&e);if(t.isEmpty())return n.addFieldName("xmin"),n.addNull(),n.addFieldName("ymin"),n.addNull(),n.addFieldName("xmax"),n.addNull(),n.addFieldName("ymax"),n.addNull(),r&&(n.addFieldName("zmin"),n.addNull(),n.addFieldName("zmax"),n.addNull()),i&&(n.addFieldName("mmin"),n.addNull(),n.addFieldName("mmax"),n.addNull()),void(a&&(n.addFieldName("idmin"),n.addInt32(0),n.addFieldName("idmax"),n.addInt32(0)));const s=17-(31&e>>13);if(n.addFieldName("xmin"),n.addDouble(t.getXMin(),s),n.addFieldName("ymin"),n.addDouble(t.getYMin(),s),n.addFieldName("xmax"),n.addDouble(t.getXMax(),s),n.addFieldName("ymax"),n.addDouble(t.getYMax(),s),r){const e=t.queryInterval(1,0);n.addFieldName("zmin"),n.addDouble(e.vmin,s),n.addFieldName("zmax"),n.addDouble(e.vmax,s)}if(i){const e=t.queryInterval(2,0);n.addFieldName("mmin"),n.addDouble(e.vmin,s),n.addFieldName("mmax"),n.addDouble(e.vmax,s)}if(a){const e=t.queryInterval(3,0);n.addFieldName("idmin"),n.addInt32(e.vmin),n.addFieldName("idmax"),n.addInt32(e.vmax)}}(e,t,i);break;case r.G.enumMultipatch:(0,r.g)(0);break;default:(0,r.a)("exportToJSON")}null!==n&&(i.addFieldName("spatialReference"),function(e,t,n){n.startObject();let i=0;t.isCustomWkid()||(i=t.getOldID());let s=0;const o=t.getVCS();if(null!==o&&(o.isCustomWkid()||(s=o.getOldID()),s<=0&&(i=0)),i>0){n.addFieldName("wkid"),n.addInt32(i);const e=t.getLatestID();if(e>0&&e!==i&&(n.addFieldName("latestWkid"),n.addInt32(e)),s>0){n.addFieldName("vcsWkid"),n.addInt32(s);const e=t.getLatestVerticalID();e!==s&&(n.addFieldName("latestVcsWkid"),n.addInt32(e))}}if(0===t.getCoordinateSystemType())n.addFieldName("wkid"),n.addNull(),null!==t.getUnit()&&(n.addFieldName("unit"),function(e,t,n){n.startObject();const i=t.getID();i<=0&&(0,r.t)("cannot export unit that has no valid WKID"),n.addFieldName("uwkid"),n.addInt32(i),n.endObject()}(0,t.getUnit(),n));else if(i<=0||1&e){let r="";64&e&&(r=t.getText2(),n.addFieldName("wkt2"),n.addString(r));const i=t.getText();i!==r&&(n.addFieldName("wkt"),n.addString(i))}if(16&e){const e=new a.S;t.queryPrecisionDescriptor(e),n.addFieldName("xyTolerance"),n.addDouble(e.getTolerance(0)),n.addFieldName("zTolerance"),n.addDouble(e.getTolerance(1)),n.addFieldName("mTolerance"),n.addDouble(e.getTolerance(2)),n.addFieldName("falseX"),n.addDouble(e.getFalseX()),n.addFieldName("falseY"),n.addDouble(e.getFalseY()),n.addFieldName("xyUnits"),n.addDouble(e.getGridUnitsXY()),n.addFieldName("falseZ"),n.addDouble(e.getFalseZ()),n.addFieldName("zUnits"),n.addDouble(e.getGridUnitsZ()),n.addFieldName("falseM"),n.addDouble(e.getFalseM()),n.addFieldName("mUnits"),n.addDouble(e.getGridUnitsM())}n.endObject()}(e,n,i)),i.endObject()}}(e,t,n,i)}exportSpatialReference(e,t,n,i){(0,r.g)(0)}exportProjectionTransformation(e,t,n,i){(0,r.g)(0)}exportDatumTransformation(e,t,n,i){(0,r.g)(0)}static geometryTypeToString(e){return(0,r.g)(0),""}},se=new class{getOperatorType(){return 10404}accelerateGeometry(e,t,n){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,t,n,i,o,u,m){let l;"string"==typeof n?(l=new re({jsonString:n}),l.nextToken()):l=n,1!==l.currentToken()&&(0,r.t)("failed to import map geometry: start of object is expected");const c=function(e,t,n,i,a){let o=!1,u=!1,m=!1,l=!1,c=!1,d=!1,h=!1,g=!1,T=!1,N=!1,v=!1,x=!1,A=!1,S=!1,w=!1,C=!1,D=!1,F=!1,j=!1,O=!1,I=!1,z=!1,E=!1,G=!1,P=Number.NaN,B=Number.NaN,V=Number.NaN,M=Number.NaN,R=0,U=Number.NaN,X=Number.NaN,W=Number.NaN,L=Number.NaN,Y=Number.NaN,K=Number.NaN,q=Number.NaN,Z=Number.NaN,J=0,H=0,Q=!1,$=!1,ee=null,te=null,ne=null,re=null,ie=null;for(;3!==n.nextToken();){const t=n.currentString();if(n.nextToken(),"spatialReference"===t){if(a&&!o){o=!0,1===n.currentToken()?re=_(n):10!==n.currentToken()&&(0,r.t)("failed to parse spatial reference: object or null is expected");continue}}else if(i)if("hasZ"===t){if(!u){u=!0,Q=11===n.currentToken();continue}}else if("hasM"===t){if(!m){m=!0,$=11===n.currentToken();continue}}else if("rings"===t){if(!(c||d||e!==r.G.enumUnknown&&e!==r.G.enumPolygon)){c=!0,({geometry:ie,as:ee,bs:te}=f(!0,!1,0,n));continue}}else if("curveRings"===t){if(!d&&(e===r.G.enumUnknown||e===r.G.enumPolygon)){d=!0,({geometry:ie,as:ee,bs:te}=f(!0,!0,0,n));continue}}else if("paths"===t){if(!(h||g||e!==r.G.enumUnknown&&e!==r.G.enumPolyline)){h=!0,({geometry:ie,as:ee,bs:te}=f(!1,!1,0,n));continue}}else if("curvePaths"===t){if(!g&&(e===r.G.enumUnknown||e===r.G.enumPolyline)){g=!0,({geometry:ie,as:ee,bs:te}=f(!1,!0,0,n));continue}}else if("points"===t){if(!T&&(e===r.G.enumUnknown||e===r.G.enumMultiPoint)){T=!0,({geometry:ie,as:ee,bs:te}=p(0,n));continue}}else if("ids"===t){if(!l){l=!0,ne=k(0,n);continue}}else if("x"===t){if(!N&&(e===r.G.enumUnknown||e===r.G.enumPoint)){N=!0,P=b(n);continue}}else if("y"===t){if(!v&&(e===r.G.enumUnknown||e===r.G.enumPoint)){v=!0,B=b(n);continue}}else if("z"===t){if(!x&&(e===r.G.enumUnknown||e===r.G.enumPoint)){x=!0,V=b(n);continue}}else if("m"===t){if(!A&&(e===r.G.enumUnknown||e===r.G.enumPoint)){A=!0,M=b(n);continue}}else if("id"===t){if(!S&&(e===r.G.enumUnknown||e===r.G.enumPoint)){S=!0,R=y(n);continue}}else if("xmin"===t){if(!w&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){w=!0,U=b(n);continue}}else if("ymin"===t){if(!C&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){C=!0,X=b(n);continue}}else if("mmin"===t){if(!I&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){I=!0,q=b(n);continue}}else if("zmin"===t){if(!j&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){j=!0,Y=b(n);continue}}else if("idmin"===t){if(!E&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){E=!0,J=y(n);continue}}else if("xmax"===t){if(!D&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){D=!0,W=b(n);continue}}else if("ymax"===t){if(!F&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){F=!0,L=b(n);continue}}else if("mmax"===t){if(!z&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){z=!0,Z=b(n);continue}}else if("zmax"===t){if(!O&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){O=!0,K=b(n);continue}}else if("idmax"===t){if(!G&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){G=!0,H=y(n);continue}}else"materials"===t&&(0,r.g)(0);n.skipChildren()}if(c||d||h||g||T){let e=null,t=null;const n=ie;Q&&(ie.addAttribute(1),e=ee,e||(e=(0,s.ax)(n.getPointCount(),Number.NaN))),$&&(ie.addAttribute(2),t=Q?te:ee),null!=ne&&ie.addAttribute(3),Q&&null!=e&&n.setAttributeStreamRef(1,e),$&&null!=t&&n.setAttributeStreamRef(2,t),null!=ne&&function(e,t){if(e.isEmpty())return;const n=(0,s.aC)(2,0),i=e.getGeometryType();let a=0;i===s.M.type?a=1:i===s.h.type||i===s.g.type?a=e.getPathCount():(0,r.a)("not implemented"),n.resize(e.getPointCount(),0);let o=0;for(let u=0;u<a;++u){const a=t.read(o);o++;const m=o+a;let l=0,c=0;i===s.M.type?l=e.getPointCount():i===s.h.type||i===s.g.type?(l=e.getPathSize(u),c=e.getPathStart(u)):(0,r.a)("not implemented");for(let e=0,r=Math.min(a,l);e<r;++e)n.write(c,t.read(o)),o++,c++;o=m}e.getImpl().setAttributeStreamRef(3,n)}(n,ne)}else if(N||v||A||x||S){(0,s.ay)(P,B)||(0,r.t)("failed to parse point: x and y must be finite or nan"),(Number.isNaN(B)||Number.isNaN(P))&&(P=Number.NaN,B=Number.NaN);const e=new s.P({x:P,y:B});x&&e.setZ(V),A&&e.setM(M),S&&e.setID(R),ie=e}else if(w||C||D||F||j||O||I||z||E||G){(Number.isNaN(X)||Number.isNaN(W)||Number.isNaN(L))&&(U=Number.NaN);const e=new s.E({xmin:U,ymin:X,xmax:W,ymax:L});j&&O&&e.setInterval(1,0,Y,K),I&&z&&e.setInterval(2,0,q,Z),E&&G&&e.setInterval(3,0,J,H),ie=e}return{...ie?{geom:ie}:{},...re?{sr:re}:{}}}(t,0,l,i,o);return new a.a7(c)}importProjectionTransformation(e,t){return(0,r.g)(0),{}}importDatumTransformation(e,t){return(0,r.g)(0),{}}static stringToGeometryType(e){return r.G.enumPoint}};function oe(e){return Array.isArray(e)?e[0].spatialReference:e.spatialReference}function ue(e,t){const n=new c(e,{strict:!1});return n.nextToken(),se.execute(0,r.G.enumUnknown,n,!0,t)}function me(e){let t=null;return[e.map((e=>{if(null==t){const n=le(e);return t=n.getSpatialReference(),n.getGeometry()}return ce(e)})),t]}function le(e){return ue(e,!0)}function ce(e){return ue(e,!1).getGeometry()}function de(e,t){return e instanceof a.a7&&(t=e.getSpatialReference(),e=e.getGeometry()),ie.reset(),ae.execute(0,e,t,ie),ie.getObject()}}}]);