"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[3543,7367],{71163:(e,n,t)=>{t.d(n,{C:()=>c});var r=t(29953);let a,o,i=!1;function l(){return a??=(0,r.ho)("arcadeGeometryOperatorsWorker").then((e=>{o=e,i=!0,a=void 0}))}async function c(e,n){return i?o.apply("invokeGeometryOp",[e,n]):(await l(),c(e,n))}},80672:(e,n,t)=>{t.d(n,{R:()=>a});var r=t(20655);function a(e,n){return null===e?n:new r.A({url:e.field("url")})}},87367:(e,n,t)=>{t.r(n),t.d(n,{registerFunctions:()=>T});var r=t(47609),a=t(66395),o=t(85935),i=t(78502),l=t(78878),c=t(80672),s=t(81844),u=t(71163),f=t(4576),d=t(5443),w=t(91075),p=t(48526),h=t(86738),y=t(39829),g=t(82799),m=t(65864),v=t(20655),S=t(70333),b=t(78888);async function D(e,n,t){const r=S.id?.findCredential(e.restUrl);if(!r)return null;if("loaded"===e.loadStatus&&""===n&&e.user?.sourceJSON&&!1===t)return e.user.sourceJSON;const a={responseType:"json",query:{f:"json"}};if(t&&(a.query.returnUserLicenseTypeExtensions=!0),""===n){const n=await(0,b.A)(e.restUrl+"/community/self",a);if(n.data){const e=n.data;if(e?.username)return e}return null}const o=await(0,b.A)(e.restUrl+"/community/users/"+n,a);if(o.data){const e=o.data;return e.error?null:e}return null}var A=t(54218);function X(e){if(null==e)return e;switch(typeof e){case"string":case"number":return e;default:throw new o.D$(null,o.TX.InvalidParameter,null)}}function T(e){"async"===e.mode&&(e.functions.disjoint=function(n,t){return e.standardFunctionAsync(n,t,((e,r,a)=>(a=(0,l.C)(a),(0,s.ZL)(a,n,t),null===a[0]||null===a[1]||(0,u.C)("disjoint",[a[0].toJSON(),a[1].toJSON()]))))},e.functions.intersects=function(n,t){return e.standardFunctionAsync(n,t,((e,r,a)=>(a=(0,l.C)(a),(0,s.ZL)(a,n,t),null!==a[0]&&null!==a[1]&&(0,u.C)("intersects",[a[0].toJSON(),a[1].toJSON()]))))},e.functions.touches=function(n,t){return e.standardFunctionAsync(n,t,((e,r,a)=>(a=(0,l.C)(a),(0,s.ZL)(a,n,t),null!==a[0]&&null!==a[1]&&(0,u.C)("touches",[a[0].toJSON(),a[1].toJSON()]))))},e.functions.crosses=function(n,t){return e.standardFunctionAsync(n,t,((e,r,a)=>(a=(0,l.C)(a),(0,s.ZL)(a,n,t),null!==a[0]&&null!==a[1]&&(0,u.C)("crosses",[a[0].toJSON(),a[1].toJSON()]))))},e.functions.within=function(n,t){return e.standardFunctionAsync(n,t,((e,r,a)=>(a=(0,l.C)(a),(0,s.ZL)(a,n,t),null!==a[0]&&null!==a[1]&&(0,u.C)("within",[a[0].toJSON(),a[1].toJSON()]))))},e.functions.contains=function(n,t){return e.standardFunctionAsync(n,t,((e,r,a)=>(a=(0,l.C)(a),(0,s.ZL)(a,n,t),null!==a[0]&&null!==a[1]&&(0,u.C)("contains",[a[0].toJSON(),a[1].toJSON()]))))},e.functions.overlaps=function(n,t){return e.standardFunctionAsync(n,t,((e,r,a)=>(a=(0,l.C)(a),(0,s.ZL)(a,n,t),null!==a[0]&&null!==a[1]&&(0,u.C)("overlaps",[a[0].toJSON(),a[1].toJSON()]))))},e.functions.equals=function(n,t){return e.standardFunctionAsync(n,t,((e,r,a)=>((0,l.B)(a,2,2,n,t),a[0]===a[1]||(a[0]instanceof w.A&&a[1]instanceof w.A?(0,u.C)("equals",[a[0].toJSON(),a[1].toJSON()]):((0,l.e)(a[0])&&(0,l.e)(a[1])||!!((0,l.g)(a[0])&&(0,l.g)(a[1])||(0,l.f)(a[0])&&(0,l.f)(a[1])))&&a[0].equals(a[1])))))},e.functions.relate=function(n,t){return e.standardFunctionAsync(n,t,((e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,3,3,n,t),a[0]instanceof w.A&&a[1]instanceof w.A)return(0,u.C)("relate",[a[0].toJSON(),a[1].toJSON(),(0,l.w)(a[2])]);if(a[0]instanceof w.A&&null===a[1])return!1;if(a[1]instanceof w.A&&null===a[0])return!1;if(null===a[0]&&null===a[1])return!1;throw new o.D$(n,o.TX.InvalidParameter,t)}))},e.functions.intersection=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>(a=(0,l.C)(a),(0,s.ZL)(a,n,t),null===a[0]||null===a[1]?null:(0,m.rS)(await(0,u.C)("intersection",[a[0].toJSON(),a[1].toJSON()])))))},e.functions.union=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(0===(a=(0,l.C)(a)).length)throw new o.D$(n,o.TX.WrongNumberOfParameters,t);const c=[];if(1===a.length)if((0,A.cy)(a[0])){for(const e of(0,l.C)(a[0]))if(null!==e){if(!(e instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);c.push(e.toJSON())}}else{if(!(0,l.j)(a[0])){if(a[0]instanceof w.A)return(0,l.D)((0,i.Yq)(a[0]),n.spatialReference);if(null===a[0])return null;throw new o.D$(n,o.TX.InvalidParameter,t)}for(const e of(0,l.C)(a[0].toArray()))if(null!==e){if(!(e instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);c.push(e.toJSON())}}else for(const e of a)if(null!==e){if(!(e instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);c.push(e.toJSON())}return 0===c.length?null:(0,m.rS)(await(0,u.C)("union",[c]))}))},e.functions.difference=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>(a=(0,l.C)(a),(0,s.ZL)(a,n,t),null===a[0]?null:null===a[1]?(0,i.Yq)(a[0]):(0,m.rS)(await(0,u.C)("difference",[a[0].toJSON(),a[1].toJSON()])))))},e.functions.symmetricdifference=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>(a=(0,l.C)(a),(0,s.ZL)(a,n,t),null===a[0]&&null===a[1]?null:null===a[0]?(0,i.Yq)(a[1]):null===a[1]?(0,i.Yq)(a[0]):(0,m.rS)(await(0,u.C)("symmetricDifference",[a[0].toJSON(),a[1].toJSON()])))))},e.functions.clip=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,2,2,n,t),!(a[1]instanceof d.A)&&null!==a[1])throw new o.D$(n,o.TX.InvalidParameter,t);if(null===a[0])return null;if(!(a[0]instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);return null===a[1]?null:(0,m.rS)(await(0,u.C)("clip",[a[0].toJSON(),a[1].toJSON()]))}))},e.functions.cut=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,2,2,n,t),!(a[1]instanceof g.A)&&null!==a[1])throw new o.D$(n,o.TX.InvalidParameter,t);if(null===a[0])return[];if(!(a[0]instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);return null===a[1]?[(0,i.Yq)(a[0])]:(await(0,u.C)("cut",[a[0].toJSON(),a[1].toJSON()])).map((e=>(0,m.rS)(e)))}))},e.functions.area=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if((0,l.B)(a,1,2,n,t),a=(0,l.C)(a),(0,l.m)(a[0])){const e=await a[0].sumArea(X(a[1]),null,n.abortSignal);if(n.abortSignal.aborted)throw new o.D$(n,o.TX.Cancelled,t);return e}let i=a[0];if(((0,A.cy)(i)||(0,l.j)(i))&&(i=(0,l.E)(a[0],n.spatialReference)),null===i)return 0;if(!(i instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);return(0,u.C)("area",[i.toJSON(),X(a[1])])}))},e.functions.areageodetic=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{(0,l.B)(a,1,3,n,t);let i=(a=(0,l.C)(a))[0];((0,A.cy)(i)||(0,l.j)(i))&&(i=(0,l.E)(i,n.spatialReference));const c=X(a[1]),f=(0,s.rE)(a[2]);if((0,l.m)(i)){const e=await i.sumArea(c,f,n.abortSignal);if(n.abortSignal.aborted)throw new o.D$(n,o.TX.Cancelled,t);return e}if(null==i)return 0;if(!(0,l.h)(i))throw new o.D$(n,o.TX.InvalidParameter,t);return(0,u.C)("geodeticArea",[i.toJSON(),c,f])}))},e.functions.length=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if((0,l.B)(a,1,2,n,t),a=(0,l.C)(a),(0,l.m)(a[0])){const e=await a[0].sumLength(X(a[1]),null,n.abortSignal);if(n.abortSignal.aborted)throw new o.D$(n,o.TX.Cancelled,t);return e}let i=a[0];if(((0,A.cy)(a[0])||(0,l.j)(a[0]))&&(i=(0,l.F)(a[0],n.spatialReference)),null===i)return 0;if(!(i instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);return(0,u.C)("length",[i.toJSON(),X(a[1])])}))},e.functions.length3d=function(n,r){return e.standardFunctionAsync(n,r,(async(e,a,i)=>{if((0,l.B)(i,1,2,n,r),null===(i=(0,l.C)(i))[0])return 0;let c=i[0];if(((0,A.cy)(i[0])||(0,l.j)(i[0]))&&(c=(0,l.F)(i[0],n.spatialReference)),null===c)return 0;if(!(c instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,r);if(!0===c.hasZ){const{convertFromSpatialReferenceUnit:e,toLengthUnit:n}=await Promise.resolve().then(t.bind(t,40547)),r=(0,s.UI)(c);return e(c.spatialReference,n(i[1]),r)}return(0,u.C)("length",[c.toJSON(),X(i[1])])}))},e.functions.lengthgeodetic=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{(0,l.B)(a,1,3,n,t);let i=(a=(0,l.C)(a))[0];((0,A.cy)(a[0])||(0,l.j)(a[0]))&&(i=(0,l.F)(a[0],n.spatialReference));const c=X(a[1]),f=(0,s.rE)(a[2]);if((0,l.m)(i)){const e=await i.sumLength(c,f,n.abortSignal);if(n.abortSignal.aborted)throw new o.D$(n,o.TX.Cancelled,t);return e}if(null===i)return 0;if(!(0,l.h)(i))throw new o.D$(n,o.TX.InvalidParameter,t);return(0,u.C)("geodeticLength",[i.toJSON(),c,f])}))},e.functions.distance=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{a=(0,l.C)(a),(0,l.B)(a,2,3,n,t);let i=a[0];if(((0,A.cy)(a[0])||(0,l.j)(a[0]))&&(i=(0,l.G)(a[0],n.spatialReference)),!(i instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);let c=a[1];if(((0,A.cy)(a[1])||(0,l.j)(a[1]))&&(c=(0,l.G)(a[1],n.spatialReference)),!(c instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);return(0,u.C)("distance",[i.toJSON(),c.toJSON(),X(a[2])])}))},e.functions.distancegeodetic=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{a=(0,l.C)(a),(0,l.B)(a,2,4,n,t);const i=a[0];if(!(i instanceof h.A))throw new o.D$(n,o.TX.InvalidParameter,t);const c=a[1];if(!(c instanceof h.A))throw new o.D$(n,o.TX.InvalidParameter,t);const f=new g.A({paths:[],spatialReference:i.spatialReference});return f.addPath([i,c]),(0,u.C)("geodeticLength",[f.toJSON(),X(a[2]),(0,s.rE)(a[3])])}))},e.functions.densify=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,2,3,n,t),null===a[0])return null;if(!(a[0]instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);const i=(0,l.u)(a[1]);if(isNaN(i))throw new o.D$(n,o.TX.InvalidParameter,t);if(i<=0)throw new o.D$(n,o.TX.InvalidParameter,t);switch(a[0].type){case"polygon":case"polyline":case"extent":return(0,m.rS)(await(0,u.C)("densify",[a[0].toJSON(),i,X(a[2])]));default:return a[0]}}))},e.functions.densifygeodetic=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{a=(0,l.C)(a),(0,l.B)(a,2,4,n,t);const i=a[0];if(null==i)return null;if(!(0,l.h)(i))throw new o.D$(n,o.TX.InvalidParameter,t);const c=(0,l.u)(a[1]);if(isNaN(c))throw new o.D$(n,o.TX.InvalidParameter,t);if(c<=0)throw new o.D$(n,o.TX.InvalidParameter,t);const f=X(a[2]),d=(0,s.rE)(a[3]);switch(i.type){case"polygon":case"polyline":case"extent":return(0,m.rS)(await(0,u.C)("geodeticDensify",[i.toJSON(),c,f,d]));default:return i}}))},e.functions.generalize=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,2,4,n,t),null===a[0])return null;if(!(a[0]instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);const i=(0,l.u)(a[1]);if(isNaN(i))throw new o.D$(n,o.TX.InvalidParameter,t);const c=(0,l.H)((0,l.J)(a[2],!0));return(0,m.rS)(await(0,u.C)("generalize",[a[0].toJSON(),i,X(a[3]),{removeDegenerateParts:c}]))}))},e.functions.buffer=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,2,3,n,t),null===a[0])return null;if(!(a[0]instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);const c=(0,l.u)(a[1]);if(isNaN(c))throw new o.D$(n,o.TX.InvalidParameter,t);return 0===c?(0,i.Yq)(a[0]):(0,m.rS)(await(0,u.C)("buffer",[a[0].toJSON(),c,X(a[2])]))}))},e.functions.buffergeodetic=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{a=(0,l.C)(a),(0,l.B)(a,2,4,n,t);const c=a[0];if(null==c)return null;if(!(0,l.h)(c))throw new o.D$(n,o.TX.InvalidParameter,t);const f=(0,l.u)(a[1]);if(isNaN(f))throw new o.D$(n,o.TX.InvalidParameter,t);if(0===f)return(0,i.Yq)(c);const d=X(a[2]),w=(0,s.rE)(a[3]);return(0,m.rS)(await(0,u.C)("geodesicBuffer",[c.toJSON(),f,d,w]))}))},e.functions.offset=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,2,6,n,t),null===a[0])return null;if(!(a[0]instanceof y.A||a[0]instanceof g.A))throw new o.D$(n,o.TX.InvalidParameter,t);const i=(0,l.u)(a[1]);if(isNaN(i))throw new o.D$(n,o.TX.InvalidParameter,t);const c=(0,s.R$)(a[3]),f=(0,l.u)((0,l.J)(a[4],10));if(isNaN(f))throw new o.D$(n,o.TX.InvalidParameter,t);const d=(0,l.u)((0,l.J)(a[5],0));if(isNaN(d))throw new o.D$(n,o.TX.InvalidParameter,t);return(0,m.rS)(await(0,u.C)("offset",[a[0].toJSON(),i,X(a[2]),{joins:c,miterLimit:f,flattenError:d}]))}))},e.functions.rotate=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,2,3,n,t),null===a[0])return null;if(!(a[0]instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);const i=a[0]instanceof d.A?y.A.fromExtent(a[0]):a[0],c=(0,l.u)(a[1]);if(isNaN(c))throw new o.D$(n,o.TX.InvalidParameter,t);const s=(0,l.J)(a[2],null);if(null===s){const e="point"===i.type?i:i.extent?.center;return(0,m.rS)(await(0,u.C)("rotate",[i.toJSON(),c,e?.x,e?.y]))}if(s instanceof h.A)return(0,m.rS)(await(0,u.C)("rotate",[i.toJSON(),c,s.x,s.y]));throw new o.D$(n,o.TX.InvalidParameter,t)}))},e.functions.centroid=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,1,2,n,t),null===a[0])return null;const i=(0,s.Hz)(a[1]);let c=a[0];if(((0,A.cy)(a[0])||(0,l.j)(a[0]))&&(c="geometric"===i?(0,l.G)(a[0],n.spatialReference):(0,l.E)(a[0],n.spatialReference),null===c))return null;if(!(c instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);return(0,m.rS)("geometric"===i?await(0,u.C)("centroid",[c.toJSON()]):await(0,u.C)("labelPoint",[c.toJSON()]))}))},e.functions.measuretocoordinate=function(n,t){return e.standardFunctionAsync(n,t,s.Cd)},e.functions.pointtocoordinate=function(n,t){return e.standardFunctionAsync(n,t,s.kr)},e.functions.distancetocoordinate=function(n,t){return e.standardFunctionAsync(n,t,s.Bn)},e.functions.multiparttosinglepart=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,1,1,n,t),null===a[0])return null;if(!(a[0]instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);if(a[0]instanceof h.A)return[(0,l.D)((0,i.Yq)(a[0]),n.spatialReference)];if(a[0]instanceof d.A)return[(0,l.D)((0,i.Yq)(a[0]),n.spatialReference)];const c=(0,m.rS)(await(0,u.C)("simplify",[a[0].toJSON()]));if(c instanceof y.A){const e=[],n=[];for(let t=0;t<c.rings.length;t++)if(c.isClockwise(c.rings[t])){const n=(0,m.rS)({rings:[c.rings[t]],hasZ:!0===c.hasZ,hasM:!0===c.hasM,spatialReference:c.spatialReference.toJSON()});e.push(n)}else n.push({ring:c.rings[t],pt:c.getPoint(t,0)});for(let t=0;t<n.length;t++)for(let r=0;r<e.length;r++)if(e[r].contains(n[t].pt)){e[r].addRing(n[t].ring);break}return e}if(c instanceof g.A){const e=[];for(let n=0;n<c.paths.length;n++){const t=(0,m.rS)({paths:[c.paths[n]],hasZ:!0===c.hasZ,hasM:!0===c.hasM,spatialReference:c.spatialReference.toJSON()});e.push(t)}return e}if(a[0]instanceof p.A){const e=[],t=(0,l.D)((0,i.Yq)(a[0]),n.spatialReference);for(let n=0;n<t.points.length;n++)e.push(t.getPoint(n));return e}return null}))},e.functions.isselfintersecting=function(n,t){return e.standardFunctionAsync(n,t,(async(e,n,t)=>{(0,l.B)(t,1,1,e,n);let r=(t=(0,l.C)(t))[0];if(((0,A.cy)(t[0])||(0,l.j)(t[0]))&&(r=(0,l.F)(t[0],e.spatialReference)),r instanceof p.A){const e=r.points;for(let n=0;n<e.length;n++)for(let t=n+1;t<e.length;t++)if((0,f.aI)(e[n],e[t]))return!0;return!1}return(r instanceof g.A||r instanceof y.A)&&await(0,u.C)("isSelfIntersecting",[r.toJSON()])}))},e.functions.issimple=function(n,t){return e.standardFunctionAsync(n,t,((e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,1,1,n,t),null===a[0])return!0;if(!(a[0]instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);return(0,u.C)("isSimple",[a[0].toJSON()])}))},e.functions.simplify=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,1,1,n,t),null===a[0])return null;if(!(a[0]instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);return(0,m.rS)(await(0,u.C)("simplify",[a[0].toJSON()]))}))},e.functions.convexhull=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,a)=>{if(a=(0,l.C)(a),(0,l.B)(a,1,1,n,t),null===a[0])return null;if(!(a[0]instanceof w.A))throw new o.D$(n,o.TX.InvalidParameter,t);return(0,m.rS)(await(0,u.C)("convexHull",[a[0].toJSON()]))}))},e.functions.getuser=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,s)=>{(0,l.B)(s,0,2,n,t);let u=(0,l.J)(s[1],""),f=!0===u;if(u=!0===u||!1===u?"":(0,l.w)(u),0===s.length||s[0]instanceof r.A){let e;e=n.services?.portal?n.services.portal:v.A.getDefault(),s.length>0&&(e=(0,c.R)(s[0],e));const t=await D(e,u,f);if(t){const e=JSON.parse(JSON.stringify(t));for(const n of["lastLogin","created","modified"])void 0!==e[n]&&null!==e[n]&&(e[n]=new Date(e[n]));return a.A.convertObjectToArcadeDictionary(e,(0,l.K)(n))}return null}let d=null;if((0,l.m)(s[0])&&(d=s[0]),d){if(f=!1,u)return null;await d.load();const e=await d.getOwningSystemUrl();if(!e){if(!u){const e=await d.getIdentityUser();return e?a.A.convertObjectToArcadeDictionary({username:e},(0,l.K)(n)):null}return null}let t;t=n.services?.portal?n.services.portal:v.A.getDefault(),t=(0,c.R)(new r.A(e),t);const o=await D(t,u,f);if(o){const e=JSON.parse(JSON.stringify(o));for(const n of["lastLogin","created","modified"])void 0!==e[n]&&null!==e[n]&&(e[n]=new Date(e[n]));return a.A.convertObjectToArcadeDictionary(e,(0,l.K)(n))}return null}throw new o.D$(n,o.TX.InvalidParameter,t)}))},e.functions.nearestcoordinate=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,i)=>{if(i=(0,l.C)(i),(0,l.B)(i,2,2,n,t),!(i[0]instanceof w.A||null===i[0]))throw new o.D$(n,o.TX.InvalidParameter,t);if(!(i[1]instanceof h.A||null===i[1]))throw new o.D$(n,o.TX.InvalidParameter,t);if(null===i[0]||null===i[1])return null;const c=i[0]instanceof d.A?y.A.fromExtent(i[0]):i[0],s=await(0,u.C)("getNearestCoordinate",[c.toJSON(),i[1].toJSON(),{calculateLeftRightSide:!0}]);return null===s?null:a.A.convertObjectToArcadeDictionary({coordinate:(0,m.rS)(s.coordinate),distance:s.distance,sideOfLine:0===s.distance?"straddle":s.isRightSide?"right":"left"},(0,l.K)(n),!1,!0)}))},e.functions.nearestvertex=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,i)=>{if(i=(0,l.C)(i),(0,l.B)(i,2,2,n,t),!(i[0]instanceof w.A||null===i[0]))throw new o.D$(n,o.TX.InvalidParameter,t);if(!(i[1]instanceof h.A||null===i[1]))throw new o.D$(n,o.TX.InvalidParameter,t);if(null===i[0]||null===i[1])return null;const c=i[0]instanceof d.A?y.A.fromExtent(i[0]):i[0],s=await(0,u.C)("getNearestVertex",[c.toJSON(),i[1].toJSON()]);return null===s?null:a.A.convertObjectToArcadeDictionary({coordinate:(0,m.rS)(s.coordinate),distance:s.distance,sideOfLine:0===s.distance?"straddle":s.isRightSide?"right":"left"},(0,l.K)(n),!1,!0)}))})}},93543:(e,n,t)=>{t.r(n),t.d(n,{executeScript:()=>_,extend:()=>W});var r=t(48938),a=t(99719),o=t(72888),i=t(15695),l=t(66395),c=t(85935),s=t(93833),u=t(92400),f=t(78878),d=t(19157),w=t(3367),p=t(63680),h=t(81113),y=t(32091),g=t(87367),m=t(41217),v=t(36770),S=t(47346),b=t(29304),D=(t(44208),t(91075)),A=t(16930),X=t(54218);async function T(e,n){const t=[];for(let r=0;r<n.arguments.length;r++)t.push(await F(e,n.arguments[r]));return t}async function $(e,n,t){return!0===n.preparsed?t(e,null,n.arguments):t(e,n,await T(e,n))}class C extends u.fF{constructor(e,n){super(),this.definition=null,this.context=null,this.definition=e,this.context=n}createFunction(e){return(...n)=>{const t={spatialReference:this.context.spatialReference,console:this.context.console,lrucache:this.context.lrucache,timeZone:this.context.timeZone??null,exports:this.context.exports,libraryResolver:this.context.libraryResolver,interceptor:this.context.interceptor,services:this.context.services,abortSignal:this.context.abortSignal,localScope:{},depthCounter:{depth:e.depthCounter+1},globalScope:this.context.globalScope};if(t.depthCounter.depth>64)throw new c.D$(e,c.TX.MaximumCallDepth,null);return N(this.definition,t,n,null)}}call(e,n){return I(e,n,((t,r,a)=>{const o={spatialReference:e.spatialReference,services:e.services,console:e.console,libraryResolver:e.libraryResolver,exports:e.exports,lrucache:e.lrucache,timeZone:e.timeZone??null,interceptor:e.interceptor,localScope:{},abortSignal:e.abortSignal,globalScope:e.globalScope,depthCounter:{depth:e.depthCounter.depth+1}};if(o.depthCounter.depth>64)throw new c.D$(e,c.TX.MaximumCallDepth,n);return N(this.definition,o,a,n)}))}marshalledCall(e,n,t,r){return r(e,n,(async(a,o,i)=>{const l={spatialReference:e.spatialReference,services:e.services,globalScope:t.globalScope,depthCounter:{depth:e.depthCounter.depth+1},libraryResolver:e.libraryResolver,exports:e.exports,console:e.console,abortSignal:e.abortSignal,lrucache:e.lrucache,timeZone:e.timeZone??null,interceptor:e.interceptor,localScope:{}};return i=i.map((n=>!(0,f.i)(n)||n instanceof u.CU?n:(0,u.o6)(n,e,r))),(0,u.o6)(await N(this.definition,l,i,n),t,r)}))}}async function N(e,n,t,a){const o=e.body;if(t.length!==e.params.length)throw new c.D$(n,c.TX.WrongNumberOfParameters,null);for(let a=0;a<t.length;a++){const o=e.params[a];"Identifier"===o.type&&null!=n.localScope&&(n.localScope[(0,r.X)(o)]={value:t[a]})}const i=await x(n,o);if(i instanceof f.R)return i.value;if(i===f.q)throw new c.D$(n,c.TX.UnexpectedToken,a);if(i===f.r)throw new c.D$(n,c.TX.UnexpectedToken,a);return i instanceof f.I?i.value:i}class O extends a.x{constructor(e){super(),this.source=e}global(e){const n=this.executingContext.globalScope[(0,r.X)(e)];if((0,f.i)(n.value)&&!(n.value instanceof u.CU)){const t=new u.CU;return t.fn=n.value,t.parameterEvaluator=I,t.context=this.executingContext,this.executingContext.globalScope[(0,r.X)(e)]={value:t},t}return n.value}setGlobal(e,n){if((0,f.i)(n))throw new c.D$(null,c.TX.AssignModuleFunction,null);this.executingContext.globalScope[(0,r.X)(e)]={value:n}}hasGlobal(e){return void 0===this.executingContext.exports[e]&&(e=(0,r.X)(e)),void 0!==this.executingContext.exports[e]}async loadModule(e){const n=e.spatialReference??A.A.WebMercator;this.moduleScope=Y(null,null,e.timeZone),this.executingContext={spatialReference:n,services:e.services,libraryResolver:new o.a(e.libraryResolver._moduleSingletons,this.source.syntax.loadedModules),exports:{},abortSignal:e.abortSignal??r._,globalScope:this.moduleScope,console:e.console??V,lrucache:e.lrucache,timeZone:e.timeZone??null,interceptor:e.interceptor,localScope:null,depthCounter:{depth:1}},await k(this.executingContext,this.source.syntax)}}async function I(e,n,t){return!0===n.preparsed?t(e,null,n.arguments):t(e,n,await T(e,n))}async function F(e,n){n.breakpoint&&await n.breakpoint();try{switch(n.type){case"UpdateExpression":return await async function(e,n){const t=n.argument;if("CallExpression"===t.type)throw new c.D$(e,c.TX.NeverReach,n);if("MemberExpression"===t.type){const r=await F(e,t.object);let a,o;if(!0===t.computed)a=await F(e,t.property);else{if("Identifier"!==t.property.type)throw new c.D$(e,c.TX.Unrecognized,n);a=t.property.name}if((0,X.cy)(r)){if(!(0,X.Et)(a))throw new c.D$(e,c.TX.ArrayAccessorMustBeNumber,n);if(a<0&&(a=r.length+a),a<0||a>=r.length)throw new c.D$(e,c.TX.OutOfBounds,n);o=(0,f.u)(r[a]),r[a]="++"===n.operator?o+1:o-1}else if(r instanceof l.A){if(!1===(0,X.Kg)(a))throw new c.D$(e,c.TX.KeyAccessorMustBeString,n);if(!0!==r.hasField(a))throw new c.D$(e,c.TX.FieldNotFound,n,{key:a});o=(0,f.u)(r.field(a)),r.setField(a,"++"===n.operator?o+1:o-1)}else if(r instanceof O){if(!1===(0,X.Kg)(a))throw new c.D$(e,c.TX.ModuleAccessorMustBeString,n);if(!0!==r.hasGlobal(a))throw new c.D$(e,c.TX.ModuleExportNotFound,n);o=(0,f.u)(r.global(a)),r.setGlobal(a,"++"===n.operator?o+1:o-1)}else{if(!(0,f.k)(r))throw(0,f.j)(r)?new c.D$(e,c.TX.Immutable,n):new c.D$(e,c.TX.InvalidParameter,n);if(!1===(0,X.Kg)(a))throw new c.D$(e,c.TX.KeyAccessorMustBeString,n);if(!0!==r.hasField(a))throw new c.D$(e,c.TX.FieldNotFound,n,{key:a});o=(0,f.u)(r.field(a)),r.setField(a,"++"===n.operator?o+1:o-1)}return!1===n.prefix?o:"++"===n.operator?o+1:o-1}const a=(0,r.X)(t);let o;if(null!=e.localScope&&void 0!==e.localScope[a])return o=(0,f.u)(e.localScope[a].value),e.localScope[a]={value:"++"===n.operator?o+1:o-1},!1===n.prefix?o:"++"===n.operator?o+1:o-1;if(void 0!==e.globalScope[a])return o=(0,f.u)(e.globalScope[a].value),e.globalScope[a]={value:"++"===n.operator?o+1:o-1},!1===n.prefix?o:"++"===n.operator?o+1:o-1;throw new c.D$(e,c.TX.InvalidIdentifier,n)}(e,n);case"AssignmentExpression":return await async function(e,n){const t=n.left;if("MemberExpression"===t.type){const r=await F(e,t.object);let a;if(!0===t.computed)a=await F(e,t.property);else{if("Identifier"!==t.property.type)throw new c.D$(e,c.TX.InvalidIdentifier,n);a=t.property.name}const o=await F(e,n.right);if((0,X.cy)(r)){if(!(0,X.Et)(a))throw new c.D$(e,c.TX.ArrayAccessorMustBeNumber,n);if(a<0&&(a=r.length+a),a<0||a>r.length)throw new c.D$(e,c.TX.OutOfBounds,n);if(a===r.length){if("="!==n.operator)throw new c.D$(e,c.TX.OutOfBounds,n);r[a]=B(o,n.operator,r[a],n,e)}else r[a]=B(o,n.operator,r[a],n,e)}else if(r instanceof l.A){if(!1===(0,X.Kg)(a))throw new c.D$(e,c.TX.KeyAccessorMustBeString,n);if(!0===r.hasField(a))r.setField(a,B(o,n.operator,r.field(a),n,e));else{if("="!==n.operator)throw new c.D$(e,c.TX.FieldNotFound,n,{key:a});r.setField(a,B(o,n.operator,null,n,e))}}else if(r instanceof O){if(!1===(0,X.Kg)(a))throw new c.D$(e,c.TX.KeyAccessorMustBeString,n);if(!0!==r.hasGlobal(a))throw new c.D$(e,c.TX.ModuleExportNotFound,n);r.setGlobal(a,B(o,n.operator,r.global(a),n,e))}else{if(!(0,f.k)(r))throw(0,f.j)(r)?new c.D$(e,c.TX.Immutable,n):new c.D$(e,c.TX.InvalidParameter,n);if(!1===(0,X.Kg)(a))throw new c.D$(e,c.TX.KeyAccessorMustBeString,n);if(!0===r.hasField(a))r.setField(a,B(o,n.operator,r.field(a),n,e));else{if("="!==n.operator)throw new c.D$(e,c.TX.FieldNotFound,n,{key:a});r.setField(a,B(o,n.operator,null,n,e))}}return f.v}const a=(0,r.X)(t);if(null!=e.localScope&&void 0!==e.localScope[a]){const t=await F(e,n.right);return e.localScope[a]={value:B(t,n.operator,e.localScope[a].value,n,e)},f.v}if(void 0!==e.globalScope[a]){const t=await F(e,n.right);return e.globalScope[a]={value:B(t,n.operator,e.globalScope[a].value,n,e)},f.v}throw new c.D$(e,c.TX.InvalidIdentifier,n)}(e,n);case"TemplateLiteral":return await async function(e,n){let t="",r=0;for(const a of n.quasis)if(t+=a.value?a.value.cooked:"",!1===a.tail){if(n.expressions[r]){const a=await F(e,n.expressions[r]);if((0,f.i)(a))throw new c.D$(e,c.TX.NoFunctionInTemplateLiteral,n);t+=(0,f.w)(a)}r++}return t}(e,n);case"Identifier":return j(e,n);case"MemberExpression":return await async function(e,n){const t=await F(e,n.object);if(null===t)throw new c.D$(e,c.TX.MemberOfNull,n);if(!1===n.computed){if("Identifier"===n.property.type){if(t instanceof l.A||(0,f.s)(t))return t.field(n.property.name);if(t instanceof D.A)return(0,i.Bl)(t,n.property.name,e,n);if(t instanceof O){if(!t.hasGlobal(n.property.name))throw new c.D$(e,c.TX.InvalidIdentifier,n);return t.global(n.property.name)}throw new c.D$(e,c.TX.InvalidMemberAccessKey,n)}throw new c.D$(e,c.TX.InvalidMemberAccessKey,n)}let r=await F(e,n.property);if(t instanceof l.A||(0,f.s)(t)){if((0,X.Kg)(r))return t.field(r);throw new c.D$(e,c.TX.InvalidMemberAccessKey,n)}if(t instanceof O){if((0,X.Kg)(r))return t.global(r);throw new c.D$(e,c.TX.InvalidMemberAccessKey,n)}if(t instanceof D.A){if((0,X.Kg)(r))return(0,i.Bl)(t,r,e,n);throw new c.D$(e,c.TX.InvalidMemberAccessKey,n)}if((0,X.cy)(t)){if((0,X.Et)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length+r),r>=t.length||r<0)throw new c.D$(e,c.TX.OutOfBounds,n);return t[r]}throw new c.D$(e,c.TX.InvalidMemberAccessKey,n)}if((0,f.j)(t)){if((0,X.Et)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length()+r),r>=t.length()||r<0)throw new c.D$(e,c.TX.OutOfBounds,n);return t.get(r)}throw new c.D$(e,c.TX.InvalidMemberAccessKey,n)}if((0,X.Kg)(t)){if((0,X.Et)(r)&&isFinite(r)&&Math.floor(r)===r){if(r<0&&(r=t.length+r),r>=t.length||r<0)throw new c.D$(e,c.TX.OutOfBounds,n);return t[r]}throw new c.D$(e,c.TX.InvalidMemberAccessKey,n)}throw new c.D$(e,c.TX.InvalidMemberAccessKey,n)}(e,n);case"Literal":return n.value;case"CallExpression":return await async function(e,n){if("MemberExpression"===n.callee.type){const t=await F(e,n.callee.object);if(!(t instanceof O))throw new c.D$(e,c.TX.FunctionNotFound,n);const r=!1===n.callee.computed?n.callee.property.name:await F(e,n.callee.property);if(!t.hasGlobal(r))throw new c.D$(e,c.TX.FunctionNotFound,n);const a=t.global(r);if(!(0,f.i)(a))throw new c.D$(e,c.TX.CallNonFunction,n);return a.call(e,n)}if("Identifier"!==n.callee.type)throw new c.D$(e,c.TX.FunctionNotFound,n);const t=(0,r.X)(n.callee);if(null!=e.localScope&&void 0!==e.localScope[t]){const r=e.localScope[t];if((0,f.i)(r.value))return r.value.call(e,n);throw new c.D$(e,c.TX.CallNonFunction,n)}if(void 0!==e.globalScope[t]){const r=e.globalScope[t];if((0,f.i)(r.value))return r.value.call(e,n);throw new c.D$(e,c.TX.CallNonFunction,n)}throw new c.D$(e,c.TX.FunctionNotFound,n)}(e,n);case"UnaryExpression":return await async function(e,n){const t=await F(e,n.argument);if((0,X.Lm)(t)){if("!"===n.operator)return!t;if("-"===n.operator)return-1*(0,f.u)(t);if("+"===n.operator)return 1*(0,f.u)(t);if("~"===n.operator)return~(0,f.u)(t);throw new c.D$(e,c.TX.UnsupportedUnaryOperator,n)}if("-"===n.operator)return-1*(0,f.u)(t);if("+"===n.operator)return 1*(0,f.u)(t);if("~"===n.operator)return~(0,f.u)(t);throw new c.D$(e,c.TX.UnsupportedUnaryOperator,n)}(e,n);case"BinaryExpression":return await async function(e,n){const t=await F(e,n.left),r=await F(e,n.right);switch(n.operator){case"|":case"<<":case">>":case">>>":case"^":case"&":return(0,f.z)((0,f.u)(t),(0,f.u)(r),n.operator);case"==":return(0,f.y)(t,r);case"!=":return!(0,f.y)(t,r);case"<":case">":case"<=":case">=":return(0,f.x)(t,r,n.operator);case"+":return(0,X.Kg)(t)||(0,X.Kg)(r)?(0,f.w)(t)+(0,f.w)(r):(0,f.u)(t)+(0,f.u)(r);case"-":return(0,f.u)(t)-(0,f.u)(r);case"*":return(0,f.u)(t)*(0,f.u)(r);case"/":return(0,f.u)(t)/(0,f.u)(r);case"%":return(0,f.u)(t)%(0,f.u)(r);default:throw new c.D$(e,c.TX.UnsupportedOperator,n)}}(e,n);case"LogicalExpression":return await async function(e,n){const t=await F(e,n.left);if(!(0,X.Lm)(t))throw new c.D$(e,c.TX.LogicalExpressionOnlyBoolean,n);switch(n.operator){case"||":{if(!0===t)return t;const r=await F(e,n.right);if((0,X.Lm)(r))return r;throw new c.D$(e,c.TX.LogicExpressionOrAnd,n)}case"&&":{if(!1===t)return t;const r=await F(e,n.right);if((0,X.Lm)(r))return r;throw new c.D$(e,c.TX.LogicExpressionOrAnd,n)}default:throw new c.D$(e,c.TX.LogicExpressionOrAnd,n)}}(e,n);case"ArrayExpression":return await async function(e,n){const t=[];for(let r=0;r<n.elements.length;r++)t.push(await F(e,n.elements[r]));for(let r=0;r<t.length;r++){if((0,f.i)(t[r]))throw new c.D$(e,c.TX.NoFunctionInArray,n);t[r]===f.v&&(t[r]=null)}return t}(e,n);case"ObjectExpression":return await async function(e,n){const t=[];for(let r=0;r<n.properties.length;r++){const a=n.properties[r],o=await F(e,a.value),i="Identifier"===a.key.type?a.key.name:await F(e,a.key);t[r]={key:i,value:o}}const r=Object.create(null),a=new Map;for(let o=0;o<t.length;o++){const i=t[o];if((0,f.i)(i.value))throw new c.D$(e,c.TX.NoFunctionInDictionary,n);if(!1===(0,X.Kg)(i.key))throw new c.D$(e,c.TX.KeyMustBeString,n);let l=i.key.toString();const s=l.toLowerCase();a.has(s)?l=a.get(s):a.set(s,l),i.value===f.v?r[l]=null:r[l]=i.value}const o=new l.A(r);return o.immutable=!1,o}(e,n);default:throw new c.D$(e,c.TX.Unrecognized,n)}}catch(t){throw(0,c.Nh)(e,n,t)}}async function x(e,n){n.breakpoint&&await n.breakpoint();try{switch(n.type){case"ImportDeclaration":return await async function(e,n){const t=(0,r.X)(n.specifiers[0].local),a=e.libraryResolver.loadLibrary(t);let o;return e.libraryResolver._moduleSingletons?.has(a.uri)?o=e.libraryResolver._moduleSingletons.get(a.uri):(o=new O(a),await o.loadModule(e),e.libraryResolver._moduleSingletons?.set(a.uri,o)),e.globalScope[t]={value:o},f.v}(e,n);case"ExportNamedDeclaration":return await async function(e,n){if(await x(e,n.declaration),"FunctionDeclaration"===n.declaration.type)e.exports[(0,r.X)(n.declaration.id)]="function";else if("VariableDeclaration"===n.declaration.type)for(const t of n.declaration.declarations)e.exports[(0,r.X)(t.id)]="variable";return f.v}(e,n);case"VariableDeclaration":return await E(e,n,0);case"BlockStatement":return await k(e,n);case"FunctionDeclaration":return await async function(e,n){const t=(0,r.X)(n.id);return e.globalScope[t]={value:new C(n,e)},f.v}(e,n);case"ReturnStatement":return await async function(e,n){if(null===n.argument)return new f.R(f.v);const t=await F(e,n.argument);return new f.R(t)}(e,n);case"IfStatement":return await async function(e,n){const t=await F(e,n.test);if(!0===t)return x(e,n.consequent);if(!1===t)return null!==n.alternate?x(e,n.alternate):f.v;throw new c.D$(e,c.TX.BooleanConditionRequired,n)}(e,n);case"ExpressionStatement":return await async function(e,n){const t=await F(e,n.expression);return t===f.v?f.v:new f.I(t)}(e,n);case"ForStatement":return await async function(e,n){try{for(null!==n.init&&("VariableDeclaration"===n.init.type?await x(e,n.init):await F(e,n.init));;){if(null!==n.test){const t=await F(e,n.test);if(!0===e.abortSignal?.aborted)throw new c.D$(e,c.TX.Cancelled,n);if(!1===t)break;if(!0!==t)throw new c.D$(e,c.TX.BooleanConditionRequired,n)}const t=await x(e,n.body);if(t===f.q)break;if(t instanceof f.R)return t;null!==n.update&&await F(e,n.update)}return f.v}catch(e){throw e}}(e,n);case"WhileStatement":return await async function(e,n){let t=await F(e,n.test);if(!1===t)return f.v;if(!0!==t)throw new c.D$(e,c.TX.BooleanConditionRequired,n);for(;!0===t;){const r=await x(e,n.body);if(r===f.q)break;if(r instanceof f.R)return r;if(t=await F(e,n.test),!0!==t&&!1!==t)throw new c.D$(e,c.TX.BooleanConditionRequired,n)}return f.v}(e,n);case"ForInStatement":return await async function(e,n){const t=await F(e,n.right);"VariableDeclaration"===n.left.type&&await x(e,n.left);const a=(0,r.X)("VariableDeclaration"===n.left.type?n.left.declarations[0].id:n.left);let o=null;if(null!=e.localScope&&void 0!==e.localScope[a]&&(o=e.localScope[a]),null===o&&void 0!==e.globalScope[a]){const n=e.globalScope[a].value;o=e.globalScope[a]={value:n}}if(null===o)throw new c.D$(e,c.TX.InvalidIdentifier,n);return(0,X.cy)(t)||(0,X.Kg)(t)?await R(e,n,t,o):(0,f.j)(t)?await J(e,n,t,o):t instanceof l.A||(0,f.s)(t)?await R(e,n,t.keys(),o,"k"):(0,f.m)(t)?await P(e,n,t,o):(0,f.h)(t)?await R(e,n,(0,i.T)(t),o,"k"):f.v}(e,n);case"ForOfStatement":return await async function(e,n){const t=await F(e,n.right);"VariableDeclaration"===n.left.type&&await x(e,n.left);const a=(0,r.X)("VariableDeclaration"===n.left.type?n.left.declarations[0].id:n.left);let o=null;if(null!=e.localScope&&void 0!==e.localScope[a]&&(o=e.localScope[a]),null===o&&void 0!==e.globalScope[a]){const n=e.globalScope[a].value;o=e.globalScope[a]={value:n}}if(null===o)throw new c.D$(e,c.TX.InvalidIdentifier,n);return(0,X.cy)(t)||(0,X.Kg)(t)?await R(e,n,t,o,"k"):(0,f.j)(t)?await J(e,n,t,o,"k"):t instanceof l.A||(0,f.s)(t)?await async function(e,n,t,r){for(const a of t.keys()){const o=t.field(a);r.value=l.A.containerEntry(a,o);const i=await x(e,n.body);if(i===f.q)break;if(i instanceof f.R)return i}return f.v}(e,n,t,o):(0,f.m)(t)?await P(e,n,t,o):(0,f.h)(t)?await async function(e,n,t,r){for(const a of(0,i.T)(t)){const o=(0,i.Bl)(t,a,e,n,1);r.value=l.A.containerEntry(a,o);const c=await x(e,n.body);if(c===f.q)break;if(c instanceof f.R)return c}return f.v}(e,n,t,o):f.v}(e,n);case"BreakStatement":return f.q;case"EmptyStatement":return f.v;case"ContinueStatement":return f.r;default:throw new c.D$(e,c.TX.Unrecognized,n)}}catch(t){throw(0,c.Nh)(e,n,t)}}async function R(e,n,t,r,a="i"){const o=t.length;for(let i=0;i<o;i++){if("k"===a){if(i>=t.length)throw new c.D$(e,c.TX.OutOfBounds,n);r.value=t[i]}else r.value=i;const o=await x(e,n.body);if(o===f.q)break;if(o instanceof f.R)return o}return f.v}async function J(e,n,t,r,a="i"){const o=t.length();for(let i=0;i<o;i++){r.value="k"===a?t.get(i):i;const o=await x(e,n.body);if(o===f.q)break;if(o instanceof f.R)return o}return f.v}async function P(e,n,t,r){const a=t.iterator(e.abortSignal);let o;for(;null!=(o=await a.next());){const a=s.A.createFromGraphicLikeObject(o.geometry,o.attributes,t,e.timeZone);a._underlyingGraphic=o,r.value=a;const i=await x(e,n.body);if(i===f.q)break;if(i instanceof f.R)return i}return f.v}function B(e,n,t,r,a){switch(n){case"=":return e===f.v?null:e;case"/=":return(0,f.u)(t)/(0,f.u)(e);case"*=":return(0,f.u)(t)*(0,f.u)(e);case"-=":return(0,f.u)(t)-(0,f.u)(e);case"+=":return(0,X.Kg)(t)||(0,X.Kg)(e)?(0,f.w)(t)+(0,f.w)(e):(0,f.u)(t)+(0,f.u)(e);case"%=":return(0,f.u)(t)%(0,f.u)(e);default:throw new c.D$(a,c.TX.UnsupportedOperator,r)}}async function k(e,n){return M(e,n,0)}async function M(e,n,t){if(t>=n.body.length)return f.v;const r=await x(e,n.body[t]);return r instanceof f.R||r===f.q||r===f.r||t===n.body.length-1?r:M(e,n,t+1)}async function E(e,n,t){return t>=n.declarations.length||(await async function(e,n){let t=null;if(t=null===n.init?null:await F(e,n.init),null!==e.localScope){if(t===f.v&&(t=null),"Identifier"!==n.id.type)throw new c.D$(e,c.TX.InvalidIdentifier,n);const a=(0,r.X)(n.id);return void(null!=e.localScope&&(e.localScope[a]={value:t}))}if("Identifier"!==n.id.type)throw new c.D$(e,c.TX.InvalidIdentifier,n);const a=(0,r.X)(n.id);t===f.v&&(t=null),e.globalScope[a]={value:t}}(e,n.declarations[t]),t===n.declarations.length-1||await E(e,n,t+1)),f.v}function j(e,n){const t=(0,r.X)(n);if(null!=e.localScope&&void 0!==e.localScope[t])return e.localScope[t].value;if(void 0!==e.globalScope[t])return e.globalScope[t].value;throw new c.D$(e,c.TX.InvalidIdentifier,n)}async function L(e,n){(0,f.B)(null===n.arguments?[]:n.arguments,3,3,e,n);const t=await F(e,n.arguments[0]);if(!1===(0,X.Lm)(t))throw new c.D$(e,c.TX.BooleanConditionRequired,n);return F(e,t?n.arguments[1]:n.arguments[2])}async function K(e,n){(0,f.B)(null===n.arguments?[]:n.arguments,2,3,e,n);const t=await F(e,n.arguments[0]);if(3===n.arguments.length){const r=await F(e,n.arguments[1]),a=(0,i.jd)(t,r);return null!=a&&""!==a?a:F(e,n.arguments[2])}return null==t||""===t?F(e,n.arguments[1]):t}async function q(e,n){if(n.arguments.length<2)throw new c.D$(e,c.TX.WrongNumberOfParameters,n);if(2===n.arguments.length)return F(e,n.arguments[1]);if((n.arguments.length-1)%2==0)throw new c.D$(e,c.TX.WrongNumberOfParameters,n);return U(e,n,1,await F(e,n.arguments[0]))}async function U(e,n,t,r){const a=await F(e,n.arguments[t]);if((0,f.y)(a,r))return F(e,n.arguments[t+1]);const o=n.arguments.length-t;return 1===o?F(e,n.arguments[t]):2===o?null:3===o?F(e,n.arguments[t+2]):U(e,n,t+2,r)}async function Z(e,n){if(n.arguments.length<3)throw new c.D$(e,c.TX.WrongNumberOfParameters,n);if(n.arguments.length%2==0)throw new c.D$(e,c.TX.WrongNumberOfParameters,n);const t=await F(e,n.arguments[0]);if(!1===(0,X.Lm)(t))throw new c.D$(e,c.TX.BooleanConditionRequired,n.arguments[0]);return G(e,n,0,t)}async function G(e,n,t,r){if(!0===r)return F(e,n.arguments[t+1]);if(3===n.arguments.length-t)return F(e,n.arguments[t+2]);const a=await F(e,n.arguments[t+2]);if(!1===(0,X.Lm)(a))throw new c.D$(e,c.TX.ModuleExportNotFound,n.arguments[t+2]);return G(e,n,t+2,a)}const z=function(){const e=Object.create(null);(0,h.d)(e,$),(0,b.d)(e,$),(0,y.d)(e,$,j),(0,v.d)(e,$),(0,m.d)(e,$),(0,S.d)(e,$),(0,g.registerFunctions)({functions:e,compiled:!1,signatures:null,evaluateIdentifier:null,mode:"async",standardFunction:$,standardFunctionAsync:I}),e.iif=L,e.defaultvalue=K,e.decode=q,e.when=Z;const n=function(){this.textformatting={value:l.A.textFormatting()}};(n.prototype=Object.create(null)).infinity=Object.freeze({value:Number.POSITIVE_INFINITY}),n.prototype.pi=Object.freeze({value:Math.PI});for(const[t,r]of Object.entries(e))n.prototype[t]=Object.freeze({value:new u.UQ(r)});return n}();function W(e){const n={mode:"async",compiled:!1,functions:Object.create(null),signatures:[],standardFunction:$,standardFunctionAsync:I,evaluateIdentifier:j};for(let t=0;t<e.length;t++)e[t].registerFunctions(n);for(const[e,t]of Object.entries(n.functions))z.prototype[e]=Object.freeze({value:new u.UQ(t)});for(let e=0;e<n.signatures.length;e++)(0,d.WC)(n.signatures[e],"async")}function Y(e,n,t){const r=new z;null==e&&(e={}),null==n&&(n={});for(const e in n)r[e]={value:new u.UQ(n[e])};for(const n in e)r[n]={value:(0,X.DU)(e[n])?s.A.createFromGraphic(e[n],t):e[n]};return r}function V(e){console.log(e)}async function _(e,n){const t=n.spatialReference??A.A.WebMercator;let a=null;e.usesModules&&(a=new o.a(new Map,e.loadedModules));const i=Y(n.vars,n.customfunctions,n.timeZone),l={spatialReference:t,services:n.services,exports:{},libraryResolver:a,abortSignal:n.abortSignal??r._,globalScope:i,console:n.console??V,timeZone:n.timeZone??null,lrucache:n.lrucache,interceptor:n.interceptor,localScope:null,depthCounter:{depth:1}},s=await k(l,e);if(s instanceof f.R||s instanceof f.I){const e=s.value;if((0,f.A)(e))return null;if((0,f.i)(e))throw new c.D$(l,c.TX.IllegalResult,null);return e}if((0,f.A)(s))return null;if(s===f.q)throw new c.D$(l,c.TX.IllegalResult,null);if(s===f.r)throw new c.D$(l,c.TX.IllegalResult,null);throw new c.D$(l,c.TX.NeverReach,null)}W([p.A]),W([w.A])}}]);