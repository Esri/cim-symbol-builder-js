"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[7146],{25929:(e,t,r)=>{r.d(t,{M:()=>m,a:()=>d,e:()=>h,f:()=>n,i:()=>c,p:()=>p,r:()=>i,t:()=>a,w:()=>u});var s=r(17452);function n(e,t){const r=t?.url?.path;if(e&&r&&(e=(0,s.hF)(e,r,{preserveProtocolRelative:!0}),t.portalItem&&t.readResourcePaths)){const r=(0,s.PF)(e,t.portalItem.itemUrl);null!=r&&l.test(r)&&t.readResourcePaths.push(t.portalItem.resourceFromPath(r).path)}return f(e,t?.portal)}function a(e,t,r=m.YES){if(null==e)return e;!(0,s.YP)(e)&&t?.blockedRelativeUrls&&t.blockedRelativeUrls.push(e);let n=(0,s.hF)(e);if(t){const r=t.verifyItemRelativeUrls?.rootPath||t.url?.path;if(r){const a=f(r,t.portal),i=f(n,t.portal);n=(0,s.PF)(i,a,a),null!=n&&n!==i&&n!==e&&t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.writtenUrls.push(n)}}return n=h(n,t?.portal),(0,s.YP)(n)&&(n=(0,s.Fv)(n)),t?.resources&&t?.portalItem&&!(0,s.YP)(n)&&!(0,s.HK)(n)&&r===m.YES&&t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(n),compress:!1}),n}function i(e,t,r){return n(e,r)}function u(e,t,r,s){const n=a(e,s);void 0!==n&&(t[r]=n)}const o=/\/items\/([^\/]+)\/resources\/(.*)/,l=/^\.\/resources\//;function c(e){const t=e?.match(o)??null;return t?.[1]??null}function p(e){const t=e?.match(o)??null;if(null==t)return null;const r=t[2],n=r.lastIndexOf("/");if(-1===n){const{path:e,extension:t}=(0,s.fZ)(r);return{prefix:null,filename:e,extension:t}}const{path:a,extension:i}=(0,s.fZ)(r.slice(n+1));return{prefix:r.slice(0,n),filename:a,extension:i}}function h(e,t){return t&&!t.isPortal&&t.urlKey&&t.customBaseUrl?(0,s.Ie)(e,`${t.urlKey}.${t.customBaseUrl}`,t.portalHostname):e}function f(e,t){if(!t||t.isPortal||!t.urlKey||!t.customBaseUrl)return e;const r=`${t.urlKey}.${t.customBaseUrl}`,n=(0,s.TI)();return(0,s.D6)(n,`${n.scheme}://${r}`)?(0,s.Ie)(e,t.portalHostname,r):(0,s.Ie)(e,r,t.portalHostname)}var m,y;(y=m||(m={}))[y.YES=0]="YES",y[y.NO=1]="NO";const d=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return m},ensureMainOnlineDomain:h,fromJSON:n,itemIdFromResourceUrl:c,prefixAndFilenameFromResourceUrl:p,read:i,toJSON:a,write:u},Symbol.toStringTag,{value:"Module"}))},43230:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});var s=r(66643),n=r(20102),a=r(92604),i=r(95330),u=r(8744),o=r(98732),l=r(28972),c=r(37427),p=r(3489),h=r(92722),f=r(23095),m=r(78089),y=r(99514),d=r(25031);class g{constructor(){this._queryEngine=null,this._customParameters=null}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}async load(e,t){const{getFeatureUrl:r,getFeatureOutputFormat:s,fields:a,geometryType:u,featureType:o,objectIdField:h,customParameters:f}=e,{spatialReference:g,getFeatureSpatialReference:_}=(0,m.fU)(r,o,e.spatialReference);this._featureType=o,this._customParameters=f,this._getFeatureUrl=r,this._getFeatureOutputFormat=s,this._getFeatureSpatialReference=_;try{await(0,c._W)(_,g)}catch{throw new n.Z("unsupported-projection","Projection not supported",{inSpatialReference:_,outSpatialReference:g})}(0,i.k_)(t);const w=y.Z.fromLayerJSON({fields:a,dateFieldsTimeReference:a.some((e=>"esriFieldTypeDate"===e.type))?{timeZoneIANA:d.pt}:null}),S=await this._snapshotFeatures({fieldsIndex:w,geometryType:u,objectIdField:h,spatialReference:g},t.signal);return this._queryEngine=new p.q({fieldsIndex:w,geometryType:u,hasM:!1,hasZ:!1,objectIdField:h,spatialReference:g,timeInfo:null,featureStore:new l.Z({geometryType:u,hasM:!1,hasZ:!1})}),this._queryEngine.featureStore.addMany(S),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async applyEdits(){throw new n.Z("wfs-source:editing-not-supported","applyEdits() is not supported on WFSLayer")}async queryFeatures(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForIds(e,t.signal)}async queryExtent(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e,t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForSnapping(e,t.signal)}async refresh(e){return this._customParameters=e,this._snapshotTask?.abort(),this._snapshotTask=(0,s.vr)((e=>this._snapshotFeatures(this._queryEngine,e))),this._snapshotTask.promise.then((e=>{this._queryEngine.featureStore.clear(),e&&this._queryEngine.featureStore.addMany(e)}),(e=>{this._queryEngine.featureStore.clear(),(0,i.D_)(e)||a.Z.getLogger("esri.layers.WFSLayer").error(new n.Z("wfs-layer:getfeature-error","An error occurred during the GetFeature request",{error:e}))})),await this._waitSnapshotComplete(),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _snapshotFeatures({objectIdField:e,geometryType:t,spatialReference:r,fieldsIndex:s},n){const a=await(0,m.Bm)(this._getFeatureUrl??"",this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,signal:n});(0,h.O3)(a,this._getFeatureSpatialReference.wkid),(0,i.k_)(n);const l=(0,h.lG)(a,{geometryType:t,hasZ:!1,objectIdField:e});if(!(0,u.fS)(r,this._getFeatureSpatialReference))for(const e of l)null!=e.geometry&&(e.geometry=(0,o.GH)((0,c.iV)((0,o.di)(e.geometry,t,!1,!1),this._getFeatureSpatialReference,r)));let p=1;for(const t of l){const r={};(0,f.O0)(s,r,t.attributes,!0),t.attributes=r,null==r[e]&&(t.objectId=r[e]=p++)}return l}}},66677:(e,t,r)=>{r.d(t,{B5:()=>c,DR:()=>h,G:()=>w,M8:()=>y,Nm:()=>d,Qc:()=>p,XG:()=>g,a7:()=>m,ld:()=>f,wH:()=>_});var s=r(17452),n=r(25929);const a={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},i=Object.values(a),u=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${i.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),o=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${i.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),l=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function c(e){return!!u.test(e)}function p(e){if(null==e)return null;const t=(0,s.mN)(e),r=t?.path.match(u)||t?.path.match(o);if(!r)return null;const[,n,i,l,c]=r,p=i.indexOf("/");return{title:f(-1!==p?i.slice(p+1):i),serverType:a[l.toLowerCase()],sublayer:null!=c&&""!==c?parseInt(c,10):null,url:{path:n}}}function h(e){const t=(0,s.mN)(e).path.match(l);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function f(e){return(e=e.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function m(e,t){const r=[];if(e){const t=p(e);null!=t&&t.title&&r.push(t.title)}if(t){const e=f(t);r.push(e)}if(2===r.length){if(r[0].toLowerCase().includes(r[1].toLowerCase()))return r[0];if(r[1].toLowerCase().includes(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function y(e){if(!e)return!1;const t=(e=e.toLowerCase()).includes(".arcgis.com/"),r=e.includes("//services")||e.includes("//tiles")||e.includes("//features");return t&&r}function d(e,t){return e?(0,s.Qj)((0,s.Hu)(e,t)):e}function g(e){let{url:t}=e;if(!t)return{url:t};t=(0,s.Hu)(t,e.logger);const r=(0,s.mN)(t),n=p(r.path);let a;if(null!=n)null!=n.sublayer&&null==e.layer.layerId&&(a=n.sublayer),t=n.url.path;else if(e.nonStandardUrlAllowed){const e=h(r.path);null!=e&&(t=e.serviceUrl,a=e.sublayerId)}return{url:(0,s.Qj)(t),layerId:a}}function _(e,t,r,a,i){(0,n.w)(t,a,"url",i),a.url&&null!=e.layerId&&(a.url=(0,s.v_)(a.url,r,e.layerId.toString()))}function w(e){if(!e)return!1;const t=e.toLowerCase(),r=t.includes("/services/"),s=t.includes("/mapserver/wmsserver"),n=t.includes("/imageserver/wmsserver"),a=t.includes("/wmsserver");return r&&(s||n||a)}}}]);