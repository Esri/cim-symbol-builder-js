"use strict";(globalThis.webpackChunkmy_app=globalThis.webpackChunkmy_app||[]).push([[28675],{28675:(e,t,i)=>{i.d(t,{D:()=>p,previewCIMSymbol:()=>w});var l=i(76931),n=i(401),a=i(6840),o=i(48988),r=i(97763),s=i(65709),h=i(26291);const c=new a.CIMSymbolRasterizer(null),y=(0,l.PN)(s.CB.size),m=(0,l.PN)(s.CB.maxSize),u=(0,l.PN)(s.CB.lineWidth),g=1;async function d(e,t,i){const l=t?.size;let n=null!=l&&"object"==typeof l&&"width"in l?l.width:l,a=null!=l&&"object"==typeof l&&"height"in l?l.height:l;if(!n||!a)if("esriGeometryPolygon"===i)n=a=t.maxSize?Math.min(t.maxSize,y):y;else{const l=await p(e,t,i);l&&(n=l.width,a=l.height),"esriGeometryPolyline"===i&&(n=t.maxSize?Math.min(t.maxSize,u):u),n=null!=n&&isFinite(n)?Math.min(n,m):y,a=null!=a&&isFinite(a)?Math.max(Math.min(a,m),g):y}return"legend"===t.style&&"esriGeometryPolyline"===i&&(n=u),{width:n,height:a}}async function p(e,t={},i){const l=t.cimOptions||t;i??=l.geometryType||(0,r.n5)(e?.data?.symbol);const{feature:a,fieldMap:s,viewParams:h}=l,y=await o.OverrideHelper.resolveSymbolOverrides(e.data,a,null,s,i,null,h);if(!y)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:y},e.data.primitiveOverrides=void 0;const m=[];return n.wp.fetchResources(y,c.resourceManager,m),n.wp.fetchFonts(y,c.resourceManager,m),m.length>0&&await Promise.all(m),n.wp.getEnvelope(y,null,c.resourceManager)}async function w(e,t={}){const{node:i,opacity:n,symbolConfig:a}=t,o=null!=a&&"object"==typeof a&&"isSquareFill"in a&&a.isSquareFill,s=t.cimOptions||t,y=s.geometryType||(0,r.n5)(e?.data?.symbol),m=await d(e,t,y),{feature:u,fieldMap:g}=s,p=t?.geometry||o||"esriGeometryPolygon"!==y?"preview":"legend";let w=m;const f=m;if(t?.geometry&&("esriGeometryPolygon"===y||"esriGeometryPolyline"===y)){const e=200;if((0,l.Lz)(m.width)<e||(0,l.Lz)(m.height)<e){const t=m.width>m.height?(0,l.PN)(e)*m.height/m.width:(0,l.PN)(e);w={width:m.width>m.height?(0,l.PN)(e):(0,l.PN)(e)*m.width/m.height,height:t}}}const b=await c.rasterizeCIMSymbolAsync(e,u,w,p,g,y,null,s.viewParams,s.allowScalingUp,t?.geometry?.toJSON());if(!b)return null;const{width:P,height:z}=b,M=document.createElement("canvas");M.width=P,M.height=z,M.getContext("2d").putImageData(b,0,0);const S=(0,l.Lz)(f.width),v=(0,l.Lz)(f.height),C=new Image(S,v);C.src=M.toDataURL(),C.ariaLabel=t.ariaLabel??null,C.alt=t.ariaLabel??"",null!=n&&(C.style.opacity=`${n}`);let x=C;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:S,height:v,src:C.src},fill:null,stroke:null,offset:[0,0]};x=(0,h.fz)([[e]],[S,v],t)}return i&&x&&i.appendChild(x),x}}}]);
//# sourceMappingURL=28675.ae86a1d4.chunk.js.map