"use strict";(globalThis.webpackChunkmy_app=globalThis.webpackChunkmy_app||[]).push([[39513],{52007:(e,t,r)=>{r.d(t,{a:()=>o,f:()=>a,n:()=>s});var n=r(78393);function s(e,t){o(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function o(e,t,r=2,s=r){const o=t.length/2;let a=0,i=0;if(!(0,n.iu)(t)||(0,n.dk)(t)){for(let n=0;n<o;++n)e[a]=t[i],e[a+1]=t[i+1],a+=r,i+=s;return}const l=(0,n.a3)(t);if((0,n.JI)(t))for(let n=0;n<o;++n)e[a]=Math.max(t[i]/l,-1),e[a+1]=Math.max(t[i+1]/l,-1),a+=r,i+=s;else for(let n=0;n<o;++n)e[a]=t[i]/l,e[a+1]=t[i+1]/l,a+=r,i+=s}function a(e,t,r,n){const s=e.typedBuffer,o=e.typedBufferStride,a=n?.count??e.count;let i=(n?.dstIndex??0)*o;for(let l=0;l<a;++l)s[i]=t,s[i+1]=r,i+=o}Object.freeze(Object.defineProperty({__proto__:null,fill:a,normalizeIntegerBuffer:o,normalizeIntegerBufferView:s},Symbol.toStringTag,{value:"Module"}))},93795:(e,t,r)=>{function n(e){return e=e||globalThis.location.hostname,u.some((t=>null!=e?.match(t)))}function s(e,t){return e?(t=t||globalThis.location.hostname)?null!=t.match(o)||null!=t.match(i)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(a)||null!=t.match(l)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e:null}r.d(t,{EM:()=>s,b5:()=>n});const o=/^devext\.arcgis\.com$/,a=/^qaext\.arcgis\.com$/,i=/^[\w-]*\.mapsdevext\.arcgis\.com$/,l=/^[\w-]*\.mapsqa\.arcgis\.com$/,u=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,o,a,/^jsapps\.esri\.com$/,i,l]},11109:(e,t,r)=>{r.d(t,{R:()=>l});var n=r(3825),s=r(98773),o=r(50076),a=r(50346),i=r(90534);class l{constructor(e){this._streamDataRequester=e}async loadJSON(e,t){return this._load("json",e,t)}async loadBinary(e,t){return(0,i.DB)(e)?((0,a.Te)(t),(0,i.lJ)(e)):this._load("binary",e,t)}async loadImage(e,t){return this._load("image",e,t)}async _load(e,t,r){if(null==this._streamDataRequester)return(await(0,n.A)(t,{responseType:u[e]})).data;const i=await(0,s.Ke)(this._streamDataRequester.request(t,e,r));if(!0===i.ok)return i.value;throw(0,a.QP)(i.error),new o.A("glt-loader-request-error",`Request for resource failed: ${i.error}`)}}const u={image:"image",binary:"array-buffer",json:"json","image+type":void 0}},54439:(e,t,r)=>{r.d(t,{G:()=>a});var n=r(44680),s=r(59422),o=r(63919);function a(e){if(null==e)return null;const t=null!=e.offset?e.offset:s.uY,r=null!=e.rotation?e.rotation:0,a=null!=e.scale?e.scale:s.Un,i=(0,n.fA)(1,0,0,0,1,0,t[0],t[1],1),l=(0,n.fA)(Math.cos(r),-Math.sin(r),0,Math.sin(r),Math.cos(r),0,0,0,1),u=(0,n.fA)(a[0],0,0,0,a[1],0,0,0,1),c=(0,n.vt)();return(0,o.lw)(c,l,u),(0,o.lw)(c,i,c),c}},420:(e,t,r)=>{r.d(t,{x:()=>a});var n=r(78393),s=r(38496),o=r(93345);function a(e,t){switch(t){case o.WR.TRIANGLES:return"number"==typeof(r=e)?(0,s.tM)(r):(0,n.mg)(r)?new Uint16Array(r):r;case o.WR.TRIANGLE_STRIP:return function(e){const t="number"==typeof e?e:e.length;if(t<3)return[];const r=t-2,n=(0,s.my)(3*r);if("number"==typeof e){let e=0;for(let t=0;t<r;t+=1)t%2==0?(n[e++]=t,n[e++]=t+1,n[e++]=t+2):(n[e++]=t+1,n[e++]=t,n[e++]=t+2)}else{let t=0;for(let s=0;s<r;s+=1)s%2==0?(n[t++]=e[s],n[t++]=e[s+1],n[t++]=e[s+2]):(n[t++]=e[s+1],n[t++]=e[s],n[t++]=e[s+2])}return n}(e);case o.WR.TRIANGLE_FAN:return function(e){const t="number"==typeof e?e:e.length;if(t<3)return new Uint16Array(0);const r=t-2,n=r<=65536?new Uint16Array(3*r):new Uint32Array(3*r);if("number"==typeof e){let e=0;for(let t=0;t<r;++t)n[e++]=0,n[e++]=t+1,n[e++]=t+2;return n}const s=e[0];let o=e[1],a=0;for(let i=0;i<r;++i){const t=e[i+2];n[a++]=s,n[a++]=o,n[a++]=t,o=t}return n}(e)}var r}},37040:(e,t,r)=>{r.d(t,{KB:()=>i,Xi:()=>o,pn:()=>l,x3:()=>a});var n=r(81806),s=r(83490);class o{constructor(e){this.data=e,this.type="encoded-mesh-texture",this.encoding=s.JS.KTX2_ENCODING}}function a(e){return"encoded-mesh-texture"===e?.type}async function i(e){const t=new Blob([e]),r=await t.text();return JSON.parse(r)}async function l(e,t){if(t===s.JS.KTX2_ENCODING)return new o(e);const r=new Blob([e],{type:t});let a=URL.createObjectURL(r);switch(t){case"image/jpeg":a+="#.jpg";break;case"image/png":a+="#.png"}const i=new Image;if((0,n.A)("esri-iPhone"))return new Promise(((e,t)=>{const r=()=>{s(),e(i)},n=e=>{s(),t(e)},s=()=>{URL.revokeObjectURL(a),i.removeEventListener("load",r),i.removeEventListener("error",n)};i.addEventListener("load",r),i.addEventListener("error",n),i.src=a}));try{i.src=a,await i.decode()}catch(l){console.warn("Failed decoding HTMLImageElement")}return URL.revokeObjectURL(a),i}},39513:(e,t,r)=>{r.d(t,{fetch:()=>Z});var n=r(99746),s=r(93795),o=r(15941),a=r(63919),i=r(44680),l=r(34761),u=r(13191),c=r(72745),f=r(20664),d=r(9392),m=r(42294),p=r(75002),h=r(88105),g=r(45136),y=r(10947),x=r(52007),w=r(11109),b=r(420),T=r(37040),v=r(54439);class R{constructor(){this.geometries=new Array,this.materials=new Array,this.textures=new Array}}class A{constructor(e,t,r){this.name=e,this.lodThreshold=t,this.pivotOffset=r,this.stageResources=new R,this.numberOfVertices=0}}var B=r(3825),M=r(98773),I=r(50076),S=r(76460),E=r(97255),O=r(75941),P=r(50346),U=r(19898),L=r(38496),k=r(49003),_=r(50468),C=r(83490),q=r(17345),F=r(76632),N=r(66470),G=r(65131),$=r(93345);const j=()=>S.A.getLogger("esri.views.3d.layers.graphics.objectResourceUtils");class D{constructor(e,t,r){this.resource=e,this.textures=t,this.cachedMemory=r}}async function V(e,t){const r=await async function(e,t){const r=t?.streamDataRequester;if(r)return async function(e,t,r){const n=await(0,M.Ke)(t.request(e,"json",r));if(!0===n.ok)return n.value;(0,P.QP)(n.error),W(n.error.details.url)}(e,r,t);const n=await(0,M.Ke)((0,B.A)(e,t));if(!0===n.ok)return n.value.data;(0,P.QP)(n.error),W(n.error)}(e,t),n=await async function(e,t){const r=new Array;for(const o in e){const n=e[o],s=n.images[0].data;if(!s){j().warn("Externally referenced texture data is not yet supported");continue}const a=n.encoding+";base64,"+s,i="/textureDefinitions/"+o,l="rgba"===n.channels?n.alphaChannelUsage||"transparency":"none",u={noUnpackFlip:!0,wrap:{s:$.pF.REPEAT,t:$.pF.REPEAT},preMultiplyAlpha:K(l)!==C.sf.Opaque},c=t?.disableTextures?Promise.resolve(null):(0,k.D)(a,t);r.push(c.then((e=>({refId:i,image:e,parameters:u,alphaChannelUsage:l}))))}const n=await Promise.all(r),s={};for(const o of n)s[o.refId]=o;return s}(r.textureDefinitions??{},t);let s=0;for(const o in n)if(n.hasOwnProperty(o)){const e=n[o];s+=e?.image?e.image.width*e.image.height*4:0}return new D(r,n,s+(0,E.Qh)(r))}function W(e){throw new I.A("",`Request for object resource failed: ${e}`)}function z(e){const t=e.params,r=t.topology;let n=!0;switch(t.vertexAttributes||(j().warn("Geometry must specify vertex attributes"),n=!1),t.topology){case"PerAttributeArray":break;case"Indexed":case null:case void 0:{const e=t.faces;if(e){if(t.vertexAttributes)for(const r in t.vertexAttributes){const t=e[r];t?.values?(null!=t.valueType&&"UInt32"!==t.valueType&&(j().warn(`Unsupported indexed geometry indices type '${t.valueType}', only UInt32 is currently supported`),n=!1),null!=t.valuesPerElement&&1!==t.valuesPerElement&&(j().warn(`Unsupported indexed geometry values per element '${t.valuesPerElement}', only 1 is currently supported`),n=!1)):(j().warn(`Indexed geometry does not specify face indices for '${r}' attribute`),n=!1)}}else j().warn("Indexed geometries must specify faces"),n=!1;break}default:j().warn(`Unsupported topology '${r}'`),n=!1}e.params.material||(j().warn("Geometry requires material"),n=!1);const s=e.params.vertexAttributes;for(const o in s)s[o].values||(j().warn("Geometries with externally defined attributes are not yet supported"),n=!1);return n}function J(e){const t=(0,m.Ie)();return e.forEach((e=>{const r=e.boundingInfo;null!=r&&((0,m.iT)(t,r.bbMin),(0,m.iT)(t,r.bbMax))})),t}function K(e){switch(e){case"mask":return C.sf.Mask;case"maskAndTransparency":return C.sf.MaskBlend;case"none":return C.sf.Opaque;default:return C.sf.Blend}}function Q(e){const t=e.params;return{id:1,material:t.material,texture:t.texture,region:t.texture}}const X=new U.R(1,2,"wosr");var H=r(59046),Y=r(78992);async function Z(e,t){const i=function(e){const t=e.match(/(.*\.(gltf|glb))(\?lod=([0-9]+))?$/);return t?{fileType:"gltf",url:t[1],specifiedLodIndex:null!=t[4]?Number(t[4]):null}:e.match(/(.*\.(json|json\.gz))$/)?{fileType:"wosr",url:e,specifiedLodIndex:null}:{fileType:"unknown",url:e,specifiedLodIndex:null}}((0,s.EM)(e));if("wosr"===i.fileType){const e=await(t.cache?t.cache.loadWOSR(i.url,t):V(i.url,t)),{engineResources:r,referenceBoundingBox:n}=function(e,t){const r=new Array,n=new Array,s=new Array,o=new O.O,a=e.resource,i=U.R.parse(a.version||"1.0","wosr");X.validate(i);const l=a.model.name,u=a.model.geometries,c=a.materialDefinitions??{},f=e.textures;let m=0;const p=new Map;for(let h=0;h<u.length;h++){const e=u[h];if(!z(e))continue;const a=Q(e),i=e.params.vertexAttributes,l=[],g=t=>{if("PerAttributeArray"===e.params.topology)return null;const r=e.params.faces;for(const e in r)if(e===t)return r[e].values;return null},y=i[N.r.POSITION],x=y.values.length/y.valuesPerElement;for(const t in i){const e=i[t],r=e.values,n=g(t)??(0,L.tM)(x);l.push([t,new _.n(r,n,e.valuesPerElement,!0)])}const w=a.texture,b=f&&f[w];if(b&&!p.has(w)){const{image:e,parameters:t}=b,r=new F.g(e,t);n.push(r),p.set(w,r)}const T=p.get(w),v=T?T.id:void 0,R=a.material;let A=o.get(R,w);if(null==A){const e=c[R.slice(R.lastIndexOf("/")+1)].params;1===e.transparency&&(e.transparency=0);const r=b&&b.alphaChannelUsage,n=e.transparency>0||"transparency"===r||"maskAndTransparency"===r,s=b?K(b.alphaChannelUsage):void 0,a={ambient:(0,d.ci)(e.diffuse),diffuse:(0,d.ci)(e.diffuse),opacity:1-(e.transparency||0),transparent:n,textureAlphaMode:s,textureAlphaCutoff:.33,textureId:v,doubleSided:!0,cullFace:C.s2.None,colorMixMode:e.externalColorMixMode||"tint",textureAlphaPremultiplied:b?.parameters.preMultiplyAlpha??!1};t?.materialParameters&&Object.assign(a,t.materialParameters),A=new G.$U(a,t),o.set(R,w,A)}s.push(A);const B=new q.V(A,l);m+=l.find((e=>e[0]===N.r.POSITION))?.[1]?.indices.length??0,r.push(B)}return{engineResources:[{name:l,stageResources:{textures:n,materials:s,geometries:r},pivotOffset:a.model.pivotOffset,numberOfVertices:m,lodThreshold:null}],referenceBoundingBox:J(r)}}(e,t);return{lods:r,referenceBoundingBox:n,isEsriSymbolResource:!1,isWosr:!0}}let R;if(t.cache)R=await t.cache.loadGLTF(i.url,t,!!t.usePBR);else{const{loadGLTF:e}=await r.e(56516).then(r.bind(r,56516));R=await e(new w.R(t.streamDataRequester),i.url,t,t.usePBR)}const B=R.model.meta?.ESRI_proxyEllipsoid,M=R.meta.isEsriSymbolResource&&null!=B&&"EsriRealisticTreesStyle"===R.meta.ESRI_webstyle;M&&!R.customMeta.esriTreeRendering&&(R.customMeta.esriTreeRendering=!0,function(e,t){for(let r=0;r<e.model.lods.length;++r){const s=e.model.lods[r];for(const o of s.parts){const s=o.attributes.normal;if(null==s)return;const a=o.attributes.position,i=a.count,c=(0,d.vt)(),m=(0,d.vt)(),p=(0,d.vt)(),g=new Float32Array(4*i),y=new Float32Array(3*i),x=(0,l.B8)((0,u.vt)(),o.transform);let w=0,b=0;for(let l=0;l<i;l++){a.getVec(l,m),s.getVec(l,c),(0,f.t)(m,m,o.transform),(0,f.d)(p,m,t.center),(0,f.E)(p,p,t.radius);const i=p[2],u=(0,f.l)(p),d=Math.min(.45+.55*u*u,1)**n.Tf;(0,f.E)(p,p,t.radius),null!==x&&(0,f.t)(p,p,x),(0,f.n)(p,p),r+1!==e.model.lods.length&&e.model.lods.length>1&&(0,f.m)(p,p,c,i>-1?.2:Math.min(-4*i-3.8,1)),y[w]=p[0],y[w+1]=p[1],y[w+2]=p[2],w+=3,g[b]=d,g[b+1]=d,g[b+2]=d,g[b+3]=1,b+=4}o.attributes.normal=new h.xs(y),o.attributes.color=new h.Eq(g)}}}(R,B));const I=!!t.usePBR,S=R.meta.isEsriSymbolResource?{usePBR:I,isSchematic:!1,treeRendering:M,mrrFactors:Y.SY}:{usePBR:I,isSchematic:!1,treeRendering:!1,mrrFactors:Y.mb},E={...t.materialParameters,treeRendering:M},{engineResources:P,referenceBoundingBox:k}=function(e,t,r,s,i){const l=e.model,u=new Array,f=new Map,d=new Map,w=l.lods.length,R=(0,m.Ie)();return l.lods.forEach(((e,B)=>{const M=!0===s.skipHighLods&&(w>1&&0===B||w>3&&1===B)||!1===s.skipHighLods&&null!=i&&B!==i;if(M&&0!==B)return;const I=new A(e.name,e.lodThreshold,[0,0,0]);e.parts.forEach((e=>{const i=M?new G.$U({},s):function(e,t,r,s,o,a,i,l){const u=e.materials.get(t.material);if(null==u)return null;const{normal:f,color:d,texCoord0:m,tangent:p}=t.attributes,h=t.material+(f?"_normal":"")+(d?"_color":"")+(m?"_texCoord0":"")+(p?"_tangent":""),g=null!=t.attributes.texCoord0,y=null!=t.attributes.normal,x=function(e){switch(e){case"BLEND":return C.sf.Blend;case"MASK":return C.sf.Mask;case"OPAQUE":case null:case void 0:return C.sf.Opaque}}(u.alphaMode);if(!a.has(h)){if(g){const t=(t,r=!1)=>{if(null!=t&&!i.has(t)){const n=e.textures.get(t);if(n){const e=n.data;i.set(t,new F.g((0,T.x3)(e)?e.data:e,{...n.parameters,preMultiplyAlpha:!(0,T.x3)(e)&&r,encoding:(0,T.x3)(e)?e.encoding:void 0}))}}};t(u.colorTexture,x!==C.sf.Opaque),t(u.normalTexture),t(u.occlusionTexture),t(u.emissiveTexture),t(u.metallicRoughnessTexture)}const r=1/n.Tf,f=u.color[0]**r,d=u.color[1]**r,m=u.color[2]**r,p=u.emissiveFactor[0]**r,w=u.emissiveFactor[1]**r,b=u.emissiveFactor[2]**r,R=null!=u.colorTexture&&g?i.get(u.colorTexture):null,A=(0,Y.Jr)(u),B=null!=u.normalTextureTransform?.scale?u.normalTextureTransform?.scale:c.Un;a.set(h,new G.$U({...s,transparent:x===C.sf.Blend,customDepthTest:C.it.Lequal,textureAlphaMode:x,textureAlphaCutoff:u.alphaCutoff,diffuse:[f,d,m],ambient:[f,d,m],opacity:u.opacity,doubleSided:u.doubleSided,doubleSidedType:"winding-order",cullFace:u.doubleSided?C.s2.None:C.s2.Back,hasVertexColors:!!t.attributes.color,hasVertexTangents:!!t.attributes.tangent,normalType:y?H.W.Attribute:H.W.ScreenDerivative,castShadows:!0,receiveShadows:u.receiveShadows,receiveAmbientOcclusion:u.receiveAmbientOcclustion,textureId:null!=R?R.id:void 0,colorMixMode:u.colorMixMode,normalTextureId:null!=u.normalTexture&&g?i.get(u.normalTexture).id:void 0,textureAlphaPremultiplied:null!=R&&!!R.parameters.preMultiplyAlpha,occlusionTextureId:null!=u.occlusionTexture&&g?i.get(u.occlusionTexture).id:void 0,emissiveTextureId:null!=u.emissiveTexture&&g?i.get(u.emissiveTexture).id:void 0,metallicRoughnessTextureId:null!=u.metallicRoughnessTexture&&g?i.get(u.metallicRoughnessTexture).id:void 0,emissiveFactor:[p,w,b],mrrFactors:A?Y.Bt:[u.metallicFactor,u.roughnessFactor,s.mrrFactors[2]],isSchematic:A,colorTextureTransformMatrix:(0,v.G)(u.colorTextureTransform),normalTextureTransformMatrix:(0,v.G)(u.normalTextureTransform),scale:[B[0],B[1]],occlusionTextureTransformMatrix:(0,v.G)(u.occlusionTextureTransform),emissiveTextureTransformMatrix:(0,v.G)(u.emissiveTextureTransform),metallicRoughnessTextureTransformMatrix:(0,v.G)(u.metallicRoughnessTextureTransform),...o},l))}const w=a.get(h);if(r.stageResources.materials.push(w),g){const e=e=>{null!=e&&r.stageResources.textures.push(i.get(e))};e(u.colorTexture),e(u.normalTexture),e(u.occlusionTexture),e(u.emissiveTexture),e(u.metallicRoughnessTexture)}return w}(l,e,I,t,r,f,d,s),{geometry:u,vertexCount:w}=function(e,t){const r=e.attributes.position.count,n=(0,b.x)(e.indices||r,e.primitiveType),s=(0,p.oe)(3*r),{typedBuffer:i,typedBufferStride:l}=e.attributes.position;(0,g.t)(s,i,e.transform,3,l);const u=[[N.r.POSITION,new _.n(s,n,3,!0)]];if(null!=e.attributes.normal){const t=(0,p.oe)(3*r),{typedBuffer:s,typedBufferStride:i}=e.attributes.normal;(0,a.Ge)(ee,e.transform),(0,g.b)(t,s,ee,3,i),(0,o.or)(ee)&&(0,g.n)(t,t),u.push([N.r.NORMAL,new _.n(t,n,3,!0)])}if(null!=e.attributes.tangent){const t=(0,p.oe)(4*r),{typedBuffer:s,typedBufferStride:i}=e.attributes.tangent;(0,a.z0)(ee,e.transform),(0,y.t)(t,s,ee,4,i),(0,o.or)(ee)&&(0,g.n)(t,t,4),u.push([N.r.TANGENT,new _.n(t,n,4,!0)])}if(null!=e.attributes.texCoord0){const t=(0,p.oe)(2*r),{typedBuffer:s,typedBufferStride:o}=e.attributes.texCoord0;(0,x.a)(t,s,2,o),u.push([N.r.UV0,new _.n(t,n,2,!0)])}const c=e.attributes.color;if(null!=c){const t=new Uint8Array(4*r);4===c.elementCount?c instanceof h.Eq?(0,y.b)(t,c,1,255):(c instanceof h.XP||c instanceof h.Uz)&&(0,y.b)(t,c,1/255,255):(t.fill(255),c instanceof h.xs?(0,g.f)(t,c.typedBuffer,1,255,4,c.typedBufferStride):(e.attributes.color instanceof h.eI||e.attributes.color instanceof h.nS)&&(0,g.f)(t,c.typedBuffer,1/255,255,4,e.attributes.color.typedBufferStride)),u.push([N.r.COLOR,new _.n(t,n,4,!0)])}return{geometry:new q.V(t,u),vertexCount:r}}(e,i??new G.$U({},s)),A=u.boundingInfo;null!=A&&0===B&&((0,m.iT)(R,A.bbMin),(0,m.iT)(R,A.bbMax)),null!=i&&(I.stageResources.geometries.push(u),I.numberOfVertices+=w)})),M||u.push(I)})),{engineResources:u,referenceBoundingBox:R}}(R,S,E,t,i.specifiedLodIndex);return{lods:P,referenceBoundingBox:k,isEsriSymbolResource:R.meta.isEsriSymbolResource,isWosr:!1}}const ee=(0,i.vt)()}}]);
//# sourceMappingURL=39513.b2c77361.chunk.js.map