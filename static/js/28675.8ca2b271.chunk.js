"use strict";(globalThis.webpackChunkmy_app=globalThis.webpackChunkmy_app||[]).push([[28675],{28675:(e,t,i)=>{i.d(t,{previewCIMSymbol:()=>d});var l=i(76931),a=i(401),n=i(6840),o=i(48988),r=i(97763),s=i(65709),h=i(26291);const c=new n.CIMSymbolRasterizer(null),m=(0,l.PN)(s.CB.size),u=(0,l.PN)(s.CB.maxSize),y=(0,l.PN)(s.CB.lineWidth),g=1;async function w(e,t,i){const l=t?.size;let n=null!=l&&"object"==typeof l&&"width"in l?l.width:l,r=null!=l&&"object"==typeof l&&"height"in l?l.height:l;if(null==n||null==r)if("esriGeometryPolygon"===i)n=r=t.maxSize?Math.min(t.maxSize,m):m;else{const l=await async function(e,t,i){const{feature:l,fieldMap:n,viewParams:r}=t.cimOptions||t,s=await o.OverrideHelper.resolveSymbolOverrides(e.data,l,null,n,i,null,r);if(!s)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:s},e.data.primitiveOverrides=void 0;const h=[];return a.wp.fetchResources(s,c.resourceManager,h),a.wp.fetchFonts(s,c.resourceManager,h),h.length>0&&await Promise.all(h),a.wp.getEnvelope(s,null,c.resourceManager)}(e,t,i);l&&(n=l.width,r=l.height),"esriGeometryPolyline"===i&&(n=t.maxSize?Math.min(t.maxSize,y):y),n=null!=n&&isFinite(n)?Math.min(n,u):m,r=null!=r&&isFinite(r)?Math.max(Math.min(r,u),g):m}return"legend"===t.style&&"esriGeometryPolyline"===i&&(n=y),{width:n,height:r}}async function d(e,t={}){const{node:i,opacity:a,symbolConfig:n}=t,o=null!=n&&"object"==typeof n&&"isSquareFill"in n&&n.isSquareFill,s=t.cimOptions||t,m=s.geometryType||(0,r.n5)(e?.data?.symbol),u=await w(e,t,m),{feature:y,fieldMap:g}=s,d=t?.geometry||o||"esriGeometryPolygon"!==m?"preview":"legend";let p=u;const f=u;if(t?.geometry&&("esriGeometryPolygon"===m||"esriGeometryPolyline"===m)){const e=200;if((0,l.Lz)(u.width)<e||(0,l.Lz)(u.height)<e){const t=u.width>u.height?(0,l.PN)(e)*u.height/u.width:(0,l.PN)(e);p={width:u.width>u.height?(0,l.PN)(e):(0,l.PN)(e)*u.width/u.height,height:t}}}const b=await c.rasterizeCIMSymbolAsync(e,y,p,d,g,m,null,s.viewParams,s.allowScalingUp,t?.geometry?.toJSON());if(!b)return null;const{width:P,height:z}=b,M=document.createElement("canvas");M.width=P,M.height=z,M.getContext("2d").putImageData(b,0,0);const S=(0,l.Lz)(f.width),v=(0,l.Lz)(f.height),C=new Image(S,v);C.src=M.toDataURL(),C.ariaLabel=t.ariaLabel??null,C.alt=t.ariaLabel??"",null!=a&&(C.style.opacity=`${a}`);let L=C;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:S,height:v,src:C.src},fill:null,stroke:null,offset:[0,0]};L=(0,h.fz)([[e]],[S,v],{effectView:t.effectView,ariaLabel:t.ariaLabel})}return i&&L&&i.appendChild(L),L}}}]);
//# sourceMappingURL=28675.8ca2b271.chunk.js.map