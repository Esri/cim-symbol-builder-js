"use strict";(globalThis.webpackChunkmy_app=globalThis.webpackChunkmy_app||[]).push([[32040,28675],{28675:(e,t,o)=>{o.d(t,{D:()=>h,previewCIMSymbol:()=>g});var i=o(76931),n=o(401),l=o(6840),r=o(48988),a=o(97763),s=o(65709),c=o(26291);const u=new l.CIMSymbolRasterizer(null),y=(0,i.PN)(s.CB.size),m=(0,i.PN)(s.CB.maxSize),f=(0,i.PN)(s.CB.lineWidth),p=1;async function d(e,t,o){const i=t?.size;let n=null!=i&&"object"==typeof i&&"width"in i?i.width:i,l=null!=i&&"object"==typeof i&&"height"in i?i.height:i;if(!n||!l)if("esriGeometryPolygon"===o)n=l=t.maxSize?Math.min(t.maxSize,y):y;else{const i=await h(e,t,o);i&&(n=i.width,l=i.height),"esriGeometryPolyline"===o&&(n=t.maxSize?Math.min(t.maxSize,f):f),n=null!=n&&isFinite(n)?Math.min(n,m):y,l=null!=l&&isFinite(l)?Math.max(Math.min(l,m),p):y}return"legend"===t.style&&"esriGeometryPolyline"===o&&(n=f),{width:n,height:l}}async function h(e,t={},o){const i=t.cimOptions||t;o??=i.geometryType||(0,a.n5)(e?.data?.symbol);const{feature:l,fieldMap:s,viewParams:c}=i,y=await r.OverrideHelper.resolveSymbolOverrides(e.data,l,null,s,o,null,c);if(!y)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:y},e.data.primitiveOverrides=void 0;const m=[];return n.wp.fetchResources(y,u.resourceManager,m),n.wp.fetchFonts(y,u.resourceManager,m),m.length>0&&await Promise.all(m),n.wp.getEnvelope(y,null,u.resourceManager)}async function g(e,t={}){const{node:o,opacity:n,symbolConfig:l}=t,r=null!=l&&"object"==typeof l&&"isSquareFill"in l&&l.isSquareFill,s=t.cimOptions||t,y=s.geometryType||(0,a.n5)(e?.data?.symbol),m=await d(e,t,y),{feature:f,fieldMap:p}=s,h=t?.geometry||r||"esriGeometryPolygon"!==y?"preview":"legend";let g=m;const b=m;if(t?.geometry&&("esriGeometryPolygon"===y||"esriGeometryPolyline"===y)){const e=200;if((0,i.Lz)(m.width)<e||(0,i.Lz)(m.height)<e){const t=m.width>m.height?(0,i.PN)(e)*m.height/m.width:(0,i.PN)(e);g={width:m.width>m.height?(0,i.PN)(e):(0,i.PN)(e)*m.width/m.height,height:t}}}const w=await u.rasterizeCIMSymbolAsync(e,f,g,h,p,y,null,s.viewParams,s.allowScalingUp,t?.geometry?.toJSON());if(!w)return null;const{width:v,height:S}=w,C=document.createElement("canvas");C.width=v,C.height=S,C.getContext("2d").putImageData(w,0,0);const z=(0,i.Lz)(b.width),M=(0,i.Lz)(b.height),k=new Image(z,M);k.src=C.toDataURL(),k.ariaLabel=t.ariaLabel??null,k.alt=t.ariaLabel??"",null!=n&&(k.style.opacity=`${n}`);let I=k;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:z,height:M,src:k.src},fill:null,stroke:null,offset:[0,0]};I=(0,c.fz)([[e]],[z,M],t)}return o&&I&&o.appendChild(I),I}},32040:(e,t,o)=>{o.d(t,{getRampStops:()=>E});var i,n=o(69539),l=o(59784),r=o(24921),a=o(53084),s=(o(89465),o(28808));function c(e){switch(e){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function u(e){return"CIMVectorMarker"===e?.type?e.markerGraphics?.[0]:void 0}function y(e){return"CIMPolygonSymbol"===e?.symbol?.type?e.symbol.symbolLayers?.[0]:void 0}function m(e,t){"CIMVectorMarker"===e?.type&&null!=t&&(e.size=t)}function f(e,t){const o=u(e);o&&null!=t&&(o.geometry=c(t))}function p(e,t){const o=y(u(e));o&&null!=t&&(o.color=t.toArray())}function d(e,t,o){const i=y(u(e));i&&null!=t&&o&&(i.colorLocked=t)}function h(e,t){const{outerRingSize:o,innerDotSize:n,type:l,color:r,colorLocked:s,primitiveOverrides:c}=t,u="CIMPolygonSymbol"===e.data.symbol?.type?e.data.symbol.symbolLayers:null;if(2===u?.length)for(const a of u){const e=a.primitiveName===i.OuterRing;m(a,e?o:n),f(a,l),p(a,r),d(a,s,e)}return null!=o&&null!=n&&(e.data.primitiveOverrides=null),void 0!==c&&(e.data.primitiveOverrides=(0,a.o8)(c)),e}!function(e){e.OuterRing="reference-size-outer-ring",e.InnerDot="reference-size-inner-dot"}(i||(i={}));var g=o(76931);const b="spike-height-override";(0,g.PN)(8),(0,g.PN)(20);function w(e){const t=[v(e)],o=function(e){const{color:t,symbolStyle:o}=e,i=o?.includes("solid-fill"),n=o?.includes("gradient-fill");if(!i&&!n||!t)return;if(i)return{type:"CIMSolidFill",enable:!0,colorLocked:!1,color:t?.toArray()};const l=t.clone();return l.a=0,{type:"CIMGradientFill",enable:!0,angle:90,colorRamp:{type:"CIMMultipartColorRamp",colorRamps:[{type:"CIMLinearContinuousColorRamp",fromColor:t.toArray(),toColor:l.toArray()}],weights:[1]},gradientMethod:"Linear",gradientSize:70,gradientSizeUnits:"Relative",gradientType:"Continuous"}}(e);return o&&t.push(o),t}function v(e){const{strokeColor:t,strokeWidth:o,symbolStyle:i}=e,n=i?.includes("solid-fill")||i?.includes("gradient-fill");let l=t?.toArray(),r=!1;return i?.includes("outline")&&n?r=!0:l=e.color?.toArray(),{type:"CIMSolidStroke",effects:S(i),enable:!0,colorLocked:r,capStyle:s.uT.Round,joinStyle:s.wd.Round,lineStyle3D:s.h5.Strip,miterLimit:4,width:o??(0,g.PN)(1),color:l}}function S(e){if(!e?.includes("closed"))return[{type:"CIMGeometricEffectAddControlPoints",angleTolerance:90,primitiveName:"spike-control-points"},{type:"CIMGeometricEffectSuppress",suppress:!0,invert:!0,primitiveName:"spike-stroke-suppress"}]}function C(e,t){const{defaultHeight:o,baseWidth:i,color:l,strokeColor:r,primitiveOverrides:s,symbolStyle:c,strokeWidth:u}=t,y="CIMPointSymbol"===e.data.symbol?.type?e.data.symbol:null;if(!y)return e;const m=y.effects,f=m?.find((e=>"CIMGeometricEffectTaperedPolygon"===e.type)),p=m?.find((e=>"CIMGeometricEffectRadial"===e.type&&e.primitiveName===b));null!=i&&f&&(f.fromWidth=i),null!=o&&p&&(p.length=o);const d=y.symbolLayers,h=d?.find((e=>"CIMSolidStroke"===e.type)),g=d?.find((e=>"CIMSolidFill"===e.type)),v=d?.find((e=>"CIMGradientFill"===e.type)),S="CIMMultipartColorRamp"===v?.colorRamp?.type&&"CIMLinearContinuousColorRamp"===v.colorRamp.colorRamps[0]?.type?v.colorRamp.colorRamps[0]:null;if(c){const e=g?.color??S?.fromColor??h?.color,t=h?.color??e;y.symbolLayers=w({color:l??(e?new n.A(e):void 0),strokeColor:r??(t?new n.A(t):void 0),strokeWidth:u??h?.width,symbolStyle:c})}else if(h&&r&&(h.color=r.toArray()),g&&l&&(g.color=l.toArray()),S&&l){const e=l.clone();e.a=0,S.fromColor=l.toArray(),S.toColor=e.toArray()}return void 0!==s&&(e.data.primitiveOverrides=(0,a.o8)(s)),e}var z=o(7246),M=o(76940),k=o(29632),I=o(28675),L=o(94725),P=o(94439),R=o(60823),A=(o(15187),o(12440));const x=30,N=12,O=24,D=[255,255,255],G=[200,200,200],T=[128,128,128],F=20,V=5;async function E(e,t,i,n,l,a,s){const c=t.legendOptions,u=c?.customValues,y=s||await q(e,i),m=t.stops,f=!!y,p=!!u,d=null!=t.minSize&&null!=t.maxSize,h=m&&m.length>1,g=!!t.target;if(!f||!p&&!(d||h&&!g))return;const b=(0,P.$d)(y);let w=!1,v=null,S=null;v=b&&!h?(0,r.LI)([t.minDataValue,t.maxDataValue]):u??await async function(e,t,i,n){const l=(await Promise.resolve().then(o.bind(o,15492))).getSizeRangeAtScale(e,i,n),a=l&&H(l);if(!l||!a)return;let s=a.map((t=>function(e,t,o){const i=o.minSize,n=o.maxSize,l=t.minDataValue,r=t.maxDataValue;let a;a=e<=i?l:e>=n?r:(e-i)/(n-i)*(r-l)+l;return a}(t,e,l)));s=(0,r.LI)(s);for(let o=1;o<s.length-1;o++){const l=await U(e,t,s[o],s[o-1],i,n);l&&(s[o]=l[0],a[o]=l[1])}return s}(t,y,n,l?.type);const C=e?.authoringInfo,z="univariate-color-size"===C?.type,M=z&&"above-and-below"===C?.univariateTheme,k=!!(0,R.iz)(e,"reference-size"),L=!!(0,R.iz)(e,"spike");if(!v&&h&&(v=m.map((e=>e.value)),w=m.some((e=>!!e.label)),"flow"===e.type&&(v=(0,r.LI)(v)),w&&(S=m.map((e=>e.label)))),b&&null!=v&&v?.length>2&&!M&&(v=[v[0],v[v.length-1]]),!v)return null;z&&5!==v?.length&&(v=H({minSize:v[0],maxSize:v[v.length-1]}));const A=b?W(e,v):null,x=(0,P.k_)(y),N=w?null:function(e,t){const o=e.length-1;return e.map(((e,i)=>(0,R.Dd)(e,i,o,t)))}(v,a),D=await Promise.all(v.map((async(o,i)=>{let r=b?A[i]:await $(t,y,o,n,l?.type),a=r;k&&(r*=O/t.maxSize||1,a=O);const s=_(y,r,e,i);return L&&"cim"===s.type&&(a=await(0,I.D)(s)),{value:o,symbol:s,label:w?S[i]:N[i],size:a,outlineSize:x}})));return D.reverse()}function W(e,t){const o=e?.authoringInfo,i="univariate-color-size"===o?.type;let n=[N,x];if(i){const e=t[0],o=t[t.length-1],i=N,l=x;n=t.map((t=>i+(t-e)/(o-e)*(l-i)))}return i&&"below"===o?.univariateTheme&&n.reverse(),n}async function q(e,t){if("flow"===e.type)return(0,R.Zo)(e,t);if("pie-chart"===e.type)return new M.A({color:null,outline:e.outline?.width?e.outline:new z.A});let o=null,i=null;if("simple"===e.type)o=e.symbol;else if("class-breaks"===e.type){const t=e.classBreakInfos;o=t&&t[0]&&t[0].symbol,i=t.length>1}else if("unique-value"===e.type){const t=e.uniqueValueInfos;o=t?.[0]?.symbol,i=null!=t&&t.length>1}if(!o||function(e){return(0,L.wk)(e)?e.symbolLayers?.some((e=>"fill"===e?.type))??!1:e?.type.includes("fill")??!1}(o))return null;if(o=o.clone(),t||i)if(o.type.includes("3d"))B(o);else if((0,R.iz)(e,"reference-size")&&"cim"===o.type)h(o,{color:t??("class-breaks"!==e.type?new n.A(G):null)});else if((0,R.iz)(e,"spike")&&"cim"===o.type){const e=new n.A(G),i=new n.A(T),r="CIMPointSymbol"===o.data.symbol?.type?o.data.symbol:null,a=!!r?.symbolLayers?.find((({type:e})=>"CIMSolidStroke"===e))?.colorLocked;let s,c=t??void 0;if(c){const t=(0,l.Ws)(c),o=(0,A.ud)();(!o&&t>225||o&&t<25)&&(c=e,s=a?i:e)}else c=e,s=a?i:e;C(o,{color:c,strokeColor:s})}else j(o);return o}function B(e){"line-3d"===e.type?e.symbolLayers.forEach((e=>{e.material={color:T}})):e.symbolLayers.forEach((e=>{"icon"!==e.type||e.resource?.href?e.material={color:G}:(e.material={color:D},e.outline={color:T,size:1.5})}))}function j(e){const t=(0,A.ud)();if("cim"===e.type)(0,k.Fe)(e,new n.A(G));else if(e.type.includes("line"))e.color=T;else if(e.color=t?T:D,"simple-marker"===e.type)if(e.outline){const t=e.outline?.color?.toHex();"#ffffff"===t&&(e.outline.color=T)}else e.outline={color:T,width:1.5}}function H(e){const t=e.minSize,o=e.maxSize,i=V,n=(o-t)/(i-1),l=[];for(let r=0;r<i;r++)l.push(t+n*r);return l}async function U(e,t,o,i,n,l){const a=await $(e,t,o,n,l),s=await $(e,t,i,n,l),c=(0,r.lc)(o),u=c.fractional,y=F;let m=c.integer,f=null,p=null;o>0&&o<1&&(f=10**u,m=(0,r.lc)(o*=f).integer);for(let d=m-1;d>=0;d--){const i=10**d;let c=Math.floor(o/i)*i,u=Math.ceil(o/i)*i;null!=f&&(c/=f,u/=f);let m=(c+u)/2;[,m]=(0,r.LI)([c,m,u],{indexes:[1]});const h=await $(e,t,c,n,l),g=await $(e,t,u,n,l),b=await $(e,t,m,n,l),w=(0,r.u5)(a,h,s,null),v=(0,r.u5)(a,g,s,null),S=(0,r.u5)(a,b,s,null);let C=w.previous<=y,z=v.previous<=y;if(C&&z&&(w.previous<=v.previous?(C=!0,z=!1):(z=!0,C=!1)),C?p=[c,h]:z?p=[u,g]:S.previous<=y&&(p=[m,b]),p)break}return p}async function $(e,t,i,n,l){const{getSize:r}=await Promise.resolve().then(o.bind(o,15492));return r(e,i,{scale:n,view:l,shape:"simple-marker"===t.type?t.style:null})}function _(e,t,o,i){"univariate-color-size"===o?.authoringInfo?.type&&"above-and-below"===o?.authoringInfo?.univariateTheme&&"class-breaks"===o.type&&(e=function(e,t){const o=e.classBreakInfos,i=o.length,n=i<2||!(t>=2)?o[0].symbol.clone():o[i-1].symbol.clone(),l=e.visualVariables?.some((e=>"color"===e.type));return l&&(n.type.includes("3d")?B(n):j(n)),n}(o,i));const n=e.clone();if((0,L.wk)(n))(0,P.$d)(n)||n.symbolLayers.forEach((e=>{"fill"!==e.type&&(e.size=t)}));else if(function(e){return"esri.symbols.SimpleMarkerSymbol"===e.declaredClass}(n))n.size=t;else if(function(e){return"esri.symbols.PictureMarkerSymbol"===e.declaredClass}(n)){const e=n.width,o=n.height;n.height=t,n.width=t*(e/o)}else!function(e){return"esri.symbols.SimpleLineSymbol"===e.declaredClass}(n)?function(e){return"esri.symbols.TextSymbol"===e.declaredClass}(n)?n.font&&(n.font.size=t):"cim"===n.type&&(0,R.iz)(o,"reference-size")?h(n,{innerDotSize:t,outerRingSize:O}):"cim"===n.type&&(0,R.iz)(o,"spike")&&C(n,{defaultHeight:t,primitiveOverrides:null}):n.width=t;return n}}}]);
//# sourceMappingURL=32040.441c45a9.chunk.js.map