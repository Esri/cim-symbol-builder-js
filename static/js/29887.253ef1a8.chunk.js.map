{"version":3,"file":"static/js/29887.253ef1a8.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/graphics/editingSupport.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport e from\"../../Graphic.js\";import t from\"../../core/Collection.js\";import a from\"../../core/Error.js\";import{clone as r}from\"../../core/lang.js\";import s from\"../../core/Logger.js\";import{createResolver as o}from\"../../core/promiseUtils.js\";import{dataComponents as i}from\"../../core/urlUtils.js\";import{generateBracedUUID as n}from\"../../core/uuid.js\";import{normalizeCentralMeridian as d}from\"../../geometry/support/normalizeUtils.js\";import{isEditBusLayer as l,emitApplyEditsEvent as u}from\"../mixins/EditBusLayer.js\";import{isValidFieldValue as p}from\"../support/fieldUtils.js\";import{getMimeTypeFormatId as c,getFilenameFormatId as h}from\"../support/infoFor3D.js\";import{getEffectiveEditingEnabled as m,getEffectiveLayerCapabilities as f}from\"../support/layerUtils.js\";function y(e){return null!=e?.applyEdits}function g(e){return\"object\"==typeof e&&null!=e&&\"objectId\"in e&&!!e.objectId}function b(e){return e.every(g)}function w(e){return\"object\"==typeof e&&null!=e&&\"globalId\"in e&&!!e.globalId}function F(e){return e.every(w)}async function A(e,t,a,s={}){let i;const n=\"gdbVersion\"in e?e.gdbVersion:null,d=s.gdbVersion??n;if(l(e)&&e.url)i=u(e.url,e.layerId,d,\"original-and-current-features\"===s.returnServiceEditsOption);else{i=o(),i.promise.then((t=>{(t.addedFeatures.length||t.updatedFeatures.length||t.deletedFeatures.length||t.addedAttachments.length||t.updatedAttachments.length||t.deletedAttachments.length)&&e.emit(\"edits\",t)}));const t={result:i.promise};e.emit(\"apply-edits\",t)}try{const{results:o,edits:n}=await v(e,t,a,s),d=e=>e.filter((e=>!e.error)).map(r),l={edits:n,addedFeatures:d(o.addFeatureResults),updatedFeatures:d(o.updateFeatureResults),deletedFeatures:d(o.deleteFeatureResults),addedAttachments:d(o.addAttachmentResults),updatedAttachments:d(o.updateAttachmentResults),deletedAttachments:d(o.deleteAttachmentResults),exceededTransferLimit:!1,historicMoment:o.editMoment?new Date(o.editMoment):null,globalIdToObjectId:s.globalIdToObjectId};return o.editedFeatureResults?.length&&(l.editedFeatures=o.editedFeatureResults),i.resolve(l),o}catch(p){throw i.reject(p),p}}async function v(e,t,r,s){if(await e.load(),!y(t))throw new a(`${e.type}-layer:no-editing-support`,\"Layer source does not support applyEdits capability\",{layer:e});if(!m(e))throw new a(`${e.type}-layer:editing-disabled`,\"Editing is disabled for layer\",{layer:e});const{edits:o,options:i}=await I(e,r,s);return o.addFeatures?.length||o.updateFeatures?.length||o.deleteFeatures?.length||o.addAttachments?.length||o.updateAttachments?.length||o.deleteAttachments?.length?{edits:o,results:await t.applyEdits(o,i)}:{edits:o,results:{addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}}async function I(e,t,r){const o=f(e),i=t&&(t.addFeatures||t.updateFeatures||t.deleteFeatures),n=t&&(t.addAttachments||t.updateAttachments||t.deleteAttachments),d=null!=e.infoFor3D;if(T(t,o,r,!!i,!!n,`${e.type}-layer`),!o.data.isVersioned&&r?.gdbVersion)throw new a(`${e.type}-layer:invalid-parameter`,\"'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'\");if(!o.editing.supportsRollbackOnFailure&&r?.rollbackOnFailureEnabled)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'\");const l={...r};if(null!=l.rollbackOnFailureEnabled||o.editing.supportsRollbackOnFailure||(l.rollbackOnFailureEnabled=!0),l.rollbackOnFailureEnabled||\"original-and-current-features\"!==l.returnServiceEditsOption||(!1===l.rollbackOnFailureEnabled&&s.getLogger(\"esri.layers.graphics.editingSupport\").warn(`${e.type}-layer:invalid-parameter`,\"'original-and-current-features' is valid for 'returnServiceEditsOption' only when 'rollBackOnFailure' is true, but 'rollBackOnFailure' was set to false. 'rollBackOnFailure' has been overwrritten and set to true.\"),l.rollbackOnFailureEnabled=!0),!o.editing.supportsReturnServiceEditsInSourceSpatialReference&&l.returnServiceEditsInSourceSR)throw new a(`${e.type}-layer:invalid-parameter`,\"This layer does not support 'returnServiceEditsInSourceSR' parameter. See: 'capabilities.editing.supportsReturnServiceEditsInSourceSpatialReference'\");if(l.returnServiceEditsInSourceSR&&\"original-and-current-features\"!==l.returnServiceEditsOption)throw new a(`${e.type}-layer:invalid-parameter`,\"'returnServiceEditsInSourceSR' is valid only when 'returnServiceEditsOption' is set to 'original-and-current-features'\");const u=B(t,o,`${e.type}-layer`),p=r?.globalIdUsed||d,c=e.fields.filter((e=>\"big-integer\"===e.type||\"oid\"===e.type&&(e.length||0)>=8));if(p){const{globalIdField:t}=e;if(null==t)throw new a(`${e.type}-layer:invalid-parameter`,\"Layer does not specify a global id field.\");u.addFeatures.forEach((e=>U(e,t)))}u.addFeatures.forEach((t=>S(t,e,p,c))),u.updateFeatures.forEach((t=>j(t,e,p,c))),u.deleteFeatures.forEach((t=>R(t,e,p,c))),u.addAttachments.forEach((t=>O(t,e))),u.updateAttachments.forEach((t=>O(t,e))),d&&await G(u,e);return{edits:await L(u),options:l}}function $(e,t,r,s){if(r){if(\"attributes\"in e&&!e.attributes[t.globalIdField])throw new a(`${t.type}-layer:invalid-parameter`,`Feature should have '${t.globalIdField}' when 'globalIdUsed' is true`);if(!(\"attributes\"in e)&&!e.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"`'globalId' of the feature should be passed when 'globalIdUsed' is true\")}if(s.length&&\"attributes\"in e)for(const o of s){const r=e.attributes[o.name];if(void 0!==r&&!p(o,r))throw new a(`${t.type}-layer:invalid-parameter`,`Big-integer field '${o.name}' of the feature must be less than ${Number.MAX_SAFE_INTEGER}`,{feature:e})}if(\"geometry\"in e&&null!=e.geometry){if(e.geometry.hasZ&&!1===t.capabilities?.data.supportsZ)throw new a(`${t.type}-layer:z-unsupported`,\"Layer does not support z values while feature has z values.\");if(e.geometry.hasM&&!1===t.capabilities?.data.supportsM)throw new a(`${t.type}-layer:m-unsupported`,\"Layer does not support m values while feature has m values.\")}}function E(e,t){if(\"geometry\"in e&&\"mesh\"===e.geometry?.type&&null!=t.infoFor3D){const{geometry:r}=e;if(r.vertexSpace.isGeoreferenced)throw new a(`${t.type}-layer:georeferenced-mesh-unsupported`,\"Uploading georeferenced meshes to a layer is not supported.\")}}function S(e,t,a,r){$(e,t,a,r),E(e,t)}function R(e,t,a,r){$(e,t,a,r)}function j(e,t,r,s){$(e,t,r,s),E(e,t);const o=f(t);if(\"geometry\"in e&&null!=e.geometry&&!o?.editing.supportsGeometryUpdate)throw new a(`${t.type}-layer:unsupported-operation`,\"Layer does not support geometry updates.\")}function O(e,t){const{feature:r,attachment:s}=e;if(!r||\"attributes\"in r&&!r.attributes[t.globalIdField])throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have reference to a feature with 'globalId'\");if(!(\"attributes\"in r)&&!r.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have reference to 'globalId' of the parent feature\");if(!s.globalId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have 'globalId'\");if(!s.data&&!s.uploadId)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment should have 'data' or 'uploadId'\");if(!(s.data instanceof File&&!!s.data.name)&&!s.name)throw new a(`${t.type}-layer:invalid-parameter`,\"'name' is required when attachment is specified as Base64 encoded string using 'data'\");if(!t.capabilities?.editing.supportsUploadWithItemId&&s.uploadId)throw new a(`${t.type}-layer:invalid-parameter`,\"This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'\");if(\"string\"==typeof s.data){const e=i(s.data);if(e&&!e.isBase64)throw new a(`${t.type}-layer:invalid-parameter`,\"Attachment 'data' should be a Blob, File or Base64 encoded string\")}}function U(e,t){const{attributes:a}=e;null==a[t]&&(a[t]=n())}async function L(e){const t=e.addFeatures??[],a=e.updateFeatures??[],r=t.concat(a).map((e=>e.geometry)),s=await d(r),o=t.length,i=a.length;return s.slice(0,o).forEach(((e,a)=>t[a].geometry=e)),s.slice(o,o+i).forEach(((e,t)=>a[t].geometry=e)),e}function k(e){return{addFeatures:Array.from(e?.addFeatures??[]),updateFeatures:Array.from(e?.updateFeatures??[]),deleteFeatures:e&&t.isCollection(e.deleteFeatures)?e.deleteFeatures.toArray():e.deleteFeatures||[],addAttachments:e.addAttachments||[],updateAttachments:e.updateAttachments||[],deleteAttachments:e.deleteAttachments||[]}}function B(e,t,r){const s=k(e);if(s.addFeatures?.length&&!t.operations.supportsAdd)throw new a(`${r}:unsupported-operation`,\"Layer does not support adding features.\");if(s.updateFeatures?.length&&!t.operations.supportsUpdate)throw new a(`${r}:unsupported-operation`,\"Layer does not support updating features.\");if(s.deleteFeatures?.length&&!t.operations.supportsDelete)throw new a(`${r}:unsupported-operation`,\"Layer does not support deleting features.\");return s.addFeatures=s.addFeatures.map(D),s.updateFeatures=s.updateFeatures.map(D),s.addAssetFeatures=[],s}function T(e,t,r,s,o,i){if(!e||!s&&!o)throw new a(`${i}:missing-parameters`,\"'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required\");if(!t.editing.supportsGlobalId&&r?.globalIdUsed)throw new a(`${i}:invalid-parameter`,\"This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'\");if(!t.editing.supportsGlobalId&&o)throw new a(`${i}:invalid-parameter`,\"'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'\");if(!r?.globalIdUsed&&o)throw new a(`${i}:invalid-parameter`,\"When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true\")}function D(t){const a=new e;return t.attributes||(t.attributes={}),a.geometry=t.geometry,a.attributes=t.attributes,a}async function G(e,t){if(null==t.infoFor3D)return;const{infoFor3D:r}=t,s=c(\"model/gltf-binary\",r.supportedFormats)??h(\"glb\",r.supportedFormats);if(!(!!s&&r.editFormats.includes(s)))throw new a(`${t.type}-layer:binary-gltf-asset-not-supported`,\"3DObjectFeatureLayer requires binary glTF (.glb) support for updating mesh geometry.\");e.addAssetFeatures??=[];const{addAssetFeatures:o}=e;for(const a of e.addFeatures??[])V(a)&&o.push(a);for(const a of e.updateFeatures??[])V(a)&&o.push(a)}function V(e){return\"mesh\"===e?.geometry?.type}function M(e,t,r,s){if(!y(t))throw new a(`${e.type}-layer:no-editing-support`,\"Layer source does not support applyEdits capability\",{layer:e});if(!t.uploadAssets)throw new a(`${e.type}-layer:no-asset-upload-support`,\"Layer source does not support uploadAssets capability\",{layer:e});return t.uploadAssets(r,s)}export{A as applyEdits,T as checkEditingCapabilities,F as isFeatureIdentifierArrayWithGlobalId,b as isFeatureIdentifierArrayWithObjectId,w as isFeatureIdentifierWithGlobalId,g as isFeatureIdentifierWithObjectId,k as normalizeCollections,B as normalizeEdits,L as normalizeGeometries,D as shallowCloneFeature,M as uploadAssets};\n"],"names":["y","e","applyEdits","g","objectId","b","every","w","globalId","F","async","A","t","a","i","s","n","gdbVersion","d","l","url","u","layerId","returnServiceEditsOption","o","promise","then","addedFeatures","length","updatedFeatures","deletedFeatures","addedAttachments","updatedAttachments","deletedAttachments","emit","result","results","edits","v","filter","error","map","r","addFeatureResults","updateFeatureResults","deleteFeatureResults","addAttachmentResults","updateAttachmentResults","deleteAttachmentResults","exceededTransferLimit","historicMoment","editMoment","Date","globalIdToObjectId","editedFeatureResults","editedFeatures","resolve","p","reject","load","type","layer","m","options","f","addFeatures","updateFeatures","deleteFeatures","addAttachments","updateAttachments","deleteAttachments","infoFor3D","T","data","isVersioned","editing","supportsRollbackOnFailure","rollbackOnFailureEnabled","warn","supportsReturnServiceEditsInSourceSpatialReference","returnServiceEditsInSourceSR","B","globalIdUsed","c","fields","globalIdField","forEach","attributes","U","$","E","S","geometry","supportsGeometryUpdate","j","R","O","supportedFormats","h","editFormats","includes","addAssetFeatures","V","push","G","L","I","name","Number","MAX_SAFE_INTEGER","feature","hasZ","capabilities","supportsZ","hasM","supportsM","vertexSpace","isGeoreferenced","attachment","uploadId","File","supportsUploadWithItemId","isBase64","concat","slice","k","Array","from","toArray","operations","supportsAdd","supportsUpdate","supportsDelete","D","supportsGlobalId","M","uploadAssets"],"sourceRoot":""}