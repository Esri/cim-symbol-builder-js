{"version":3,"file":"static/js/8178.86ba2701.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/graphics/sources/WFSSourceWorker.js","../node_modules/@arcgis/core/layers/graphics/sources/support/sourceUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{createTask as e}from\"../../../core/asyncUtils.js\";import t from\"../../../core/Error.js\";import r from\"../../../core/Logger.js\";import{isSome as s,unwrap as a}from\"../../../core/maybe.js\";import{throwIfAborted as i,isAbortError as o}from\"../../../core/promiseUtils.js\";import{equals as n,WGS84 as u}from\"../../../geometry/support/spatialReferenceUtils.js\";import{convertFromGeometry as p,convertToGeometry as h}from\"../featureConversionUtils.js\";import y from\"../data/FeatureStore.js\";import{project as c,checkProjectionSupport as m}from\"../data/projectionSupport.js\";import{QueryEngine as l}from\"../data/QueryEngine.js\";import{validateGeoJSON as g,createOptimizedFeatures as f}from\"./geojson/geojson.js\";import{mixAttributes as _}from\"./support/sourceUtils.js\";import{getFeature as d}from\"../../ogc/wfsUtils.js\";import w from\"../../support/FieldsIndex.js\";class E{constructor(){this._queryEngine=null,this._customParameters=null,this._snapshotFeatures=async e=>{const{objectIdField:t}=this._queryEngine,r=await d(this._getFeatureUrl??\"\",this._featureType.typeName,this._getFeatureOutputFormat,{customParameters:this._customParameters,dateFields:this._queryEngine.fieldsIndex.dateFields.map((e=>e.name)),signal:e});await g(r),i(e);const a=f(r,{geometryType:this._queryEngine.geometryType,hasZ:!1,objectIdField:t});if(!n(this._queryEngine.spatialReference,u))for(const i of a)s(i.geometry)&&(i.geometry=p(c(h(i.geometry,this._queryEngine.geometryType,!1,!1),u,this._queryEngine.spatialReference)));let o=1;for(const s of a){const e={};_(this._fieldsIndex,e,s.attributes,!0),s.attributes=e,null==s.attributes[t]&&(s.objectId=s.attributes[t]=o++)}return a}}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}async load(e,t){const{getFeatureUrl:r,getFeatureOutputFormat:s,spatialReference:o,fields:n,geometryType:u,featureType:p,objectIdField:h,customParameters:c}=e;this._featureType=p,this._customParameters=c,this._getFeatureUrl=r,this._getFeatureOutputFormat=s,this._fieldsIndex=new w(n),await this._checkProjection(o),i(t),this._queryEngine=new l({fields:n,geometryType:u,hasM:!1,hasZ:!1,objectIdField:h,spatialReference:o,timeInfo:null,featureStore:new y({geometryType:u,hasM:!1,hasZ:!1})});const m=await this._snapshotFeatures(a(t.signal));return this._queryEngine.featureStore.addMany(m),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async applyEdits(){throw new t(\"wfs-source:editing-not-supported\",\"applyEdits() is not supported on WFSLayer\")}async queryFeatures(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForIds(e,t.signal)}async queryExtent(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e,t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForSnapping(e,t.signal)}async refresh(s){return this._customParameters=s,this._snapshotTask?.abort(),this._snapshotTask=e(this._snapshotFeatures),this._snapshotTask.promise.then((e=>{this._queryEngine.featureStore.clear(),e&&this._queryEngine.featureStore.addMany(e)}),(e=>{this._queryEngine.featureStore.clear(),o(e)||r.getLogger(\"esri.layers.WFSLayer\").error(new t(\"wfs-layer:getfeature-error\",\"An error occurred during the GetFeature request\",{error:e}))})),await this._waitSnapshotComplete(),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _checkProjection(e){try{await m(u,e)}catch{throw new t(\"unsupported-projection\",\"Projection not supported\",{spatialReference:e})}}}export{E as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isNone as e}from\"../../../../core/maybe.js\";import{isValid as t}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{validateFieldValue as n,validationErrorToString as i,isNumericField as r,isStringField as s,sanitizeNullFieldValue as o}from\"../../../support/fieldUtils.js\";class l{constructor(){this.code=null,this.description=null}}class u{constructor(e){this.error=new l,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=e}}function a(e){return new u(e)}class c{constructor(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e}}function f(e){return new c(e)}const d=new Set;function m(e,t,r,s=!1,o){d.clear();for(const l in r){const u=e.get(l);if(!u)continue;const c=r[l],f=p(u,c);if(f!==c&&o&&o.push({name:\"invalid-value-type\",message:\"attribute value was converted to match the field type\",details:{field:u,originalValue:c,sanitizedValue:f}}),d.add(u.name),u&&(s||u.editable)){const e=n(u,f);if(e)return a(i(e,u,f));t[u.name]=f}}for(const n of e?.requiredFields??[])if(!d.has(n.name))return a(`missing required field \"${n.name}\"`);return null}function p(e,t){let n=t;return\"string\"==typeof t&&r(e)?n=parseFloat(t):null!=t&&s(e)&&\"string\"!=typeof t&&(n=String(t)),o(n)}let h;function g(n,i){if(!n||!t(i))return n;if(\"rings\"in n||\"paths\"in n){if(e(h))throw new TypeError(\"geometry engine not loaded\");return h.simplify(i,n)}return n}async function y(){return e(h)&&(h=await import(\"../../../../geometry/geometryEngineJSON.js\")),h}async function w(e,n){!t(e)||\"esriGeometryPolygon\"!==n&&\"esriGeometryPolyline\"!==n||await y()}export{a as createFeatureEditErrorResult,f as createFeatureEditSuccessResult,w as loadGeometryEngineForSimplify,m as mixAttributes,g as simplify};\n"],"names":["E","constructor","this","_queryEngine","_customParameters","_snapshotFeatures","async","objectIdField","t","r","d","_getFeatureUrl","_featureType","typeName","_getFeatureOutputFormat","customParameters","dateFields","fieldsIndex","map","e","name","signal","g","i","a","f","geometryType","hasZ","n","spatialReference","u","s","geometry","p","c","h","o","_","_fieldsIndex","attributes","objectId","destroy","getFeatureUrl","getFeatureOutputFormat","fields","featureType","w","_checkProjection","l","hasM","timeInfo","featureStore","y","m","addMany","extent","fetchRecomputedExtents","fullExtent","_waitSnapshotComplete","executeQuery","executeQueryForCount","executeQueryForIds","executeQueryForExtent","executeQueryForSnapping","_snapshotTask","abort","promise","then","clear","error","finished","code","description","globalId","success","uniqueId","Set","get","push","message","details","field","originalValue","sanitizedValue","add","editable","requiredFields","has","parseFloat","String","TypeError","simplify"],"sourceRoot":""}