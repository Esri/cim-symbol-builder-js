{"version":3,"file":"static/js/7463.1bdc9831.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/support/StreamConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/WebSocketConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/GeoEventConnection.js","../node_modules/@arcgis/core/layers/support/ClientSideConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/createConnection.js","../node_modules/@arcgis/core/rest/operations/urlUtils.js","../node_modules/@arcgis/core/rest/query/operations/query.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Error.js\";import o from\"../../core/Evented.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";let c=class extends o.EventedAccessor{destroy(){this.emit(\"destroy\")}get connectionError(){return this.errorString?new e(\"stream-connection\",this.errorString):null}onFeature(r){this.emit(\"data-received\",r)}onMessage(r){this.emit(\"message-received\",r)}};r([s({readOnly:!0})],c.prototype,\"connectionError\",null),c=r([t(\"esri.layers.support.StreamConnection\")],c);const i=c;export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Error.js\";import o from\"../../../../core/Logger.js\";import{after as s,createResolver as r}from\"../../../../core/promiseUtils.js\";import{addQueryParameters as n}from\"../../../../core/urlUtils.js\";import{property as i}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import{subclass as c}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{getGeometryZScaler as a}from\"../../../../geometry/support/zscale.js\";import l from\"../../../support/StreamConnection.js\";var h;!function(e){e[e.CONNECTING=0]=\"CONNECTING\",e[e.OPEN=1]=\"OPEN\",e[e.CLOSING=2]=\"CLOSING\",e[e.CLOSED=3]=\"CLOSED\"}(h||(h={}));let d=class extends l{constructor(e){super(),this._outstandingMessages=[],this.errorString=null;const{geometryType:t,spatialReference:o,sourceSpatialReference:s}=e;this._config=e,this._featureZScaler=a(t,s,o),this._open()}async _open(){await this._tryCreateWebSocket(),this.destroyed||await this._handshake()}destroy(){super.destroy(),null!=this._websocket&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close()),this._websocket=null}get connectionStatus(){if(null==this._websocket)return\"disconnected\";switch(this._websocket.readyState){case h.CONNECTING:case h.OPEN:return\"connected\";case h.CLOSING:case h.CLOSED:return\"disconnected\"}}sendMessageToSocket(e){null!=this._websocket?this._websocket.send(JSON.stringify(e)):this._outstandingMessages.push(e)}sendMessageToClient(e){this._onMessage(e)}updateCustomParameters(e){this._config.customParameters=e,null!=this._websocket&&this._websocket.close()}async _tryCreateWebSocket(e=this._config.source.path,r=1e3,i=0){try{if(this.destroyed)return;const t=n(e,this._config.customParameters??{});this._websocket=await this._createWebSocket(t),this.notifyChange(\"connectionStatus\")}catch(c){const n=r/1e3;return this._config.maxReconnectionAttempts&&i>=this._config.maxReconnectionAttempts?(o.getLogger(this).error(new t(\"websocket-connection\",\"Exceeded maxReconnectionAttempts attempts. No further attempts will be made\")),void this.destroy()):(o.getLogger(this).error(new t(\"websocket-connection\",`Failed to connect. Attempting to reconnect in ${n}s`,c)),await s(r),this._tryCreateWebSocket(e,Math.min(1.5*r,1e3*this._config.maxReconnectionInterval),i+1))}}_setWebSocketJSONParseHandler(e){e.onmessage=e=>{try{const t=JSON.parse(e.data);this._onMessage(t)}catch(s){return void o.getLogger(this).error(new t(\"websocket-connection\",\"Failed to parse message, invalid JSON\",{error:s}))}}}_createWebSocket(e){return new Promise(((t,o)=>{const s=new WebSocket(e);s.onopen=()=>{if(s.onopen=null,this.destroyed)return s.onclose=null,void s.close();s.onclose=e=>this._onClose(e),s.onerror=e=>this._onError(e),this._setWebSocketJSONParseHandler(s),t(s)},s.onclose=e=>{s.onopen=s.onclose=null,o(e)}}))}async _handshake(e=1e4){const s=this._websocket;if(null==s)return;const n=r(),i=s.onmessage,{filter:c,outFields:a,spatialReference:l}=this._config;return n.timeout(e),s.onmessage=e=>{let r=null;try{r=JSON.parse(e.data)}catch(h){}r&&\"object\"==typeof r||(o.getLogger(this).error(new t(\"websocket-connection\",\"Protocol violation. Handshake failed - malformed message\",e.data)),n.reject(),this.destroy()),r.spatialReference?.wkid!==l?.wkid&&(o.getLogger(this).error(new t(\"websocket-connection\",`Protocol violation. Handshake failed - expected wkid of ${l.wkid}`,e.data)),n.reject(),this.destroy()),\"json\"!==r.format&&(o.getLogger(this).error(new t(\"websocket-connection\",\"Protocol violation. Handshake failed - format is not set\",e.data)),n.reject(),this.destroy()),c&&r.filter!==c&&o.getLogger(this).error(new t(\"websocket-connection\",\"Tried to set filter, but server doesn't support it\")),a&&r.outFields!==a&&o.getLogger(this).error(new t(\"websocket-connection\",\"Tried to set outFields, but server doesn't support it\")),s.onmessage=i;for(const t of this._outstandingMessages)s.send(JSON.stringify(t));this._outstandingMessages=[],n.resolve()},s.send(JSON.stringify({filter:c,outFields:a,format:\"json\",spatialReference:{wkid:l.wkid}})),n.promise}_onMessage(e){if(this.onMessage(e),\"type\"in e)switch(e.type){case\"features\":case\"featureResult\":for(const t of e.features)null!=this._featureZScaler&&this._featureZScaler(t.geometry),this.onFeature(t)}}_onError(e){const t=\"Encountered an error over WebSocket connection\";this._set(\"errorString\",t),o.getLogger(this).error(\"websocket-connection\",t)}_onClose(e){this._websocket=null,this.notifyChange(\"connectionStatus\"),1e3!==e.code&&o.getLogger(this).error(\"websocket-connection\",`WebSocket closed unexpectedly with error code ${e.code}`),this.destroyed||this._open()}};e([i()],d.prototype,\"connectionStatus\",null),e([i()],d.prototype,\"errorString\",void 0),d=e([c(\"esri.layers.graphics.sources.connections.WebSocketConnection\")],d);export{d as WebSocketConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import\"../../../../geometry.js\";import t from\"../../../../request.js\";import r from\"../../../../core/Error.js\";import s from\"../../../../core/Logger.js\";import{createResolver as o}from\"../../../../core/promiseUtils.js\";import{addQueryParameters as i}from\"../../../../core/urlUtils.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{WebSocketConnection as a}from\"./WebSocketConnection.js\";import{executeQuery as c}from\"../../../../rest/query/operations/query.js\";import u from\"../../../../rest/support/Query.js\";import{fromJSON as l}from\"../../../../geometry/support/jsonUtils.js\";import f from\"../../../../geometry/SpatialReference.js\";const h=1e4,d={maxQueryDepth:5,maxRecordCountFactor:3};let g=class extends a{constructor(e){super({...d,...e}),this._buddyServicesQuery=null,this._relatedFeatures=null}async _open(){const e=await this._fetchServiceDefinition(this._config.source);e.timeInfo.trackIdField||s.getLogger(this).warn(\"GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.\");const t=this._fetchWebSocketUrl(e.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices()),await this._buddyServicesQuery,await this._tryCreateWebSocket(t);const{filter:r,outFields:o}=this._config;this.destroyed||this._setFilter(r,o)}_onMessage(e){if(\"attributes\"in e){let o;try{o=this._enrich(e),null!=this._featureZScaler&&this._featureZScaler(o.geometry)}catch(t){return void s.getLogger(this).error(new r(\"geoevent-connection\",\"Failed to parse message\",t))}this.onFeature(o)}else this.onMessage(e)}async _fetchServiceDefinition(e){const r={f:\"json\",...this._config.customParameters},s=t(e.path,{query:r,responseType:\"json\"}),o=(await s).data;return this._serviceDefinition=o,o}_fetchWebSocketUrl(e,t){const r=e[0],{urls:s,token:o}=r,n=this._inferWebSocketBaseUrl(s);return i(`${n}/subscribe`,{outSR:\"\"+t.wkid,token:o})}_inferWebSocketBaseUrl(e){if(1===e.length)return e[0];for(const t of e)if(t.includes(\"wss\"))return t;return s.getLogger(this).error(new r(\"geoevent-connection\",\"Unable to infer WebSocket url\",e)),null}async _setFilter(e,t){const i=this._websocket;if(null==i||null==e&&null==t)return;const n=JSON.stringify({filter:this._serializeFilter(e,t)});let a=!1;const c=o(),u=()=>{a||(this.destroyed||this._websocket!==i||s.getLogger(this).error(new r(\"geoevent-connection\",\"Server timed out when setting filter\")),c.reject())},l=e=>{const t=JSON.parse(e.data);t.filter&&(t.error&&(s.getLogger(this).error(new r(\"geoevent-connection\",\"Failed to set service filter\",t.error)),this._set(\"errorString\",`Could not set service filter - ${t.error}`),c.reject(t.error)),this._setWebSocketJSONParseHandler(i),a=!0,c.resolve())};return i.onmessage=l,i.send(n),setTimeout(u,h),c.promise}_serializeFilter(e,t){const o={};if(null==e&&null==t)return o;if(null!=e&&e.geometry)try{const t=l(e.geometry);if(\"extent\"!==t.type)throw new r(`Expected extent but found type ${t.type}`);o.geometry=JSON.stringify(t.shiftCentralMeridian())}catch(i){s.getLogger(this).error(new r(\"geoevent-connection\",\"Encountered an error when setting connection geometryDefinition\",i))}return null!=e&&e.where&&\"1 = 1\"!==e.where&&\"1=1\"!==e.where&&(o.where=e.where),null!=t&&(o.outFields=t.join(\",\")),o}_enrich(e){if(!this._relatedFeatures)return e;const t=this._serviceDefinition.relatedFeatures.joinField,o=e.attributes[t],i=this._relatedFeatures.get(o);if(!i)return s.getLogger(this).warn(\"geoevent-connection\",\"Feature join failed. Is the join field configured correctly?\",e),e;const{attributes:n,geometry:a}=i;for(const r in n)e.attributes[r]=n[r];return a&&(e.geometry=a),e.geometry||e.centroid||s.getLogger(this).error(new r(\"geoevent-connection\",\"Found malformed feature - no geometry found\",e)),e}async _queryBuddyServices(){try{const{relatedFeatures:e,keepLatestArchive:t}=this._serviceDefinition,r=this._queryRelatedFeatures(e),s=this._queryArchive(t);await r;const o=await s;if(!o)return;for(const i of o.features)this.onFeature(this._enrich(i))}catch(e){s.getLogger(this).error(new r(\"geoevent-connection\",\"Encountered an error when querying buddy services\",{error:e}))}}async _queryRelatedFeatures(e){if(!e)return;const t=await this._queryBuddy(e.featuresUrl);this._addRelatedFeatures(t)}async _queryArchive(e){if(e)return this._queryBuddy(e.featuresUrl)}async _queryBuddy(e){const t=new((await import(\"../../../FeatureLayer.js\")).default)({url:e}),{capabilities:r}=await t.load(),s=r.query.supportsMaxRecordCountFactor,o=r.query.supportsPagination,i=r.query.supportsCentroid,n=this._config.maxRecordCountFactor,a=t.capabilities.query.maxRecordCount,l=s?a*n:a,h=new u;if(h.outFields=this._config.outFields??[\"*\"],h.where=this._config.filter?.where??\"1=1\",h.returnGeometry=!0,h.returnExceededLimitFeatures=!0,h.outSpatialReference=f.fromJSON(this._config.spatialReference),i&&(h.returnCentroid=!0),s&&(h.maxRecordCountFactor=n),o)return h.num=l,t.destroy(),this._queryPages(e,h);const d=await c(e,h,this._config.sourceSpatialReference);return t.destroy(),d.data}async _queryPages(e,t,r=[],s=0){t.start=null!=t.num?s*t.num:null;const{data:o}=await c(e,t,this._config.sourceSpatialReference);return o.exceededTransferLimit&&s<(this._config.maxQueryDepth??0)?(o.features.forEach((e=>r.push(e))),this._queryPages(e,t,r,s+1)):(r.forEach((e=>o.features.push(e))),o)}_addRelatedFeatures(e){const t=new Map,r=e.features,s=this._serviceDefinition.relatedFeatures.joinField;for(const o of r){const e=o.attributes[s];t.set(e,o)}this._relatedFeatures=t}};g=e([n(\"esri.layers.graphics.sources.connections.GeoEventConnection\")],g);const y=g;export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{getGeometryZScaler as o}from\"../../geometry/support/zscale.js\";import s from\"./StreamConnection.js\";let c=class extends s{constructor(e){super(),this.connectionStatus=\"connected\",this.errorString=null;const{geometryType:r,spatialReference:t,sourceSpatialReference:s}=e;this._featureZScaler=o(r,s,t)}updateCustomParameters(e){}sendMessageToSocket(e){}sendMessageToClient(e){if(\"type\"in e)switch(e.type){case\"features\":case\"featureResult\":for(const r of e.features)null!=this._featureZScaler&&this._featureZScaler(r.geometry),this.onFeature(r)}this.onMessage(e)}};e([r()],c.prototype,\"connectionStatus\",void 0),e([r()],c.prototype,\"errorString\",void 0),c=e([t(\"esri.layers.support.ClientSideConnection\")],c);export{c as ClientSideConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport e from\"./GeoEventConnection.js\";import{WebSocketConnection as t}from\"./WebSocketConnection.js\";import{ClientSideConnection as n}from\"../../../support/ClientSideConnection.js\";function o(o,r,s,i,c,a,m,p){const f={source:o,sourceSpatialReference:r,spatialReference:s,geometryType:i,filter:c,maxReconnectionAttempts:a,maxReconnectionInterval:m,customParameters:p};if(!o)return new n(f);return o.path.startsWith(\"wss://\")||o.path.startsWith(\"ws://\")?new t(f):new e(f)}export{o as createConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nfunction t(n){const o={};for(const e in n){if(\"declaredClass\"===e)continue;const r=n[e];if(null!=r&&\"function\"!=typeof r)if(Array.isArray(r)){o[e]=[];for(let n=0;n<r.length;n++)o[e][n]=t(r[n])}else\"object\"==typeof r?r.toJSON&&(o[e]=JSON.stringify(r)):o[e]=r}return o}export{t as mapParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport t from\"../../../request.js\";import{urlToObject as e,join as n}from\"../../../core/urlUtils.js\";import{getJsonType as r}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as i}from\"../../../geometry/support/normalizeUtils.js\";import{mapParameters as a}from\"../../operations/urlUtils.js\";import{parsePBFFeatureQuery as o}from\"./pbfQueryUtils.js\";import{applyFeatureSetZUnitScaling as u}from\"./queryZScale.js\";const l=\"Layer does not support extent calculation.\";function s(t,e){if(e&&\"extent\"===t.type)return`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`;if(e&&\"point\"===t.type)return`${t.x},${t.y}`;const n=t.toJSON();return delete n.spatialReference,JSON.stringify(n)}function y(t,e){const n=t.geometry,i=t.toJSON();delete i.compactGeometryEnabled,delete i.defaultSpatialReferenceEnabled;const a=i;let o,u,l;if(null!=n&&(u=n.spatialReference,l=n.spatialReference.wkid||JSON.stringify(n.spatialReference),a.geometryType=r(n),a.geometry=s(n,t.compactGeometryEnabled),a.inSR=l),i.groupByFieldsForStatistics&&(a.groupByFieldsForStatistics=i.groupByFieldsForStatistics.join(\",\")),i.objectIds&&(a.objectIds=i.objectIds.join(\",\")),i.orderByFields&&(a.orderByFields=i.orderByFields.join(\",\")),!i.outFields||!i.returnDistinctValues&&(e?.returnCountOnly||e?.returnExtentOnly||e?.returnIdsOnly)?delete a.outFields:i.outFields.includes(\"*\")?a.outFields=\"*\":a.outFields=i.outFields.join(\",\"),i.outSR?(a.outSR=i.outSR.wkid||JSON.stringify(i.outSR),o=t.outSpatialReference):n&&(i.returnGeometry||i.returnCentroid)&&(a.outSR=a.inSR,o=u),i.returnGeometry&&delete i.returnGeometry,i.outStatistics&&(a.outStatistics=JSON.stringify(i.outStatistics)),i.fullText&&(a.fullText=JSON.stringify(i.fullText)),i.pixelSize&&(a.pixelSize=JSON.stringify(i.pixelSize)),i.quantizationParameters&&(t.defaultSpatialReferenceEnabled&&null!=u&&null!=t.quantizationParameters&&null!=t.quantizationParameters.extent&&u.equals(t.quantizationParameters.extent.spatialReference)&&delete i.quantizationParameters.extent.spatialReference,a.quantizationParameters=JSON.stringify(i.quantizationParameters)),i.parameterValues&&(a.parameterValues=JSON.stringify(i.parameterValues)),i.rangeValues&&(a.rangeValues=JSON.stringify(i.rangeValues)),i.dynamicDataSource&&(a.layer=JSON.stringify({source:i.dynamicDataSource}),delete i.dynamicDataSource),i.timeExtent){const t=i.timeExtent,{start:e,end:n}=t;null==e&&null==n||(a.time=e===n?e:`${e??\"null\"},${n??\"null\"}`),delete i.timeExtent}return t.defaultSpatialReferenceEnabled&&null!=u&&null!=o&&u.equals(o)&&(a.defaultSR=a.inSR,delete a.inSR,delete a.outSR),a}async function m(t,e,n,r){const i=null!=e.timeExtent&&e.timeExtent.isEmpty?{data:{features:[]}}:await x(t,e,\"json\",r);return u(e,n,i.data),i}async function c(t,e,n,r){if(null!=e.timeExtent&&e.timeExtent.isEmpty)return{data:n.createFeatureResult()};const i=await f(t,e,r),a=i;return a.data=o(i.data,n),a}function f(t,e,n){return x(t,e,\"pbf\",n)}function d(t,e,n){return null!=e.timeExtent&&e.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):x(t,e,\"json\",n,{returnIdsOnly:!0})}function p(t,e,n){return null!=e.timeExtent&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):x(t,e,\"json\",n,{returnIdsOnly:!0,returnCountOnly:!0})}async function S(t,e,n){if(null!=e.timeExtent&&e.timeExtent.isEmpty)return{data:{count:0,extent:null}};const r=await x(t,e,\"json\",n,{returnExtentOnly:!0,returnCountOnly:!0}),i=r.data;if(i.hasOwnProperty(\"extent\"))return r;if(i.features)throw new Error(l);if(i.hasOwnProperty(\"count\"))throw new Error(l);return r}async function x(r,o,u,l={},s={}){const m=\"string\"==typeof r?e(r):r,c=o.geometry?[o.geometry]:[];l.responseType=\"pbf\"===u?\"array-buffer\":\"json\";const f=await i(c,null,l),d=f&&f[0];null!=d&&((o=o.clone()).geometry=d);const p=a({...m.query,f:u,...s,...y(o,s)});return t(n(m.path,E(o,s)?\"query3d\":\"query\"),{...l,query:{...p,...l.query}})}function E(t,e){return null!=t.formatOf3DObjects&&!(e.returnCountOnly||e.returnExtentOnly||e.returnIdsOnly)}export{s as encodeGeometry,m as executeQuery,p as executeQueryForCount,S as executeQueryForExtent,d as executeQueryForIds,c as executeQueryPBF,f as executeQueryPBFBuffer,y as queryToQueryStringParameters,x as runQuery};\n"],"names":["c","o","destroy","this","emit","connectionError","errorString","e","onFeature","r","onMessage","s","readOnly","prototype","t","i","h","CONNECTING","OPEN","CLOSING","CLOSED","d","l","constructor","super","_outstandingMessages","geometryType","spatialReference","sourceSpatialReference","_config","_featureZScaler","a","_open","_tryCreateWebSocket","destroyed","_handshake","_websocket","onopen","onclose","onerror","onmessage","close","connectionStatus","readyState","sendMessageToSocket","send","JSON","stringify","push","sendMessageToClient","_onMessage","updateCustomParameters","customParameters","source","path","n","_createWebSocket","notifyChange","maxReconnectionAttempts","error","Math","min","maxReconnectionInterval","_setWebSocketJSONParseHandler","parse","data","Promise","WebSocket","_onClose","_onError","filter","outFields","timeout","reject","wkid","format","resolve","promise","type","features","geometry","_set","code","maxQueryDepth","maxRecordCountFactor","g","_buddyServicesQuery","_relatedFeatures","_fetchServiceDefinition","timeInfo","trackIdField","warn","_fetchWebSocketUrl","streamUrls","_queryBuddyServices","_setFilter","_enrich","f","query","responseType","_serviceDefinition","urls","token","_inferWebSocketBaseUrl","outSR","length","includes","_serializeFilter","setTimeout","shiftCentralMeridian","where","join","relatedFeatures","joinField","attributes","get","centroid","keepLatestArchive","_queryRelatedFeatures","_queryArchive","_queryBuddy","featuresUrl","_addRelatedFeatures","default","url","capabilities","load","supportsMaxRecordCountFactor","supportsPagination","supportsCentroid","maxRecordCount","u","returnGeometry","returnExceededLimitFeatures","outSpatialReference","returnCentroid","num","_queryPages","start","exceededTransferLimit","forEach","Map","set","y","m","p","startsWith","Array","isArray","toJSON","compactGeometryEnabled","defaultSpatialReferenceEnabled","xmin","ymin","xmax","ymax","x","inSR","groupByFieldsForStatistics","objectIds","orderByFields","returnDistinctValues","returnCountOnly","returnExtentOnly","returnIdsOnly","outStatistics","fullText","pixelSize","quantizationParameters","extent","equals","parameterValues","rangeValues","dynamicDataSource","layer","timeExtent","end","time","defaultSR","async","isEmpty","createFeatureResult","count","S","hasOwnProperty","Error","clone","E","formatOf3DObjects"],"sourceRoot":""}